<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,minimum-scale=1,maximum-scale=1"><link href=/css/fonts.css rel=stylesheet type=text/css><title>Windows SearchPath</title><link rel=stylesheet href=/css/hugo-octopress.css><link rel=stylesheet href=https://parsiya.io//clone.css><link rel=stylesheet href=/css/fork-awesome.min.css><link href=https://parsiya.io/favicon.png rel=icon><meta name=description content><meta name=keywords content="[Parsia Hakimian Parsiya infosec information security]"><meta name=author content="Parsia-Clone"><meta name=generator content="Hugo 0.151.2"><meta name=twitter:card content="summary"><meta name=twitter:title content="Windows SearchPath"><meta name=twitter:description content='A while ago I was playing with the Windows API SearchPath. It will search for a specific file in PATH.
DWORD WINAPI SearchPath(
    _In_opt_  LPCTSTR lpPath,
    _In_      LPCTSTR lpFileName,
    _In_opt_  LPCTSTR lpExtension,
    _In_      DWORD   nBufferLength,
    _Out_     LPTSTR  lpBuffer,
    _Out_opt_ LPTSTR  *lpFilePart
);
Note this quirk from the "Remarks" section. When lpPath is NULL (which usually is). It looks up the following registry key. If the value is 1 it will first search in PATH then in current working directory and vice versa if 0. Default is 0.'><meta name=twitter:domain content="parsiya.io"><meta name=twitter:creator content="@CryptoGangsta"></head><body><header role=banner><hgroup><h1><a href=https://parsiya.io/>Parsia-Clone</a></h1><h2>'Documentation is a love letter that you write to your future self.' - Damian Conway</h2></hgroup></header><nav role=navigation><fieldset class=mobile-nav><select onchange="location=this.value"><option value>Navigate…</option><option value=https://github.com/parsiya/Parsia-Clone>» Parsia-Clone on Github</option><option value=https://parsiya.net/categories/clone/>» How did I make this?</option><option value=https://parsiya.net>» My Main Website</option></select></fieldset><ul class=main-navigation><li><a href=https://github.com/parsiya/Parsia-Clone title="Parsia-Clone on Github" target=_blank rel="noopener noreferrer">Parsia-Clone on Github</a></li><li><a href=https://parsiya.net/categories/clone/ title="How did I make this?" target=_blank rel="noopener noreferrer">How did I make this?</a></li><li><a href=https://parsiya.net title="My Main Website" target=_blank rel="noopener noreferrer">My Main Website</a></li></ul><ul class=subscription></ul><form action=https://www.google.com/search method=get target=_blank rel="noopener noreferrer"><fieldset role=search><input class=search type=text name=q results=0 placeholder=Search>
<input type=hidden name=q value=site:https://parsiya.io/></fieldset></form></nav><div id=main><div id=content><div><article class=hentry role=article><header><p class=meta>1 minute read
- <a class=label href=https://parsiya.io/categories/random/>Random</a></p><h1 class=entry-title>Windows SearchPath</h1><a href=https://github.com/parsiya/Parsia-Clone/tree/main/random/search-path.md target=_blank>Github Link</a></header><div class=entry-content><p>A while ago I was playing with the Windows API <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa365527%28v=vs.85%29.aspx" target=_blank rel="noreferrer noopener">SearchPath</a>. It will search for a specific file in <code>PATH</code>.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span>DWORD WINAPI <span style=color:#268bd2>SearchPath</span>(
</span></span><span style=display:flex><span>    _In_opt_  LPCTSTR lpPath,
</span></span><span style=display:flex><span>    _In_      LPCTSTR lpFileName,
</span></span><span style=display:flex><span>    _In_opt_  LPCTSTR lpExtension,
</span></span><span style=display:flex><span>    _In_      DWORD   nBufferLength,
</span></span><span style=display:flex><span>    _Out_     LPTSTR  lpBuffer,
</span></span><span style=display:flex><span>    _Out_opt_ LPTSTR  <span style=color:#719e07>*</span>lpFilePart
</span></span><span style=display:flex><span>);
</span></span></code></pre></div><p>Note this quirk from the "Remarks" section. When <code>lpPath</code> is NULL (which usually is). It looks up the following registry key. If the value is <code>1</code> it will first search in PATH then in current working directory and vice versa if <code>0</code>. Default is <code>0</code>.</p><ul><li>HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\SafeProcessSearchMode</li></ul></div><footer><p class=meta><span class=categories>Tags:
<a class=category href=https://parsiya.io/tags/windows>Windows</a> <a class=category href=https://parsiya.io/tags/searchpath>SearchPath</a></span></p></footer></article></div><aside class="sidebar thirds"><section class="first odd"><h2>Table of Contents</h2><nav id=TableOfContents></nav></section></aside></div></div><footer role=contentinfo><p>Copyright &copy; 2025 Parsia-Clone - <a href=https://parsiya.io/license/>License</a> -
<span class=credit>Powered by <a target=_blank href=https://gohugo.io rel="noopener noreferrer">Hugo</a> and <a target=_blank href=https://github.com/parsiya/hugo-octopress/ rel="noopener noreferrer">Hugo-Octopress</a> theme.</p></footer></body></html>