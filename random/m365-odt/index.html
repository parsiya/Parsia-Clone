<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,minimum-scale=1,maximum-scale=1"><link href=/css/fonts.css rel=stylesheet type=text/css><title>Microsoft 365 Office Deployment Tool</title>
<link rel=stylesheet href=/css/hugo-octopress.css><link rel=stylesheet href=https://parsiya.io//clone.css><link rel=stylesheet href=/css/fork-awesome.min.css><link href=https://parsiya.io/favicon.png rel=icon><meta name=description content><meta name=keywords content="[Parsia Hakimian Parsiya infosec information security]"><meta name=author content="Parsia-Clone"><meta name=generator content="Hugo 0.139.3"><meta name=twitter:card content="summary"><meta name=twitter:title content="Microsoft 365 Office Deployment Tool"><meta name=twitter:description content='
Uninstall Microsoft Office 365 from your machine.
Go to https://config.office.com/deploymentsettings and create a configuration.

Don&#39;t worry if you cannot find your version under Products > Office Suites. Choose anything, we will override this.


Create a configuration, remove any apps you do not want, there&#39;s also some extra configuration that alters the registry which is optional. Download it, let&#39;s say it&#39;s named myconfig.xml.
Open the configuration file and replace the value of <Product ID="..."> with O365ProPlusRetail.

So the entire tag will look like <Product ID="O365ProPlusRetail">.


Download the Office Deployment Tool at https://www.microsoft.com/en-us/download/details.aspx?id=49117.

Link might change in the future, if so, just search for it.


Run it and it will ask for a path to "extract" files.
After extraction it will create a setup.exe and a configuration XML file.
Run setup.exe /download myconfig.xml. It will download the needed files.
Run setup.exe /configure myconfig.xml. It will only install certain office apps.

Here is my file. AppSettings has a bit of configuration like "edit the files in the desktop app instead of the browser." You can safely remove that tag.'><meta name=twitter:domain content="parsiya.io"><meta name=twitter:creator content="@CryptoGangsta"></head><body><header role=banner><hgroup><h1><a href=https://parsiya.io/>Parsia-Clone</a></h1><h2>'Documentation is a love letter that you write to your future self.' - Damian Conway</h2></hgroup></header><nav role=navigation><fieldset class=mobile-nav><select onchange="location=this.value"><option value>Navigate…</option><option value=https://github.com/parsiya/Parsia-Clone>» Parsia-Clone on Github</option><option value=https://parsiya.net/categories/clone/>» How did I make this?</option><option value=https://parsiya.net>» My Main Website</option></select></fieldset><ul class=main-navigation><li><a href=https://github.com/parsiya/Parsia-Clone title="Parsia-Clone on Github" target=_blank rel="noopener noreferrer">Parsia-Clone on Github</a></li><li><a href=https://parsiya.net/categories/clone/ title="How did I make this?" target=_blank rel="noopener noreferrer">How did I make this?</a></li><li><a href=https://parsiya.net title="My Main Website" target=_blank rel="noopener noreferrer">My Main Website</a></li></ul><ul class=subscription></ul><form action=https://www.google.com/search method=get target=_blank rel="noopener noreferrer"><fieldset role=search><input class=search type=text name=q results=0 placeholder=Search>
<input type=hidden name=q value=site:https://parsiya.io/></fieldset></form></nav><div id=main><div id=content><div><article class=hentry role=article><header><p class=meta>2 minute read
- <a class=label href=https://parsiya.io/categories/random/>Random</a></p><h1 class=entry-title>Microsoft 365 Office Deployment Tool</h1><a href=https://github.com/parsiya/Parsia-Clone/tree/main/random/m365-odt.md target=_blank>Github Link</a></header><div class=entry-content><ol><li>Uninstall Microsoft Office 365 from your machine.</li><li>Go to <a href=https://config.office.com/deploymentsettings target=_blank rel="noreferrer noopener">https://config.office.com/deploymentsettings</a> and create a configuration.<ol><li>Don't worry if you cannot find your version under <code>Products > Office Suites</code>. Choose anything, we will override this.</li></ol></li><li>Create a configuration, remove any apps you do not want, there's also some extra configuration that alters the registry which is optional. Download it, let's say it's named <code>myconfig.xml</code>.</li><li>Open the configuration file and replace the value of <code>&lt;Product ID="..."></code> with <code>O365ProPlusRetail</code>.<ol><li>So the entire tag will look like <code>&lt;Product ID="O365ProPlusRetail"></code>.</li></ol></li><li>Download the <code>Office Deployment Tool</code> at <a href="https://www.microsoft.com/en-us/download/details.aspx?id=49117" target=_blank rel="noreferrer noopener">https://www.microsoft.com/en-us/download/details.aspx?id=49117</a>.<ol><li>Link might change in the future, if so, just search for it.</li></ol></li><li>Run it and it will ask for a path to "extract" files.</li><li>After extraction it will create a <code>setup.exe</code> and a configuration XML file.</li><li>Run <code>setup.exe /download myconfig.xml</code>. It will download the needed files.</li><li>Run <code>setup.exe /configure myconfig.xml</code>. It will only install certain office apps.</li></ol><p>Here is my file. <code>AppSettings</code> has a bit of configuration like "edit the files in the desktop app instead of the browser." You can safely remove that tag.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#268bd2>&lt;Configuration</span> ID=<span style=color:#2aa198>&#34;e45e4877-2ea5-4172-80a8-c1b8b75a7f72&#34;</span><span style=color:#268bd2>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#268bd2>&lt;Add</span> OfficeClientEdition=<span style=color:#2aa198>&#34;64&#34;</span> Channel=<span style=color:#2aa198>&#34;Current&#34;</span><span style=color:#268bd2>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>&lt;Product</span> ID=<span style=color:#2aa198>&#34;O365ProPlusRetail&#34;</span><span style=color:#268bd2>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#268bd2>&lt;Language</span> ID=<span style=color:#2aa198>&#34;MatchOS&#34;</span> <span style=color:#268bd2>/&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#268bd2>&lt;ExcludeApp</span> ID=<span style=color:#2aa198>&#34;Access&#34;</span> <span style=color:#268bd2>/&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#268bd2>&lt;ExcludeApp</span> ID=<span style=color:#2aa198>&#34;Groove&#34;</span> <span style=color:#268bd2>/&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#268bd2>&lt;ExcludeApp</span> ID=<span style=color:#2aa198>&#34;Lync&#34;</span> <span style=color:#268bd2>/&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#268bd2>&lt;ExcludeApp</span> ID=<span style=color:#2aa198>&#34;Outlook&#34;</span> <span style=color:#268bd2>/&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#268bd2>&lt;ExcludeApp</span> ID=<span style=color:#2aa198>&#34;Publisher&#34;</span> <span style=color:#268bd2>/&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#268bd2>&lt;ExcludeApp</span> ID=<span style=color:#2aa198>&#34;Teams&#34;</span> <span style=color:#268bd2>/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>&lt;/Product&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#268bd2>&lt;/Add&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#268bd2>&lt;Updates</span> Enabled=<span style=color:#2aa198>&#34;TRUE&#34;</span> <span style=color:#268bd2>/&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#268bd2>&lt;RemoveMSI</span> <span style=color:#268bd2>/&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#268bd2>&lt;AppSettings&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>&lt;User</span> Key=<span style=color:#2aa198>&#34;software\microsoft\office\16.0\common\toolbars&#34;</span> Name=<span style=color:#2aa198>&#34;screentipscheme&#34;</span> Value=<span style=color:#2aa198>&#34;2&#34;</span> Type=<span style=color:#2aa198>&#34;REG_DWORD&#34;</span> App=<span style=color:#2aa198>&#34;office16&#34;</span> Id=<span style=color:#2aa198>&#34;L_ShowScreenTips&#34;</span> <span style=color:#268bd2>/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>&lt;User</span> Key=<span style=color:#2aa198>&#34;software\microsoft\office\16.0\common\internet&#34;</span> Name=<span style=color:#2aa198>&#34;opendirectlyinapp&#34;</span> Value=<span style=color:#2aa198>&#34;1&#34;</span> Type=<span style=color:#2aa198>&#34;REG_DWORD&#34;</span> App=<span style=color:#2aa198>&#34;office16&#34;</span> Id=<span style=color:#2aa198>&#34;L_OpenDirectlyInApp&#34;</span> <span style=color:#268bd2>/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>&lt;User</span> Key=<span style=color:#2aa198>&#34;software\microsoft\office\16.0\common\internet&#34;</span> Name=<span style=color:#2aa198>&#34;opendocumentsreadwritewhilebrowsing&#34;</span> Value=<span style=color:#2aa198>&#34;0&#34;</span> Type=<span style=color:#2aa198>&#34;REG_DWORD&#34;</span> App=<span style=color:#2aa198>&#34;office16&#34;</span> Id=<span style=color:#2aa198>&#34;L_OpenOfficedocumentsasreadwritewhilebrowsing&#34;</span> <span style=color:#268bd2>/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>&lt;User</span> Key=<span style=color:#2aa198>&#34;software\microsoft\office\16.0\common\internet&#34;</span> Name=<span style=color:#2aa198>&#34;allowpng&#34;</span> Value=<span style=color:#2aa198>&#34;1&#34;</span> Type=<span style=color:#2aa198>&#34;REG_DWORD&#34;</span> App=<span style=color:#2aa198>&#34;office16&#34;</span> Id=<span style=color:#2aa198>&#34;L_AllowPNGasanoutputformat&#34;</span> <span style=color:#268bd2>/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>&lt;User</span> Key=<span style=color:#2aa198>&#34;software\microsoft\office\16.0\common&#34;</span> Name=<span style=color:#2aa198>&#34;sendcustomerdata&#34;</span> Value=<span style=color:#2aa198>&#34;0&#34;</span> Type=<span style=color:#2aa198>&#34;REG_DWORD&#34;</span> App=<span style=color:#2aa198>&#34;office16&#34;</span> Id=<span style=color:#2aa198>&#34;L_Sendcustomerdata&#34;</span> <span style=color:#268bd2>/&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#268bd2>&lt;/AppSettings&gt;</span>
</span></span><span style=display:flex><span><span style=color:#268bd2>&lt;/Configuration&gt;</span>
</span></span></code></pre></div><h2 id=modifying-existing-installation>Modifying Existing Installation
<a class=header-link href=#modifying-existing-installation><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Theoretically, you can alter an existing installation with the same tool and a config that looks a bit different. <strong>But it did not work.</strong> So I had to uninstall and reinstall.</p><p>I tried the following config and it did not work. Note, version, ID and language must match what's installed hence I have used <code>MatchInstalled</code> and <code>MatchOS</code> in the file.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#268bd2>&lt;Configuration&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#268bd2>&lt;Remove</span> Version=<span style=color:#2aa198>&#34;MatchInstalled&#34;</span><span style=color:#268bd2>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>&lt;Product</span> ID=<span style=color:#2aa198>&#34;O365ProPlusRetail&#34;</span><span style=color:#268bd2>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#268bd2>&lt;Language</span> ID=<span style=color:#2aa198>&#34;MatchOS&#34;</span> <span style=color:#268bd2>/&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#268bd2>&lt;ExcludeApp</span> ID=<span style=color:#2aa198>&#34;Access&#34;</span> <span style=color:#268bd2>/&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#268bd2>&lt;ExcludeApp</span> ID=<span style=color:#2aa198>&#34;Bing&#34;</span> <span style=color:#268bd2>/&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#268bd2>&lt;ExcludeApp</span> ID=<span style=color:#2aa198>&#34;Groove&#34;</span> <span style=color:#268bd2>/&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#268bd2>&lt;ExcludeApp</span> ID=<span style=color:#2aa198>&#34;Lync&#34;</span> <span style=color:#268bd2>/&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#268bd2>&lt;ExcludeApp</span> ID=<span style=color:#2aa198>&#34;Publisher&#34;</span> <span style=color:#268bd2>/&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#268bd2>&lt;ExcludeApp</span> ID=<span style=color:#2aa198>&#34;Teams&#34;</span> <span style=color:#268bd2>/&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#268bd2>&lt;ExcludeApp</span> ID=<span style=color:#2aa198>&#34;Outlook&#34;</span> <span style=color:#268bd2>/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>&lt;/Product&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#268bd2>&lt;/Remove&gt;</span>
</span></span><span style=display:flex><span><span style=color:#268bd2>&lt;/Configuration&gt;</span>
</span></span></code></pre></div></div><footer><p class=meta><span class=categories>Tags:
<a class=category href=https://parsiya.io/tags/office>office</a> <a class=category href=https://parsiya.io/tags/windows>Windows</a></span></p></footer></article></div><aside class="sidebar thirds"><section class="first odd"><h2>Table of Contents</h2><nav id=TableOfContents><ul><li><ul><li><a href=#modifying-existing-installation>Modifying Existing Installation</a></li></ul></li></ul></nav></section></aside></div></div><footer role=contentinfo><p>Copyright &copy; 2024 Parsia-Clone - <a href=https://parsiya.io/license/>License</a> -
<span class=credit>Powered by <a target=_blank href=https://gohugo.io rel="noopener noreferrer">Hugo</a> and <a target=_blank href=https://github.com/parsiya/hugo-octopress/ rel="noopener noreferrer">Hugo-Octopress</a> theme.</p></footer></body></html>