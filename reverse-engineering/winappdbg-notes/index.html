<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en lang=en-us>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,minimum-scale=1,maximum-scale=1">
<link href=/css/fonts.css rel=stylesheet type=text/css>
<title>WinAppDbg Notes</title>
<link rel=stylesheet href=/css/hugo-octopress.css>
<link rel=stylesheet href=http://parsiya.io/clone.css>
<link rel=stylesheet href=/css/fork-awesome.min.css>
<link href=http://parsiya.io/favicon.png rel=icon>
<meta name=description content>
<meta name=keywords content="[Parsia Hakimian Parsiya infosec information security]">
<meta name=author content="Parsia-Clone">
<meta name=generator content="Hugo 0.88.1">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="WinAppDbg Notes">
<meta name=twitter:description content="WinAppDbg Main guide is here: http://winappdbg.readthedocs.io/en/latest/ProgrammingGuide.html
32-bit and 64-bit Python Generally you want to debug 32-bit applications in 32-bit Python. You can have both of them together on one machine. When installing the 2nd Python, uncheck register extensions in the installer. On a VM it does not really matter because you can install/uninstall Python 32 and 64 bit versions at will.
Installation Pip installed version 1.5.
To get 1.6, we use the github repo at https://github.">
<meta name=twitter:domain content="parsiya.io">
<meta name=twitter:creator content="@CryptoGangsta">
</head>
<body>
<header role=banner>
<hgroup>
<h1><a href=http://parsiya.io/>Parsia-Clone</a></h1>
<h2>'Documentation is a love letter that you write to your future self.' - Damian Conway</h2>
</hgroup></header>
<nav role=navigation>
<fieldset class=mobile-nav>
<select onchange="location=this.value"><option value>Navigate…</option><option value=https://github.com/parsiya/Parsia-Clone>» Parsia-Clone on Github</option><option value=https://parsiya.net/categories/clone/>» How did I make this?</option><option value=https://parsiya.net>» My Main Website</option></select>
</fieldset>
<ul class=main-navigation>
<li><a href=https://github.com/parsiya/Parsia-Clone title="Parsia-Clone on Github" target=_blank>Parsia-Clone on Github</a></li>
<li><a href=https://parsiya.net/categories/clone/ title="How did I make this?" target=_blank>How did I make this?</a></li>
<li><a href=https://parsiya.net title="My Main Website" target=_blank>My Main Website</a></li>
</ul>
<ul class=subscription>
</ul>
<form action=https://www.google.com/search method=get target=_blank>
<fieldset role=search>
<input class=search type=text name=q results=0 placeholder=Search>
<input type=hidden name=q value=site:http://parsiya.io/>
</fieldset>
</form>
</nav>
<div id=main>
<div id=content>
<div>
<article class=hentry role=article>
<header>
<p class=meta>
1 minute read
- <a class=label href=http://parsiya.io/categories/reverse-engineering/>Reverse engineering </a>
</p>
<h1 class=entry-title>
WinAppDbg Notes
</h1>
<a href=https://github.com/parsiya/Parsia-Clone/tree/main/reverse-engineering/winappdbg-notes/index.md target=_blank>Github Link</a>
</header>
<div class=entry-content>
<h1 id=winappdbg>WinAppDbg</h1>
<p>Main guide is here: <a href=http://winappdbg.readthedocs.io/en/latest/ProgrammingGuide.html rel=nofollow target=_blank>http://winappdbg.readthedocs.io/en/latest/ProgrammingGuide.html</a></p>
<h2 id=32-bit-and-64-bit-python>32-bit and 64-bit Python</h2>
<p>Generally you want to debug 32-bit applications in 32-bit Python. You can have both of them together on one machine. When installing the 2nd Python, uncheck <code>register extensions</code> in the installer. On a VM it does not really matter because you can install/uninstall Python 32 and 64 bit versions at will.</p>
<h2 id=installation>Installation</h2>
<p>Pip installed version 1.5.</p>
<p>To get 1.6, we use the github repo at <a href=https://github.com/MarioVilas/winappdbg rel=nofollow target=_blank>https://github.com/MarioVilas/winappdbg</a>. Clone and run <code>install.bat</code>.</p>
<p>According to the installation documentation we may benefit from additional software.</p>
<ul>
<li>Capstone: <code>python -m pip install capstone-windows</code></li>
<li>distorm3: Download binaries from release page <a href=https://github.com/gdabah/distorm/releases rel=nofollow target=_blank>https://github.com/gdabah/distorm/releases</a></li>
</ul>
<p><a href=https://breakingcode.wordpress.com/2012/04/08/quickpost-installer-for-beaenginepython/ rel=nofollow target=_blank>https://breakingcode.wordpress.com/2012/04/08/quickpost-installer-for-beaenginepython/</a></p>
<p>Has installers for the rest.</p>
<hr>
<h2 id=debugging>Debugging</h2>
<p>This is what I want:</p>
<ul>
<li><p><a href=http://winappdbg.readthedocs.io/en/latest/Debugging.html#breakpoints-watches-and-hooks rel=nofollow target=_blank>http://winappdbg.readthedocs.io/en/latest/Debugging.html#breakpoints-watches-and-hooks</a></p>
<div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#719e07>from</span> winappdbg.win32 <span style=color:#719e07>import</span> <span style=color:#719e07>*</span>


<span style=color:#586e75># Create a snapshot of the process, only take the heap list.</span>
hSnapshot <span style=color:#719e07>=</span> CreateToolhelp32Snapshot( TH32CS_SNAPHEAPLIST, pid )</code></pre></div></li>
<li><p>HexDump:</p>
<ul>
<li><a href=https://github.com/MarioVilas/winappdbg/blob/master/winappdbg/textio.py#L451 rel=nofollow target=_blank>https://github.com/MarioVilas/winappdbg/blob/master/winappdbg/textio.py#L451</a></li>
</ul></li>
<li><p>take_memory_snapshot:</p>
<ul>
<li><a href=https://github.com/MarioVilas/winappdbg/blob/master/winappdbg/process.py#L3261 rel=nofollow target=_blank>https://github.com/MarioVilas/winappdbg/blob/master/winappdbg/process.py#L3261</a></li>
</ul></li>
<li><p>restore_memory_snapshot:</p>
<ul>
<li><a href=https://github.com/MarioVilas/winappdbg/blob/master/winappdbg/process.py#L3301 rel=nofollow target=_blank>https://github.com/MarioVilas/winappdbg/blob/master/winappdbg/process.py#L3301</a></li>
</ul></li>
<li><p>bSkipMappedFiles:</p>
<ul>
<li><a href=https://github.com/MarioVilas/winappdbg/blob/master/winappdbg/process.py#L3317 rel=nofollow target=_blank>https://github.com/MarioVilas/winappdbg/blob/master/winappdbg/process.py#L3317</a></li>
</ul></li>
<li><p>break_at:</p>
<ul>
<li><a href=https://github.com/MarioVilas/winappdbg/blob/master/winappdbg/breakpoint.py#L3905 rel=nofollow target=_blank>https://github.com/MarioVilas/winappdbg/blob/master/winappdbg/breakpoint.py#L3905</a></li>
<li><a href="http://winappdbg.readthedocs.io/en/latest/Debugging.html?highlight=break_at#example-11-setting-a-breakpoint" rel=nofollow target=_blank>http://winappdbg.readthedocs.io/en/latest/Debugging.html?highlight=break_at#example-11-setting-a-breakpoint</a></li>
</ul></li>
<li><p>get_context:</p>
<ul>
<li><a href=https://github.com/MarioVilas/winappdbg/blob/master/winappdbg/thread.py#L469 rel=nofollow target=_blank>https://github.com/MarioVilas/winappdbg/blob/master/winappdbg/thread.py#L469</a></li>
</ul></li>
<li><p>set_context:</p>
<ul>
<li><a href=https://github.com/MarioVilas/winappdbg/blob/master/winappdbg/thread.py#L570 rel=nofollow target=_blank>https://github.com/MarioVilas/winappdbg/blob/master/winappdbg/thread.py#L570</a></li>
</ul></li>
<li><p>All memory read stuff are at:</p>
<ul>
<li><a href=https://github.com/MarioVilas/winappdbg/blob/master/winappdbg/process.py#L125 rel=nofollow target=_blank>https://github.com/MarioVilas/winappdbg/blob/master/winappdbg/process.py#L125</a></li>
</ul></li>
<li><p>Use built-in Table:</p>
<ul>
<li><a href=https://github.com/MarioVilas/winappdbg/blob/master/winappdbg/textio.py#L1094 rel=nofollow target=_blank>https://github.com/MarioVilas/winappdbg/blob/master/winappdbg/textio.py#L1094</a></li>
<li><code>table = Table("|")</code> we can add separator here.</li>
</ul></li>
<li><p>Logger class:</p>
<ul>
<li><a href=https://github.com/MarioVilas/winappdbg/blob/master/winappdbg/textio.py#L1766 rel=nofollow target=_blank>https://github.com/MarioVilas/winappdbg/blob/master/winappdbg/textio.py#L1766</a></li>
</ul></li>
</ul>
</div>
<footer>
<p class=meta>
<span class=categories>
Tags:
<a class=category href=http://parsiya.io/tags/winappdbg>winappdbg</a>
</span>
</p>
</footer>
</article>
</div>
<aside class="sidebar thirds">
<section class="first odd">
<h2>Table of Contents</h2>
<nav id=TableOfContents>
<ul>
<li><a href=#winappdbg>WinAppDbg</a>
<ul>
<li><a href=#32-bit-and-64-bit-python>32-bit and 64-bit Python</a></li>
<li><a href=#installation>Installation</a></li>
<li><a href=#debugging>Debugging</a></li>
</ul></li>
</ul>
</nav>
</section>
</aside>
</div>
</div>
<footer role=contentinfo>
<p>Copyright &copy; 2021 Parsia-Clone - <a href=http://parsiya.io/license/>License</a> -
<span class=credit>Powered by <a target=_blank href=https://gohugo.io>Hugo</a> and <a target=_blank href=https://github.com/parsiya/hugo-octopress/>Hugo-Octopress</a> theme.
</p>
</footer>
</body>
</html>