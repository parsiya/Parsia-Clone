<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,minimum-scale=1,maximum-scale=1"><link href=/css/fonts.css rel=stylesheet type=text/css><title>WinAppDbg Notes</title><link rel=stylesheet href=/css/hugo-octopress.css><link rel=stylesheet href=https://parsiya.io/clone.css><link rel=stylesheet href=/css/fork-awesome.min.css><link href=https://parsiya.io/favicon.png rel=icon><meta name=description content><meta name=keywords content="[Parsia Hakimian Parsiya infosec information security]"><meta name=author content="Parsia-Clone"><meta name=generator content="Hugo 0.118.2"><meta name=twitter:card content="summary"><meta name=twitter:title content="WinAppDbg Notes"><meta name=twitter:description content="WinAppDbg Main guide is here: http://winappdbg.readthedocs.io/en/latest/ProgrammingGuide.html
32-bit and 64-bit Python Generally you want to debug 32-bit applications in 32-bit Python. You can have both of them together on one machine. When installing the 2nd Python, uncheck register extensions in the installer. On a VM it does not really matter because you can install/uninstall Python 32 and 64 bit versions at will.
Installation Pip installed version 1.5.
To get 1.6, we use the github repo at https://github."><meta name=twitter:domain content="parsiya.io"><meta name=twitter:creator content="@CryptoGangsta"></head><body><header role=banner><hgroup><h1><a href=https://parsiya.io/>Parsia-Clone</a></h1><h2>'Documentation is a love letter that you write to your future self.' - Damian Conway</h2></hgroup></header><nav role=navigation><fieldset class=mobile-nav><select onchange="location=this.value"><option value>Navigate…</option><option value=https://github.com/parsiya/Parsia-Clone>» Parsia-Clone on Github</option><option value=https://parsiya.net/categories/clone/>» How did I make this?</option><option value=https://parsiya.net>» My Main Website</option></select></fieldset><ul class=main-navigation><li><a href=https://github.com/parsiya/Parsia-Clone title="Parsia-Clone on Github" target=_blank rel="noopener noreferrer">Parsia-Clone on Github</a></li><li><a href=https://parsiya.net/categories/clone/ title="How did I make this?" target=_blank rel="noopener noreferrer">How did I make this?</a></li><li><a href=https://parsiya.net title="My Main Website" target=_blank rel="noopener noreferrer">My Main Website</a></li></ul><ul class=subscription></ul><form action=https://www.google.com/search method=get target=_blank rel="noopener noreferrer"><fieldset role=search><input class=search type=text name=q results=0 placeholder=Search>
<input type=hidden name=q value=site:https://parsiya.io/></fieldset></form></nav><div id=main><div id=content><div><article class=hentry role=article><header><p class=meta>1 minute read
- <a class=label href=https://parsiya.io/categories/reverse-engineering/>Reverse engineering</a></p><h1 class=entry-title>WinAppDbg Notes</h1><a href=https://github.com/parsiya/Parsia-Clone/tree/main/reverse-engineering/winappdbg-notes/index.md target=_blank>Github Link</a></header><div class=entry-content><h1 id=winappdbg>WinAppDbg
<a class=header-link href=#winappdbg><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><p>Main guide is here: <a href=http://winappdbg.readthedocs.io/en/latest/ProgrammingGuide.html target=_blank rel="noreferrer noopener">http://winappdbg.readthedocs.io/en/latest/ProgrammingGuide.html</a></p><h2 id=32-bit-and-64-bit-python>32-bit and 64-bit Python
<a class=header-link href=#32-bit-and-64-bit-python><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Generally you want to debug 32-bit applications in 32-bit Python. You can have both of them together on one machine. When installing the 2nd Python, uncheck <code>register extensions</code> in the installer. On a VM it does not really matter because you can install/uninstall Python 32 and 64 bit versions at will.</p><h2 id=installation>Installation
<a class=header-link href=#installation><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Pip installed version 1.5.</p><p>To get 1.6, we use the github repo at <a href=https://github.com/MarioVilas/winappdbg target=_blank rel="noreferrer noopener">https://github.com/MarioVilas/winappdbg</a>. Clone and run <code>install.bat</code>.</p><p>According to the installation documentation we may benefit from additional software.</p><ul><li>Capstone: <code>python -m pip install capstone-windows</code></li><li>distorm3: Download binaries from release page <a href=https://github.com/gdabah/distorm/releases target=_blank rel="noreferrer noopener">https://github.com/gdabah/distorm/releases</a></li></ul><p><a href=https://breakingcode.wordpress.com/2012/04/08/quickpost-installer-for-beaenginepython/ target=_blank rel="noreferrer noopener">https://breakingcode.wordpress.com/2012/04/08/quickpost-installer-for-beaenginepython/</a></p><p>Has installers for the rest.</p><hr><h2 id=debugging>Debugging
<a class=header-link href=#debugging><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>This is what I want:</p><ul><li><a href=http://winappdbg.readthedocs.io/en/latest/Debugging.html#breakpoints-watches-and-hooks target=_blank rel="noreferrer noopener">http://winappdbg.readthedocs.io/en/latest/Debugging.html#breakpoints-watches-and-hooks</a></li></ul><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#719e07>from</span> winappdbg.win32 <span style=color:#719e07>import</span> <span style=color:#719e07>*</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># Create a snapshot of the process, only take the heap list.</span>
</span></span><span style=display:flex><span>hSnapshot <span style=color:#719e07>=</span> CreateToolhelp32Snapshot( TH32CS_SNAPHEAPLIST, pid )
</span></span></code></pre></div><ul><li>HexDump:<ul><li><a href=https://github.com/MarioVilas/winappdbg/blob/master/winappdbg/textio.py#L451 target=_blank rel="noreferrer noopener">https://github.com/MarioVilas/winappdbg/blob/master/winappdbg/textio.py#L451</a></li></ul></li><li>take_memory_snapshot:<ul><li><a href=https://github.com/MarioVilas/winappdbg/blob/master/winappdbg/process.py#L3261 target=_blank rel="noreferrer noopener">https://github.com/MarioVilas/winappdbg/blob/master/winappdbg/process.py#L3261</a></li></ul></li><li>restore_memory_snapshot:<ul><li><a href=https://github.com/MarioVilas/winappdbg/blob/master/winappdbg/process.py#L3301 target=_blank rel="noreferrer noopener">https://github.com/MarioVilas/winappdbg/blob/master/winappdbg/process.py#L3301</a></li></ul></li><li>bSkipMappedFiles:<ul><li><a href=https://github.com/MarioVilas/winappdbg/blob/master/winappdbg/process.py#L3317 target=_blank rel="noreferrer noopener">https://github.com/MarioVilas/winappdbg/blob/master/winappdbg/process.py#L3317</a></li></ul></li><li>break_at:<ul><li><a href=https://github.com/MarioVilas/winappdbg/blob/master/winappdbg/breakpoint.py#L3905 target=_blank rel="noreferrer noopener">https://github.com/MarioVilas/winappdbg/blob/master/winappdbg/breakpoint.py#L3905</a></li><li><a href="http://winappdbg.readthedocs.io/en/latest/Debugging.html?highlight=break_at#example-11-setting-a-breakpoint" target=_blank rel="noreferrer noopener">http://winappdbg.readthedocs.io/en/latest/Debugging.html?highlight=break_at#example-11-setting-a-breakpoint</a></li></ul></li><li>get_context:<ul><li><a href=https://github.com/MarioVilas/winappdbg/blob/master/winappdbg/thread.py#L469 target=_blank rel="noreferrer noopener">https://github.com/MarioVilas/winappdbg/blob/master/winappdbg/thread.py#L469</a></li></ul></li><li>set_context:<ul><li><a href=https://github.com/MarioVilas/winappdbg/blob/master/winappdbg/thread.py#L570 target=_blank rel="noreferrer noopener">https://github.com/MarioVilas/winappdbg/blob/master/winappdbg/thread.py#L570</a></li></ul></li><li>All memory read stuff are at:<ul><li><a href=https://github.com/MarioVilas/winappdbg/blob/master/winappdbg/process.py#L125 target=_blank rel="noreferrer noopener">https://github.com/MarioVilas/winappdbg/blob/master/winappdbg/process.py#L125</a></li></ul></li><li>Use built-in Table:<ul><li><a href=https://github.com/MarioVilas/winappdbg/blob/master/winappdbg/textio.py#L1094 target=_blank rel="noreferrer noopener">https://github.com/MarioVilas/winappdbg/blob/master/winappdbg/textio.py#L1094</a></li><li><code>table = Table("|")</code> we can add separator here.</li></ul></li><li>Logger class:<ul><li><a href=https://github.com/MarioVilas/winappdbg/blob/master/winappdbg/textio.py#L1766 target=_blank rel="noreferrer noopener">https://github.com/MarioVilas/winappdbg/blob/master/winappdbg/textio.py#L1766</a></li></ul></li></ul></div><footer><p class=meta><span class=categories>Tags:
<a class=category href=https://parsiya.io/tags/winappdbg>winappdbg</a></span></p></footer></article></div><aside class="sidebar thirds"><section class="first odd"><h2>Table of Contents</h2><nav id=TableOfContents><ul><li><a href=#winappdbg>WinAppDbg</a><ul><li><a href=#32-bit-and-64-bit-python>32-bit and 64-bit Python</a></li><li><a href=#installation>Installation</a></li><li><a href=#debugging>Debugging</a></li></ul></li></ul></nav></section></aside></div></div><footer role=contentinfo><p>Copyright &copy; 2023 Parsia-Clone - <a href=https://parsiya.io/license/>License</a> -
<span class=credit>Powered by <a target=_blank href=https://gohugo.io rel="noopener noreferrer">Hugo</a> and <a target=_blank href=https://github.com/parsiya/hugo-octopress/ rel="noopener noreferrer">Hugo-Octopress</a> theme.</p></footer></body></html>