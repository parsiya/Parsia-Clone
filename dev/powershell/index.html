<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,minimum-scale=1,maximum-scale=1"><link href=/css/fonts.css rel=stylesheet type=text/css><title>CyberAces PowerShell Notes</title>
<link rel=stylesheet href=/css/hugo-octopress.css><link rel=stylesheet href=https://parsiya.io/clone.css><link rel=stylesheet href=/css/fork-awesome.min.css><link href=https://parsiya.io/favicon.png rel=icon><meta name=description content><meta name=keywords content="[Parsia Hakimian Parsiya infosec information security]"><meta name=author content="Parsia-Clone"><meta name=generator content="Hugo 0.121.1"><meta name=twitter:card content="summary"><meta name=twitter:title content="CyberAces PowerShell Notes"><meta name=twitter:description content="SANS has some free streaming tutorials. You can see them here: https://tutorials.cyberaces.org/tutorials
This is pretty basic but I think the notes will act as a good summary that people can read instead of watching the videos. These notes are now loosely based on the videos and have a lot of items that I have added. If you follow the videos and read the notes, the sequence of topics may not match."><meta name=twitter:domain content="parsiya.io"><meta name=twitter:creator content="@CryptoGangsta"></head><body><header role=banner><hgroup><h1><a href=https://parsiya.io/>Parsia-Clone</a></h1><h2>'Documentation is a love letter that you write to your future self.' - Damian Conway</h2></hgroup></header><nav role=navigation><fieldset class=mobile-nav><select onchange="location=this.value"><option value>Navigate…</option><option value=https://github.com/parsiya/Parsia-Clone>» Parsia-Clone on Github</option><option value=https://parsiya.net/categories/clone/>» How did I make this?</option><option value=https://parsiya.net>» My Main Website</option></select></fieldset><ul class=main-navigation><li><a href=https://github.com/parsiya/Parsia-Clone title="Parsia-Clone on Github" target=_blank rel="noopener noreferrer">Parsia-Clone on Github</a></li><li><a href=https://parsiya.net/categories/clone/ title="How did I make this?" target=_blank rel="noopener noreferrer">How did I make this?</a></li><li><a href=https://parsiya.net title="My Main Website" target=_blank rel="noopener noreferrer">My Main Website</a></li></ul><ul class=subscription></ul><form action=https://www.google.com/search method=get target=_blank rel="noopener noreferrer"><fieldset role=search><input class=search type=text name=q results=0 placeholder=Search>
<input type=hidden name=q value=site:https://parsiya.io/></fieldset></form></nav><div id=main><div id=content><div><article class=hentry role=article><header><p class=meta>23 minute read
- <a class=label href=https://parsiya.io/categories/development/>Development</a></p><h1 class=entry-title>CyberAces PowerShell Notes</h1><a href=https://github.com/parsiya/Parsia-Clone/tree/main/dev/powershell.md target=_blank>Github Link</a></header><div class=entry-content><nav id=TableOfContents><ul><li><ul><li><a href=#case-sensitivity>Case Sensitivity</a></li><li><a href=#how-to-get-help---this-is-your-best-friend>How to Get Help - This is Your Best Friend</a><ul><li><a href=#get-help-or-help-or-man>Get-Help or help or man</a></li></ul></li><li><a href=#aliases>Aliases</a><ul><li><a href=#get-alias-cmdlet>Get-Alias Cmdlet</a></li><li><a href=#set-alias>Set-Alias</a></li><li><a href=#common-aliases-between-powershell-and-bash>Common Aliases Between PowerShell and Bash</a></li></ul></li><li><a href=#session-1---introduction-to-powershell>Session 1 - Introduction to PowerShell</a><ul><li><a href=#naming-convention>Naming Convention</a></li><li><a href=#parameters>Parameters</a></li><li><a href=#get-member>Get-Member</a></li><li><a href=#piping>Piping</a></li></ul></li><li><a href=#session-2---cmdlets>Session 2 - Cmdlets</a><ul><li><a href=#get-childitem>Get-ChildItem</a><ul><li><a href=#read-registry>Read Registry</a></li><li><a href=#read-windows-certificate-store>Read Windows Certificate Store</a></li></ul></li><li><a href=#cd-or-change-directory>cd or Change Directory</a></li></ul></li><li><a href=#session-3-scripting-variables-and-syntax>Session 3: Scripting, Variables and Syntax</a><ul><li><a href=#executionpolicy>ExecutionPolicy</a></li><li><a href=#variables>Variables</a><ul><li><a href=#variable-types>Variable Types</a></li></ul></li><li><a href=#arrays>Arrays</a></li><li><a href=#get-member-1>Get-Member</a><ul><li><a href=#get-childitem-variable>Get-ChildItem variable:</a></li></ul></li><li><a href=#user-properties-of-cmdlet-output>User Properties of Cmdlet Output</a></li><li><a href=#double-quotes-vs-single-quotes>Double Quotes vs. Single Quotes</a></li></ul></li><li><a href=#section-4---flow-control>Section 4 - Flow Control</a><ul><li><a href=#whatif---confirm---verbose>WhatIf - Confirm - Verbose</a></li><li><a href=#operators>Operators</a></li><li><a href=#if---then---else>If - Then - Else</a></li><li><a href=#where-object-filtering>Where-Object Filtering</a></li><li><a href=#foreach-object>ForEach-Object</a></li><li><a href=#select-object>Select-Object</a></li><li><a href=#output-and-the-format-verb>Output and the Format Verb</a></li><li><a href=#file-output>File Output</a></li><li><a href=#export-csv-and-import-csv>Export-CSV and Import-CSV</a></li><li><a href=#measure-object>Measure-Object</a></li></ul></li><li><a href=#section-5---practical-uses--conclusion>Section 5 - Practical Uses & Conclusion</a><ul><li><a href=#ping-all-ips-in-a-range>Ping All IPs in a Range</a></li><li><a href=#process-manipulation>Process Manipulation</a></li><li><a href=#-verb>-Verb</a></li><li><a href=#iterate-through-files-in-a-folder>Iterate Through Files in a Folder</a></li><li><a href=#get-filehash>Get-FileHash</a></li><li><a href=#select-string-almost-like-grep>Select-String (almost like grep)</a></li></ul></li></ul></li></ul></nav><p>SANS has some free streaming tutorials. You can see them here:
<a href=https://tutorials.cyberaces.org/tutorials target=_blank rel="noreferrer noopener">https://tutorials.cyberaces.org/tutorials</a></p><p>This is pretty basic but I think the notes will act as a good summary that
people can read instead of watching the videos. These notes are now loosely
based on the videos and have a lot of items that I have added. If you follow the
videos and read the notes, the sequence of topics may not match.</p><h2 id=case-sensitivity>Case Sensitivity
<a class=header-link href=#case-sensitivity><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>I usually write the cmdlets in camel case but you usually do not have to. E.g.,
<code>man Get-ChildItem</code> and <code>man get-childitem</code> both work. Camel case helps with
readability.</p><h2 id=how-to-get-help---this-is-your-best-friend>How to Get Help - This is Your Best Friend
<a class=header-link href=#how-to-get-help---this-is-your-best-friend><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><ul><li>Before you start, open an admin PowerShell prompt and run <code>Update-Help</code>. In a
normal prompt, not all modules can be updated. This may take a few minutes.</li><li>After that you can essentially do <code>help command</code> or <code>help command -Examples</code>
(the examples are great).<ul><li>If the help page is longer than one screen you can do
<code>help command -Examples | more</code> to paginate it.</li></ul></li><li><code>Get-Help command -Full</code> shows everything so might want to paginate it all the
time.</li></ul><h3 id=get-help-or-help-or-man>Get-Help or help or man
<a class=header-link href=#get-help-or-help-or-man><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>Displays help. For example: <code>Get-Help ls</code> or <code>help ls</code> or <code>man ls</code>.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#b58900>get-help</span> <span style=color:#b58900>ls
</span></span></span><span style=display:flex><span><span style=color:#b58900></span>NAME
</span></span><span style=display:flex><span>    <span style=color:#b58900>Get-ChildItem</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>SYNTAX
</span></span><span style=display:flex><span>    <span style=color:#b58900>Get-ChildItem</span> [[-Path] &lt;string[]&gt;] [[-Filter] &lt;string&gt;] [-Include &lt;string[]&gt;] [-Exclude &lt;string[]&gt;] [-Recurse]
</span></span><span style=display:flex><span>    [-Depth &lt;uint32&gt;] [-Force] [-Name] [-UseTransaction] [-Attributes &lt;FlagsExpression[<span style=color:#cb4b16>FileAttributes</span>]&gt; {ReadOnly |
</span></span><span style=display:flex><span>    Hidden | System | Directory | Archive | Device | Normal | Temporary | SparseFile | ReparsePoint | Compressed |
</span></span><span style=display:flex><span>    Offline | NotContentIndexed | Encrypted | IntegrityStream | NoScrubData}] [-Directory] [<span style=color:#719e07>-File</span>] [-Hidden]
</span></span><span style=display:flex><span>    [-ReadOnly] [-System]  [&lt;CommonParameters&gt;]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#b58900>Get-ChildItem</span> [[-Filter] &lt;string&gt;] -LiteralPath &lt;string[]&gt; [-Include &lt;string[]&gt;] [-Exclude &lt;string[]&gt;] [-Recurse]
</span></span><span style=display:flex><span>    [-Depth &lt;uint32&gt;] [-Force] [-Name] [-UseTransaction] [-Attributes &lt;FlagsExpression[<span style=color:#cb4b16>FileAttributes</span>]&gt; {ReadOnly |
</span></span><span style=display:flex><span>    Hidden | System | Directory | Archive | Device | Normal | Temporary | SparseFile | ReparsePoint | Compressed |
</span></span><span style=display:flex><span>    Offline | NotContentIndexed | Encrypted | IntegrityStream | NoScrubData}] [-Directory] [<span style=color:#719e07>-File</span>] [-Hidden]
</span></span><span style=display:flex><span>    [-ReadOnly] [-System]  [&lt;CommonParameters&gt;]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ALIASES
</span></span><span style=display:flex><span>    <span style=color:#b58900>gci
</span></span></span><span style=display:flex><span><span style=color:#b58900></span>    <span style=color:#b58900>ls
</span></span></span><span style=display:flex><span><span style=color:#b58900></span>    <span style=color:#b58900>dir
</span></span></span><span style=display:flex><span><span style=color:#b58900></span>
</span></span><span style=display:flex><span>REMARKS
</span></span><span style=display:flex><span>    <span style=color:#b58900>Get-Help</span> cannot find the Help files <span style=color:#719e07>for</span> this cmdlet on this computer. It is displaying only partial help.
</span></span><span style=display:flex><span>        -- To download and install Help files <span style=color:#719e07>for</span> the module that includes this cmdlet, use <span style=color:#b58900>Update-Help</span>.
</span></span><span style=display:flex><span>        -- To view the Help topic <span style=color:#719e07>for</span> this cmdlet online, type: <span style=color:#2aa198>&#34;Get-Help Get-ChildItem -Online&#34;</span> or
</span></span><span style=display:flex><span>           go to http://go.microsoft.com/fwlink/<span style=color:#719e07>?</span>LinkID=<span style=color:#2aa198>113308</span>.
</span></span></code></pre></div><ul><li>In order to <code>Update-Help</code> run in it an admin PowerShell window. Otherwise, it
cannot update all modules. It takes a while to update everything.</li><li>By default it does not show all the help. We can use <code>-Full</code> or <code>-Examples</code> to
show more. Warning <code>-Full</code> returns a ton of stuff.</li></ul><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>PS&gt; <span style=color:#b58900>get-help</span> <span style=color:#b58900>ls </span>-examples
</span></span><span style=display:flex><span>NAME
</span></span><span style=display:flex><span>    <span style=color:#b58900>Get-ChildItem</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>SYNOPSIS
</span></span><span style=display:flex><span>    Gets the items and child items <span style=color:#719e07>in</span> one or more specified locations.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Example <span style=color:#2aa198>1</span>: Get child items <span style=color:#719e07>in</span> the current directory
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#b58900>PS </span>C:\&gt;<span style=color:#b58900>Get-ChildItem</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    This command gets the child items <span style=color:#719e07>in</span> the current location. <span style=color:#719e07>If</span> the location is a file system directory, it gets the
</span></span><span style=display:flex><span>    files and <span style=color:#b58900>sub-directories</span> <span style=color:#719e07>in</span> the current directory. <span style=color:#719e07>If</span> the item does not have child items, this command returns to
</span></span><span style=display:flex><span>    the command prompt without displaying anything.
</span></span></code></pre></div><ul><li>You can filter by Noun. For example <code>Get-Command -Noun Service</code>:</li></ul><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#b58900>Get-Command</span> -Noun service
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>CommandType     Name                                               Version    Source
</span></span><span style=display:flex><span>-----------     ----                                               -------    ------
</span></span><span style=display:flex><span>Cmdlet          <span style=color:#b58900>Get-Service</span>                                        <span style=color:#2aa198>3.1</span>.0.0    Microsoft.PowerShell.Management
</span></span><span style=display:flex><span>Cmdlet          <span style=color:#b58900>New-Service</span>                                        <span style=color:#2aa198>3.1</span>.0.0    Microsoft.PowerShell.Management
</span></span><span style=display:flex><span>Cmdlet          <span style=color:#b58900>Restart-Service</span>                                    <span style=color:#2aa198>3.1</span>.0.0    Microsoft.PowerShell.Management
</span></span><span style=display:flex><span>Cmdlet          <span style=color:#b58900>Resume-Service</span>                                     <span style=color:#2aa198>3.1</span>.0.0    Microsoft.PowerShell.Management
</span></span><span style=display:flex><span>Cmdlet          <span style=color:#b58900>Set-Service</span>                                        <span style=color:#2aa198>3.1</span>.0.0    Microsoft.PowerShell.Management
</span></span><span style=display:flex><span>Cmdlet          <span style=color:#b58900>Start-Service</span>                                      <span style=color:#2aa198>3.1</span>.0.0    Microsoft.PowerShell.Management
</span></span><span style=display:flex><span>Cmdlet          <span style=color:#b58900>Stop-Service</span>                                       <span style=color:#2aa198>3.1</span>.0.0    Microsoft.PowerShell.Management
</span></span><span style=display:flex><span>Cmdlet          <span style=color:#b58900>Suspend-Service</span>                                    <span style=color:#2aa198>3.1</span>.0.0    Microsoft.PowerShell.Management
</span></span></code></pre></div><ul><li>Or filter by Module. Useful for 3rd party modules. E.g.,
<code>Get-Command -Module Microsoft.PowerShell.Core</code>:</li></ul><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#b58900>Get-Command</span> -Module Microsoft.PowerShell.Core
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>CommandType     Name                                               Version    Source
</span></span><span style=display:flex><span>-----------     ----                                               -------    ------
</span></span><span style=display:flex><span>Cmdlet          <span style=color:#b58900>Add-History</span>                                        <span style=color:#2aa198>3.0</span>.0.0    Microsoft.PowerShell.Core
</span></span><span style=display:flex><span>Cmdlet          <span style=color:#b58900>Add-PSSnapin</span>                                       <span style=color:#2aa198>3.0</span>.0.0    Microsoft.PowerShell.Core
</span></span><span style=display:flex><span>Cmdlet          <span style=color:#b58900>Clear-History</span>                                      <span style=color:#2aa198>3.0</span>.0.0    Microsoft.PowerShell.Core
</span></span><span style=display:flex><span>Cmdlet          <span style=color:#b58900>Connect-PSSession</span>                                  <span style=color:#2aa198>3.0</span>.0.0    Microsoft.PowerShell.Core
</span></span><span style=display:flex><span>Cmdlet          <span style=color:#b58900>Debug-Job</span>                                          <span style=color:#2aa198>3.0</span>.0.0    Microsoft.PowerShell.Core
</span></span><span style=display:flex><span>Cmdlet          <span style=color:#b58900>Disable-PSRemoting</span>                                 <span style=color:#2aa198>3.0</span>.0.0    Microsoft.PowerShell.Core
</span></span></code></pre></div><ul><li>It also has this search feature. If you do not know what exactly you are
looking for, just do <code>man whatever</code> and it will find you the cmdlets that have
<code>whatever</code> in them:</li></ul><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#b58900>man </span>executionpolicy
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Name                              Category  Module                    Synopsis
</span></span><span style=display:flex><span>----                              --------  ------                    --------
</span></span><span style=display:flex><span><span style=color:#b58900>Get-ExecutionPolicy</span>               Cmdlet    Microsoft.PowerShell.S... Gets the execution policies <span style=color:#719e07>for</span> the current se...
</span></span><span style=display:flex><span><span style=color:#b58900>Set-ExecutionPolicy</span>               Cmdlet    Microsoft.PowerShell.S... Changes the user preference <span style=color:#719e07>for</span> the Windows Po...
</span></span></code></pre></div><h2 id=aliases>Aliases
<a class=header-link href=#aliases><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Some commands have aliases.</p><ul><li>For example <code>dir</code> or <code>ls</code> both work because they are aliases of <code>Get-ChildItem</code>.</li><li>You can create, delete and modify aliases.</li></ul><h3 id=get-alias-cmdlet>Get-Alias Cmdlet
<a class=header-link href=#get-alias-cmdlet><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><ul><li><a href=https://technet.microsoft.com/en-us/library/ee176839.aspx target=_blank rel="noreferrer noopener">https://technet.microsoft.com/en-us/library/ee176839.aspx</a></li><li>To see all aliases use the <code>Get-Alias</code> command.</li><li>To see aliases for a certain command use <code>Get-Alias -name l*</code> which shows all
aliases which start with <code>l</code>.</li></ul><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>PS&gt; <span style=color:#b58900>Get-Alias</span> l*
</span></span><span style=display:flex><span>CommandType     Name                                               Version    Source
</span></span><span style=display:flex><span>-----------     ----                                               -------    ------
</span></span><span style=display:flex><span><span style=color:#b58900>Alias</span>           <span style=color:#b58900>lp </span>-&gt; <span style=color:#b58900>Out-Printer</span>
</span></span><span style=display:flex><span><span style=color:#b58900>Alias</span>           <span style=color:#b58900>ls </span>-&gt; <span style=color:#b58900>Get-ChildItem</span>
</span></span></code></pre></div><ul><li>Or just search what an alias points to like <code>Get-Alias dir</code>:</li></ul><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>PS&gt; <span style=color:#b58900>Get-Alias</span> <span style=color:#b58900>dir
</span></span></span><span style=display:flex><span><span style=color:#b58900></span>CommandType     Name                                               Version    Source
</span></span><span style=display:flex><span>-----------     ----                                               -------    ------
</span></span><span style=display:flex><span><span style=color:#b58900>Alias</span>           <span style=color:#b58900>dir </span>-&gt; <span style=color:#b58900>Get-ChildItem</span>
</span></span></code></pre></div><ul><li>To search the aliases for a cmdlet use <code>Get-Alias -Definition Get-ChildItem</code>:</li></ul><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>PS&gt;<span style=color:#b58900>Get-Alias</span> -Definition <span style=color:#b58900>get-childitem</span>
</span></span><span style=display:flex><span>CommandType     Name                                               Version    Source
</span></span><span style=display:flex><span>-----------     ----                                               -------    ------
</span></span><span style=display:flex><span><span style=color:#b58900>Alias</span>           <span style=color:#b58900>dir </span>-&gt; <span style=color:#b58900>Get-ChildItem</span>
</span></span><span style=display:flex><span><span style=color:#b58900>Alias</span>           <span style=color:#b58900>gci </span>-&gt; <span style=color:#b58900>Get-ChildItem</span>
</span></span><span style=display:flex><span><span style=color:#b58900>Alias</span>           <span style=color:#b58900>ls </span>-&gt; <span style=color:#b58900>Get-ChildItem</span>
</span></span></code></pre></div><h3 id=set-alias>Set-Alias
<a class=header-link href=#set-alias><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>To create our own alias use <code>Set-Alias -Name mydir -Value ls</code>:</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>PS&gt; <span style=color:#b58900>Set-Alias</span> -Name mydir -Value <span style=color:#b58900>ls
</span></span></span><span style=display:flex><span><span style=color:#b58900></span>PS&gt; <span style=color:#b58900>Get-Alias</span> -Definition <span style=color:#b58900>ls
</span></span></span><span style=display:flex><span><span style=color:#b58900></span>
</span></span><span style=display:flex><span>CommandType     Name                                               Version    Source
</span></span><span style=display:flex><span>-----------     ----                                               -------    ------
</span></span><span style=display:flex><span><span style=color:#b58900>Alias</span>           mydir -&gt; <span style=color:#b58900>Get-ChildItem</span>
</span></span></code></pre></div><p>Note that this is an alias for <code>ls</code> so it does not show up in the list of
aliases for <code>Get-ChildItem</code> (which <code>ls</code> is an alias of):</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#b58900>Get-Alias</span> -Definition <span style=color:#b58900>Get-ChildItem</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>CommandType     Name                                               Version    Source
</span></span><span style=display:flex><span>-----------     ----                                               -------    ------
</span></span><span style=display:flex><span><span style=color:#b58900>Alias</span>           <span style=color:#b58900>dir </span>-&gt; <span style=color:#b58900>Get-ChildItem</span>
</span></span><span style=display:flex><span><span style=color:#b58900>Alias</span>           <span style=color:#b58900>gci </span>-&gt; <span style=color:#b58900>Get-ChildItem</span>
</span></span><span style=display:flex><span><span style=color:#b58900>Alias</span>           <span style=color:#b58900>ls </span>-&gt; <span style=color:#b58900>Get-ChildItem</span>
</span></span></code></pre></div><h3 id=common-aliases-between-powershell-and-bash>Common Aliases Between PowerShell and Bash
<a class=header-link href=#common-aliases-between-powershell-and-bash><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>A lot of PowerShell aliases are the name of bash commands. For example <code>man</code> is
and alias for <code>help</code>:</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#b58900>Get-Alias</span> -Definition Help
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>CommandType     Name                                               Version    Source
</span></span><span style=display:flex><span>-----------     ----                                               -------    ------
</span></span><span style=display:flex><span><span style=color:#b58900>Alias</span>           <span style=color:#b58900>man </span>-&gt; help
</span></span></code></pre></div><p>A couple of cheat sheets:</p><ul><li><a href=http://xahlee.info/powershell/PowerShell_for_unixer.html target=_blank rel="noreferrer noopener">http://xahlee.info/powershell/PowerShell_for_unixer.html</a></li><li><a href=http://cecs.wright.edu/~pmateti/Courses/233/Labs/Scripting/bashVsPowerShellTable.html target=_blank rel="noreferrer noopener">http://cecs.wright.edu/~pmateti/Courses/233/Labs/Scripting/bashVsPowerShellTable.html</a></li><li><a href=http://cecs.wright.edu/~pmateti/Courses/233/Top/233-CheatSheet.html target=_blank rel="noreferrer noopener">http://cecs.wright.edu/~pmateti/Courses/233/Top/233-CheatSheet.html</a></li></ul><hr><h2 id=session-1---introduction-to-powershell>Session 1 - Introduction to PowerShell
<a class=header-link href=#session-1---introduction-to-powershell><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p><a href=https://tutorials.cyberaces.org/tutorials/view/3-3-1 target=_blank rel="noreferrer noopener">https://tutorials.cyberaces.org/tutorials/view/3-3-1</a></p><h3 id=naming-convention>Naming Convention
<a class=header-link href=#naming-convention><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p><code>Verb-Noun</code>. Things like <code>Get-Service</code>.</p><h3 id=parameters>Parameters
<a class=header-link href=#parameters><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>Can be positional or named. Personally I prefer named because it's more readable.</p><ul><li>You can shorten parameter names to the extent that they are still unique.</li></ul><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b58900>Get-ChildItem</span> -Filter *.exe
</span></span><span style=display:flex><span><span style=color:#b58900>Get-ChildItem</span> -Filt *.exe
</span></span><span style=display:flex><span><span style=color:#b58900>Get-ChildItem</span> -Fi *.exe
</span></span></code></pre></div><ul><li><code>-F</code> will not work because <code>Get-ChildItem</code> has a <code>-Force</code> option.</li></ul><h3 id=get-member>Get-Member
<a class=header-link href=#get-member><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>In PowerShell everything is an object. We can use <code>Get-Member</code> to get properties
and methods of object(s).</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#b58900>Get-ChildItem</span> | <span style=color:#b58900>Get-Member</span>
</span></span><span style=display:flex><span>   TypeName: System.IO.DirectoryInfo
</span></span><span style=display:flex><span>Name                      MemberType     Definition
</span></span><span style=display:flex><span>----                      ----------     ----------
</span></span><span style=display:flex><span>LinkType                  CodeProperty   System.String LinkType{get=GetLinkType;}
</span></span><span style=display:flex><span>Mode                      CodeProperty   System.String Mode{get=Mode;}
</span></span><span style=display:flex><span>Target                    CodeProperty   System.Collections.Generic.IEnumerable`<span style=color:#2aa198>1</span>[[System.String, mscorlib, Version=...
</span></span><span style=display:flex><span>Create                    Method         void Create(), void Create(System.Security.AccessControl.DirectorySecurity ...
</span></span></code></pre></div><p>Also works for aliases like <code>ls | Get-Member</code>.</p><h3 id=piping>Piping
<a class=header-link href=#piping><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>We can pipe outputs of one command to the other. In PowerShell everything is an
object and not text like bash (take that plebs lol).</p><p>For example we can see the output of the previous command is truncated. In order
to format it properly we can use <code>Format</code> cmdlets.</p><p>A good <a href=https://msdn.microsoft.com/en-us/powershell/scripting/getting-started/cookbooks/using-format-commands-to-change-output-view target=_blank rel="noreferrer noopener">tutorial</a>. Usually I just use <code>Format-List</code> to prevent
truncation. It shows data in a list.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>PS&gt; <span style=color:#b58900>Get-ChildItem</span> | <span style=color:#b58900>Get-Member</span> | <span style=color:#b58900>Format-List</span>
</span></span><span style=display:flex><span>TypeName   : System.IO.DirectoryInfo
</span></span><span style=display:flex><span>Name       : LinkType
</span></span><span style=display:flex><span>MemberType : CodeProperty
</span></span><span style=display:flex><span>Definition : System.String LinkType{get=GetLinkType;}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TypeName   : System.IO.DirectoryInfo
</span></span><span style=display:flex><span>Name       : Mode
</span></span><span style=display:flex><span>MemberType : CodeProperty
</span></span><span style=display:flex><span>Definition : System.String Mode{get=Mode;}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TypeName   : System.IO.DirectoryInfo
</span></span><span style=display:flex><span>Name       : Target
</span></span><span style=display:flex><span>MemberType : CodeProperty
</span></span><span style=display:flex><span>Definition : System.Collections.Generic.IEnumerable`<span style=color:#2aa198>1</span>[[System.String, mscorlib, Version=<span style=color:#2aa198>4.0</span>.0.<span style=color:#2aa198>0</span>, Culture=neutral,
</span></span><span style=display:flex><span>             PublicKeyToken=b77a5c561934e089]] Target{get=GetTarget;}
</span></span></code></pre></div><hr><h2 id=session-2---cmdlets>Session 2 - Cmdlets
<a class=header-link href=#session-2---cmdlets><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p><a href=https://tutorials.cyberaces.org/tutorials/view/3-3-2 target=_blank rel="noreferrer noopener">https://tutorials.cyberaces.org/tutorials/view/3-3-2</a></p><h3 id=get-childitem>Get-ChildItem
<a class=header-link href=#get-childitem><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>This is a good cmdlet. Aliases are <code>dir</code>, <code>ls</code> and <code>gci</code>.</p><ul><li>Run <code>man Get-ChildItem -Examples</code> for examples.</li></ul><h4 id=read-registry>Read Registry
<a class=header-link href=#read-registry><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h4><ul><li>Read a registry hive <code>ls HKCU:</code></li><li>To get a specific registry key <code>Get-ChildItem -Path "HKLM:\Software"</code>.</li></ul><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>PS&gt; <span style=color:#b58900>ls </span>HKCU:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Hive: HKEY_CURRENT_USER
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Name                           Property
</span></span><span style=display:flex><span>----                           --------
</span></span><span style=display:flex><span>AppEvents
</span></span><span style=display:flex><span>AppXBackupContentType
</span></span><span style=display:flex><span>Console                        ColorTable00             : <span style=color:#2aa198>0</span>
</span></span><span style=display:flex><span>                               ColorTable01             : <span style=color:#2aa198>8388608</span>
</span></span><span style=display:flex><span>                               ColorTable02             : <span style=color:#2aa198>32768</span>
</span></span><span style=display:flex><span>                               ColorTable03             : <span style=color:#2aa198>8421376</span>
</span></span><span style=display:flex><span>                               ColorTable04             : <span style=color:#2aa198>128</span>
</span></span><span style=display:flex><span>                               ColorTable05             : <span style=color:#2aa198>8388736</span>
</span></span></code></pre></div><h4 id=read-windows-certificate-store>Read Windows Certificate Store
<a class=header-link href=#read-windows-certificate-store><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h4><ul><li><p>Read the Windows certificate store <code>ls cert:</code></p></li><li><p><a href=https://technet.microsoft.com/en-us/library/hh847761.aspx target=_blank rel="noreferrer noopener">https://technet.microsoft.com/en-us/library/hh847761.aspx</a></p></li><li><p><code>cert:</code> is essentially a new drive similar to <code>HKCU:</code></p></li><li><p><code>ls cert:</code> lists machine's certificate stores:</p></li></ul><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>PS&gt; <span style=color:#b58900>ls </span>cert:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Location   : CurrentUser
</span></span><span style=display:flex><span>StoreNames : {TrustedPublisher, ClientAuthIssuer, Root, UserDS...}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Location   : LocalMachine
</span></span><span style=display:flex><span>StoreNames : {TrustedPublisher, ClientAuthIssuer, Remote Desktop, Root...}
</span></span></code></pre></div><ul><li>Now we can see what's inside the <code>LocalMachine</code> certificate store with <code>ls cert:LocalMachine</code>:</li></ul><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#b58900>ls </span>cert:LocalMachine
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Name : TrustedPublisher
</span></span><span style=display:flex><span>Name : ClientAuthIssuer
</span></span><span style=display:flex><span>Name : Remote Desktop
</span></span><span style=display:flex><span>Name : Root
</span></span><span style=display:flex><span>Name : TrustedDevices
</span></span><span style=display:flex><span>Name : CA
</span></span><span style=display:flex><span>Name : Windows Live ID Token Issuer
</span></span></code></pre></div><ul><li>We can go deeper (note that we can use double quotes with paths with space):</li></ul><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>PS&gt; <span style=color:#b58900>ls </span><span style=color:#2aa198>&#34;cert:LocalMachine\Windows Live ID Token Issuer&#34;</span> | <span style=color:#b58900>Format-List</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Subject      : CN=Token Signing Public Key
</span></span><span style=display:flex><span>Issuer       : CN=Token Signing Public Key
</span></span><span style=display:flex><span>Thumbprint   : 2C85006A1A028BCC349DF23C474724C055FDE8B6
</span></span><span style=display:flex><span>FriendlyName :
</span></span><span style=display:flex><span>NotBefore    : <span style=color:#2aa198>5</span>/<span style=color:#2aa198>9</span>/<span style=color:#2aa198>2016</span> <span style=color:#2aa198>4</span>:<span style=color:#2aa198>40</span>:<span style=color:#2aa198>55</span> PM
</span></span><span style=display:flex><span>NotAfter     : <span style=color:#2aa198>5</span>/<span style=color:#2aa198>8</span>/<span style=color:#2aa198>2021</span> <span style=color:#2aa198>4</span>:<span style=color:#2aa198>40</span>:<span style=color:#2aa198>55</span> PM
</span></span><span style=display:flex><span>Extensions   : {System.Security.Cryptography.Oid, System.Security.Cryptography.Oid, System.Security.Cryptography.Oid,
</span></span><span style=display:flex><span>               System.Security.Cryptography.Oid}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Subject      : CN=Token Signing Public Key
</span></span><span style=display:flex><span>Issuer       : CN=Token Signing Public Key
</span></span><span style=display:flex><span>Thumbprint   : 0217922CA1B6F0BD0F1D7FF6E7BDC29B2FAAA060
</span></span><span style=display:flex><span>FriendlyName :
</span></span><span style=display:flex><span>NotBefore    : <span style=color:#2aa198>7</span>/<span style=color:#2aa198>2</span>/<span style=color:#2aa198>2013</span> <span style=color:#2aa198>5</span>:<span style=color:#2aa198>10</span>:<span style=color:#2aa198>37</span> PM
</span></span><span style=display:flex><span>NotAfter     : <span style=color:#2aa198>7</span>/<span style=color:#2aa198>1</span>/<span style=color:#2aa198>2018</span> <span style=color:#2aa198>5</span>:<span style=color:#2aa198>10</span>:<span style=color:#2aa198>37</span> PM
</span></span><span style=display:flex><span>Extensions   : {System.Security.Cryptography.Oid, System.Security.Cryptography.Oid, System.Security.Cryptography.Oid,
</span></span><span style=display:flex><span>               System.Security.Cryptography.Oid}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PS&gt; <span style=color:#b58900>ls </span><span style=color:#2aa198>&#34;cert:LocalMachine\CA&#34;</span> | <span style=color:#b58900>Format-List</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Subject      : CN=Root Agency
</span></span><span style=display:flex><span>Issuer       : CN=Root Agency
</span></span><span style=display:flex><span>Thumbprint   : FEE449EE0E3965A5246F000E87FDE2A065FD89D4
</span></span><span style=display:flex><span>FriendlyName :
</span></span><span style=display:flex><span>NotBefore    : <span style=color:#2aa198>5</span>/<span style=color:#2aa198>28</span>/<span style=color:#2aa198>1996</span> <span style=color:#2aa198>6</span>:<span style=color:#2aa198>02</span>:<span style=color:#2aa198>59</span> PM
</span></span><span style=display:flex><span>NotAfter     : <span style=color:#2aa198>12</span>/<span style=color:#2aa198>31</span>/<span style=color:#2aa198>2039</span> <span style=color:#2aa198>6</span>:<span style=color:#2aa198>59</span>:<span style=color:#2aa198>59</span> PM
</span></span><span style=display:flex><span>Extensions   : {System.Security.Cryptography.Oid, System.Security.Cryptography.Oid}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Subject      : OU=www.verisign.com/CPS Incorp.by <span style=color:#719e07>Ref</span>. LIABILITY LTD.(c)<span style=color:#2aa198>97</span> VeriSign, OU=VeriSign International Server
</span></span><span style=display:flex><span>               CA - <span style=color:#268bd2>Class</span> <span style=color:#b58900>3, </span>OU=<span style=color:#2aa198>&#34;VeriSign, Inc.&#34;</span>, O=VeriSign Trust Network
</span></span><span style=display:flex><span>Issuer       : OU=Class <span style=color:#2aa198>3</span> Public Primary Certification Authority, O=<span style=color:#2aa198>&#34;VeriSign, Inc.&#34;</span>, C=US
</span></span><span style=display:flex><span>Thumbprint   : D559A586669B08F46A30A133F8A9ED3D038E2EA8
</span></span><span style=display:flex><span>FriendlyName :
</span></span><span style=display:flex><span>NotBefore    : <span style=color:#2aa198>4</span>/<span style=color:#2aa198>16</span>/<span style=color:#2aa198>1997</span> <span style=color:#2aa198>8</span>:<span style=color:#2aa198>00</span>:<span style=color:#2aa198>00</span> PM
</span></span><span style=display:flex><span>NotAfter     : <span style=color:#2aa198>10</span>/<span style=color:#2aa198>24</span>/<span style=color:#2aa198>2016</span> <span style=color:#2aa198>7</span>:<span style=color:#2aa198>59</span>:<span style=color:#2aa198>59</span> PM
</span></span><span style=display:flex><span>Extensions   : {System.Security.Cryptography.Oid, System.Security.Cryptography.Oid, System.Security.Cryptography.Oid,
</span></span><span style=display:flex><span>               System.Security.Cryptography.Oid...}
</span></span></code></pre></div><ul><li>Even deeper and see certificate info based on thumbprint:</li></ul><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#b58900>ls </span><span style=color:#2aa198>&#34;cert:LocalMachine\CA\D559A586669B08F46A30A133F8A9ED3D038E2EA8&#34;</span> | <span style=color:#b58900>Format-List</span> -Property *
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PSPath                   : Microsoft.PowerShell.Security\Certificate::LocalMachine\CA\D559A586669B08F46A30A133F8A9ED3D0
</span></span><span style=display:flex><span>                           38E2EA8
</span></span><span style=display:flex><span>PSParentPath             : Microsoft.PowerShell.Security\Certificate::LocalMachine\CA
</span></span><span style=display:flex><span>PSChildName              : D559A586669B08F46A30A133F8A9ED3D038E2EA8
</span></span><span style=display:flex><span>PSDrive                  : Cert
</span></span><span style=display:flex><span>PSProvider               : Microsoft.PowerShell.Security\Certificate
</span></span><span style=display:flex><span>PSIsContainer            : False
</span></span><span style=display:flex><span>EnhancedKeyUsageList     : {Server Authentication (<span style=color:#2aa198>1.3</span>.6.1.5.5.7.3.<span style=color:#2aa198>1</span>), Client Authentication (<span style=color:#2aa198>1.3</span>.6.1.5.5.7.3.<span style=color:#2aa198>2</span>),
</span></span><span style=display:flex><span>                           <span style=color:#2aa198>2.16</span>.840.1.113730.4.<span style=color:#2aa198>1</span>, <span style=color:#2aa198>2.16</span>.840.1.113733.1.8.<span style=color:#2aa198>1</span>}
</span></span><span style=display:flex><span>DnsNameList              :
</span></span><span style=display:flex><span>SendAsTrustedIssuer      : False
</span></span><span style=display:flex><span>EnrollmentPolicyEndPoint : Microsoft.CertificateServices.Commands.EnrollmentEndPointProperty
</span></span><span style=display:flex><span>EnrollmentServerEndPoint : Microsoft.CertificateServices.Commands.EnrollmentEndPointProperty
</span></span><span style=display:flex><span>PolicyId                 :
</span></span><span style=display:flex><span>Archived                 : False
</span></span><span style=display:flex><span>Extensions               : {System.Security.Cryptography.Oid, System.Security.Cryptography.Oid,
</span></span><span style=display:flex><span>                           System.Security.Cryptography.Oid, System.Security.Cryptography.Oid...}
</span></span><span style=display:flex><span>FriendlyName             :
</span></span><span style=display:flex><span>IssuerName               : System.Security.Cryptography.X509Certificates.X500DistinguishedName
</span></span><span style=display:flex><span>NotAfter                 : <span style=color:#2aa198>10</span>/<span style=color:#2aa198>24</span>/<span style=color:#2aa198>2016</span> <span style=color:#2aa198>7</span>:<span style=color:#2aa198>59</span>:<span style=color:#2aa198>59</span> PM
</span></span><span style=display:flex><span>NotBefore                : <span style=color:#2aa198>4</span>/<span style=color:#2aa198>16</span>/<span style=color:#2aa198>1997</span> <span style=color:#2aa198>8</span>:<span style=color:#2aa198>00</span>:<span style=color:#2aa198>00</span> PM
</span></span><span style=display:flex><span>HasPrivateKey            : False
</span></span><span style=display:flex><span>PrivateKey               :
</span></span><span style=display:flex><span>PublicKey                : System.Security.Cryptography.X509Certificates.PublicKey
</span></span><span style=display:flex><span>RawData                  : {<span style=color:#2aa198>48</span>, <span style=color:#2aa198>130</span>, <span style=color:#2aa198>3</span>, <span style=color:#2aa198>131</span>...}
</span></span><span style=display:flex><span>SerialNumber             : 46FCEBBAB4D02F0F926098233F93078F
</span></span><span style=display:flex><span>SubjectName              : System.Security.Cryptography.X509Certificates.X500DistinguishedName
</span></span><span style=display:flex><span>SignatureAlgorithm       : System.Security.Cryptography.Oid
</span></span><span style=display:flex><span>Thumbprint               : D559A586669B08F46A30A133F8A9ED3D038E2EA8
</span></span><span style=display:flex><span>Version                  : <span style=color:#2aa198>3</span>
</span></span><span style=display:flex><span>Handle                   : <span style=color:#2aa198>2694988070352</span>
</span></span><span style=display:flex><span>Issuer                   : OU=Class <span style=color:#2aa198>3</span> Public Primary Certification Authority, O=<span style=color:#2aa198>&#34;VeriSign, Inc.&#34;</span>, C=US
</span></span><span style=display:flex><span>Subject                  : OU=www.verisign.com/CPS Incorp.by <span style=color:#719e07>Ref</span>. LIABILITY LTD.(c)<span style=color:#2aa198>97</span> VeriSign, OU=VeriSign
</span></span><span style=display:flex><span>                           International Server CA - <span style=color:#268bd2>Class</span> <span style=color:#b58900>3, </span>OU=<span style=color:#2aa198>&#34;VeriSign, Inc.&#34;</span>, O=VeriSign Trust Network
</span></span></code></pre></div><h3 id=cd-or-change-directory>cd or Change Directory
<a class=header-link href=#cd-or-change-directory><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>It's easier to treat registry and the certificate store as drives and cd into
them.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#b58900>cd </span>cert:
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>Cert:\&gt; <span style=color:#b58900>dir
</span></span></span><span style=display:flex><span><span style=color:#b58900></span>
</span></span><span style=display:flex><span>Location   : CurrentUser
</span></span><span style=display:flex><span>StoreNames : {TrustedPublisher, ClientAuthIssuer, Root, UserDS...}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Location   : LocalMachine
</span></span><span style=display:flex><span>StoreNames : {TrustedPublisher, ClientAuthIssuer, Remote Desktop, Root...}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>Cert:\&gt; <span style=color:#b58900>cd </span>.\\CurrentUser\
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>Cert:\CurrentUser\&gt; <span style=color:#b58900>dir
</span></span></span><span style=display:flex><span><span style=color:#b58900></span>
</span></span><span style=display:flex><span>Name : TrustedPublisher
</span></span><span style=display:flex><span>Name : ClientAuthIssuer
</span></span><span style=display:flex><span>Name : Root
</span></span><span style=display:flex><span>Name : UserDS
</span></span><span style=display:flex><span>Name : CA
</span></span><span style=display:flex><span>Name : ACRS
</span></span></code></pre></div><hr><h2 id=session-3-scripting-variables-and-syntax>Session 3: Scripting, Variables and Syntax
<a class=header-link href=#session-3-scripting-variables-and-syntax><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p><a href=https://tutorials.cyberaces.org/tutorials/view/3-3-3 target=_blank rel="noreferrer noopener">https://tutorials.cyberaces.org/tutorials/view/3-3-3</a></p><p>Scripts are in <code>ps1</code> files. They do not run with double-click.</p><h3 id=executionpolicy>ExecutionPolicy
<a class=header-link href=#executionpolicy><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>In order to run them we need to change the execution policy. Default setting
doesn't run scripts.</p><ul><li>You can view computer's execution policies with <code>Get-ExecutionPolicy -List</code>:</li></ul><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#b58900>Get-ExecutionPolicy</span> -List
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        Scope ExecutionPolicy
</span></span><span style=display:flex><span>        ----- ---------------
</span></span><span style=display:flex><span>MachinePolicy       Undefined
</span></span><span style=display:flex><span>   UserPolicy       Undefined
</span></span><span style=display:flex><span>      <span style=color:#719e07>Process</span>       Undefined
</span></span><span style=display:flex><span>  CurrentUser       Undefined
</span></span><span style=display:flex><span> LocalMachine    RemoteSigned
</span></span></code></pre></div><ul><li><code>Set-ExecutionPolicy</code> sets a policy (needs admin powershell window). There are
four options (<a href=https://technet.microsoft.com/en-us/library/ee176961.aspx target=_blank rel="noreferrer noopener">technet source</a>):<ul><li>Restricted - No scripts can be run. Windows PowerShell can be used only in
interactive mode.</li><li>AllSigned - Only scripts signed by a trusted publisher can be run.</li><li>RemoteSigned - Downloaded scripts must be signed by a trusted publisher
before they can be run.</li><li>Unrestricted - No restrictions; all Windows PowerShell scripts can be run.</li></ul></li></ul><h3 id=variables>Variables
<a class=header-link href=#variables><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><ul><li>Prefixed with <code>$</code>.</li><li>Set variable: <code>$a = 13</code>.</li><li>Get variable: <code>$a</code>.</li><li>Store the result of a command into a variable: <code>$output = dir cert:</code>.</li></ul><h4 id=variable-types>Variable Types
<a class=header-link href=#variable-types><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h4><p>Create a typed variable: <code>[int]$thisIsAnInt = 11</code>.</p><p>These are the different types (<a href=https://technet.microsoft.com/en-us/magazine/ff642464.aspx target=_blank rel="noreferrer noopener">source technet</a>):</p><ul><li>[int] 32-bit signed integer</li><li>[long] 64-bit signed integer</li><li>[string] Fixed-length string of Unicode characters</li><li>[char] Unicode 16-bit character</li><li>[bool] True/false value</li><li>[byte] 8-bit unsigned integer</li><li>[double] Double-precision 64-bit floating point number</li><li>[decimal] 128-bit decimal value</li><li>[single] Single-precision 32-bit floating point number</li><li>[array] Array of values</li><li>[xml] Xmldocument object</li><li>[hashtable] Hashtable object (similar to a Dictionary object)</li></ul><h3 id=arrays>Arrays
<a class=header-link href=#arrays><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>Collection of objects. Use them like normal arrays in programming languages.</p><ul><li>Help on Technet: <a href=https://technet.microsoft.com/en-us/library/hh847882.aspx target=_blank rel="noreferrer noopener">https://technet.microsoft.com/en-us/library/hh847882.aspx</a></li></ul><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#586e75># Create an array</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#268bd2>$someNumbers</span> = <span style=color:#2aa198>0</span>, <span style=color:#2aa198>1</span>, <span style=color:#2aa198>2</span>, <span style=color:#2aa198>3</span>, <span style=color:#2aa198>4</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># Access all of it - echo $someNumbers does the same thing</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#268bd2>$someNumbers</span>
</span></span><span style=display:flex><span><span style=color:#2aa198>0</span>
</span></span><span style=display:flex><span><span style=color:#2aa198>1</span>
</span></span><span style=display:flex><span><span style=color:#2aa198>2</span>
</span></span><span style=display:flex><span><span style=color:#2aa198>3</span>
</span></span><span style=display:flex><span><span style=color:#2aa198>4</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># Access a specific index - indexing starts from 0 like almost every programming language</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#268bd2>$someNumbers</span>[<span style=color:#2aa198>3</span>]
</span></span><span style=display:flex><span><span style=color:#2aa198>3</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># Negative indexing also works</span>
</span></span><span style=display:flex><span><span style=color:#586e75># -1 is the last item</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#268bd2>$someNumbers</span>[<span style=color:#2aa198>-1</span>]
</span></span><span style=display:flex><span><span style=color:#2aa198>4</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># -2 works as intended</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#268bd2>$someNumbers</span>[<span style=color:#2aa198>-2</span>]
</span></span><span style=display:flex><span><span style=color:#2aa198>3</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># Get length of array - either use Length or Count properties</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#268bd2>$someNumbers</span>.Count
</span></span><span style=display:flex><span><span style=color:#2aa198>5</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#268bd2>$someNumbers</span>.Length
</span></span><span style=display:flex><span><span style=color:#2aa198>5</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># But remember that they are ReadOnly</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#268bd2>$someNumbers</span>.Count = <span style=color:#2aa198>10</span>
</span></span><span style=display:flex><span><span style=color:#2aa198>&#39;Count&#39;</span> is a ReadOnly property.
</span></span><span style=display:flex><span>At line:<span style=color:#2aa198>1</span> char:<span style=color:#2aa198>1</span>
</span></span><span style=display:flex><span>+ <span style=color:#268bd2>$someNumbers</span>.Count = <span style=color:#2aa198>10</span>
</span></span><span style=display:flex><span>+ ~~~~~~~~~~~~~~~~~~~~~~~
</span></span><span style=display:flex><span>    + CategoryInfo          : InvalidOperation: (:) [], RuntimeException
</span></span><span style=display:flex><span>    + FullyQualifiedErrorId : PropertyAssignmentException
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># Get the type - this is because our array was not typed when we created it</span>
</span></span><span style=display:flex><span><span style=color:#586e75># As a result the members can be of different types</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#268bd2>$someNumbers</span>.GetType()
</span></span><span style=display:flex><span>IsPublic IsSerial Name                                     BaseType
</span></span><span style=display:flex><span>-------- -------- ----                                     --------
</span></span><span style=display:flex><span>True     True     Object[]                                 System.Array
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># Create a typed array - note inside the brackets</span>
</span></span><span style=display:flex><span><span style=color:#586e75># Type of a typed array is something like int[] or int32[]</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; [<span style=color:#cb4b16>int[]</span>]<span style=color:#268bd2>$intArray</span> = <span style=color:#2aa198>0</span>, <span style=color:#2aa198>1</span>, <span style=color:#2aa198>2</span>, <span style=color:#2aa198>3</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># Now we can see the correct type</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#268bd2>$intArray</span>.GetType()
</span></span><span style=display:flex><span>IsPublic IsSerial Name                                     BaseType
</span></span><span style=display:flex><span>-------- -------- ----                                     --------
</span></span><span style=display:flex><span>True     True     Int32[]                                  System.Array
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># Type can be any .NET framework object</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; [<span style=color:#cb4b16>Diagnostics.Process[]</span>]<span style=color:#268bd2>$processes</span> = <span style=color:#b58900>Get-Process</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#268bd2>$processes</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Handles  NPM(K)    PM(K)      WS(K) VM(M)   CPU(s)     Id  <span style=color:#b58900>SI </span>ProcessName
</span></span><span style=display:flex><span>-------  ------    -----      ----- -----   ------     --  -- -----------
</span></span><span style=display:flex><span>    <span style=color:#2aa198>247</span>      <span style=color:#2aa198>21</span>    <span style=color:#2aa198>28388</span>      <span style=color:#2aa198>54672</span>   <span style=color:#2aa198>220</span>    <span style=color:#2aa198>60.14</span>   <span style=color:#2aa198>2472</span>   <span style=color:#2aa198>2</span> atom
</span></span><span style=display:flex><span>    <span style=color:#2aa198>244</span>      <span style=color:#2aa198>23</span>    <span style=color:#2aa198>22656</span>      <span style=color:#2aa198>34136</span>   <span style=color:#2aa198>288</span>    <span style=color:#2aa198>40.33</span>   <span style=color:#2aa198>4908</span>   <span style=color:#2aa198>2</span> atom
</span></span><span style=display:flex><span>    <span style=color:#2aa198>171</span>      <span style=color:#2aa198>15</span>     <span style=color:#2aa198>4364</span>      <span style=color:#2aa198>10528</span>   <span style=color:#2aa198>156</span>     <span style=color:#2aa198>0.34</span>   <span style=color:#2aa198>6800</span>   <span style=color:#2aa198>2</span> atom
</span></span><span style=display:flex><span>    <span style=color:#2aa198>547</span>      <span style=color:#2aa198>37</span>    <span style=color:#2aa198>52600</span>      <span style=color:#2aa198>80496</span>   <span style=color:#2aa198>332</span>    <span style=color:#2aa198>55.59</span>   <span style=color:#2aa198>8104</span>   <span style=color:#2aa198>2</span> atom
</span></span><span style=display:flex><span>    <span style=color:#2aa198>347</span>      <span style=color:#2aa198>67</span>   <span style=color:#2aa198>626812</span>     <span style=color:#2aa198>647076</span>  <span style=color:#2aa198>1006</span>   <span style=color:#2aa198>361.66</span>   <span style=color:#2aa198>8848</span>   <span style=color:#2aa198>2</span> atom
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># You can use ranges</span>
</span></span><span style=display:flex><span><span style=color:#586e75># Here powershell doesn&#39;t care if your range is over the bounds, it just shows all of the array</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#268bd2>$someNumbers</span>[<span style=color:#2aa198>0</span>.<span style=color:#2aa198>.10</span>]
</span></span><span style=display:flex><span><span style=color:#2aa198>0</span>
</span></span><span style=display:flex><span><span style=color:#2aa198>1</span>
</span></span><span style=display:flex><span><span style=color:#2aa198>2</span>
</span></span><span style=display:flex><span><span style=color:#2aa198>3</span>
</span></span><span style=display:flex><span><span style=color:#2aa198>4</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># You can use negative index in range - you can see it is reading backwards</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#268bd2>$someNumbers</span>[<span style=color:#2aa198>0</span>..<span style=color:#2aa198>-3</span>]
</span></span><span style=display:flex><span><span style=color:#2aa198>0</span>
</span></span><span style=display:flex><span><span style=color:#2aa198>4</span>
</span></span><span style=display:flex><span><span style=color:#2aa198>3</span>
</span></span><span style=display:flex><span><span style=color:#2aa198>2</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># Or use the range like this to view specific members</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#268bd2>$someNumbers</span>[<span style=color:#2aa198>0</span>,<span style=color:#2aa198>2</span>,<span style=color:#2aa198>4</span>]
</span></span><span style=display:flex><span><span style=color:#2aa198>0</span>
</span></span><span style=display:flex><span><span style=color:#2aa198>2</span>
</span></span><span style=display:flex><span><span style=color:#2aa198>4</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># Combine a range and specific indices with +</span>
</span></span><span style=display:flex><span><span style=color:#586e75># Seems like when you use the + it cannot be used for the first item (otherwise the parser thinks it&#39;s a mathematical operation to calculate an index)</span>
</span></span><span style=display:flex><span><span style=color:#586e75># You can do this</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#268bd2>$someNumbers</span>[<span style=color:#2aa198>2</span>,<span style=color:#2aa198>0</span>+<span style=color:#2aa198>1</span>.<span style=color:#2aa198>.3</span>]
</span></span><span style=display:flex><span><span style=color:#2aa198>2</span>
</span></span><span style=display:flex><span><span style=color:#2aa198>0</span>
</span></span><span style=display:flex><span><span style=color:#2aa198>1</span>
</span></span><span style=display:flex><span><span style=color:#2aa198>2</span>
</span></span><span style=display:flex><span><span style=color:#2aa198>3</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># But cannot do this</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#268bd2>$someNumbers</span>[<span style=color:#2aa198>2</span>+<span style=color:#2aa198>1</span>.<span style=color:#2aa198>.3</span>]
</span></span><span style=display:flex><span>Method invocation failed because [<span style=color:#cb4b16>System.Object[]</span>] does not contain a method named <span style=color:#2aa198>&#39;op_Addition&#39;</span>.
</span></span><span style=display:flex><span>At line:<span style=color:#2aa198>1</span> char:<span style=color:#2aa198>1</span>
</span></span><span style=display:flex><span>+ <span style=color:#268bd2>$someNumbers</span>[<span style=color:#2aa198>2</span>+<span style=color:#2aa198>1</span>.<span style=color:#2aa198>.3</span>]
</span></span><span style=display:flex><span>+ ~~~~~~~~~~~~~~~~~~~~
</span></span><span style=display:flex><span>    + CategoryInfo          : InvalidOperation: (op_Addition:String) [], RuntimeException
</span></span><span style=display:flex><span>    + FullyQualifiedErrorId : MethodNotFound
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># To add items to arrays use += (obviously respect the type of the array)</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#268bd2>$someNumbers</span>
</span></span><span style=display:flex><span><span style=color:#2aa198>0</span>
</span></span><span style=display:flex><span><span style=color:#2aa198>1</span>
</span></span><span style=display:flex><span><span style=color:#2aa198>2</span>
</span></span><span style=display:flex><span><span style=color:#2aa198>3</span>
</span></span><span style=display:flex><span><span style=color:#2aa198>4</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#268bd2>$someNumbers</span> += <span style=color:#2aa198>5</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#268bd2>$someNumbers</span>
</span></span><span style=display:flex><span><span style=color:#2aa198>0</span>
</span></span><span style=display:flex><span><span style=color:#2aa198>1</span>
</span></span><span style=display:flex><span><span style=color:#2aa198>2</span>
</span></span><span style=display:flex><span><span style=color:#2aa198>3</span>
</span></span><span style=display:flex><span><span style=color:#2aa198>4</span>
</span></span><span style=display:flex><span><span style=color:#2aa198>5</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># Combine arrays with +</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#268bd2>$moreNumbers</span> = <span style=color:#2aa198>10</span>,<span style=color:#2aa198>11</span>,<span style=color:#2aa198>12</span>,<span style=color:#2aa198>13</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#268bd2>$combined</span> = <span style=color:#268bd2>$someNumbers</span> + <span style=color:#268bd2>$moreNumbers</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#268bd2>$combined</span>
</span></span><span style=display:flex><span><span style=color:#2aa198>0</span>
</span></span><span style=display:flex><span><span style=color:#2aa198>1</span>
</span></span><span style=display:flex><span><span style=color:#2aa198>2</span>
</span></span><span style=display:flex><span><span style=color:#2aa198>3</span>
</span></span><span style=display:flex><span><span style=color:#2aa198>4</span>
</span></span><span style=display:flex><span><span style=color:#2aa198>5</span>
</span></span><span style=display:flex><span><span style=color:#2aa198>10</span>
</span></span><span style=display:flex><span><span style=color:#2aa198>11</span>
</span></span><span style=display:flex><span><span style=color:#2aa198>12</span>
</span></span><span style=display:flex><span><span style=color:#2aa198>13</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># To delete an array set it to $null</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#268bd2>$combined</span> = $null
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#268bd2>$combined</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#268bd2>$combined</span>.Count
</span></span><span style=display:flex><span><span style=color:#2aa198>0</span>
</span></span></code></pre></div><h3 id=get-member-1>Get-Member
<a class=header-link href=#get-member-1><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>To get methods and properties of an object, pipe it to <code>Get-Member</code>.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#586e75># Like an int</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#2aa198>1</span> | <span style=color:#b58900>Get-Member</span>
</span></span><span style=display:flex><span>   TypeName: System.Int32
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Name        MemberType Definition
</span></span><span style=display:flex><span>----        ---------- ----------
</span></span><span style=display:flex><span>CompareTo   Method     int CompareTo(System.Object value), int CompareTo(int value), int IComparab...
</span></span><span style=display:flex><span>Equals      Method     bool Equals(System.Object obj), bool Equals(int obj), bool IEquatable[<span style=color:#cb4b16>int</span>]....
</span></span><span style=display:flex><span>GetHashCode Method     int GetHashCode()
</span></span><span style=display:flex><span>GetType     Method     <span style=color:#b58900>type </span>GetType()
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># Same thing can be done with an array</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; [<span style=color:#cb4b16>int[]</span>]<span style=color:#268bd2>$intArray</span> = <span style=color:#2aa198>10</span>, <span style=color:#2aa198>9</span>, <span style=color:#2aa198>8</span>, <span style=color:#2aa198>7</span>, <span style=color:#2aa198>6</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#268bd2>$intArray</span>.GetType()
</span></span><span style=display:flex><span>IsPublic IsSerial Name                                     BaseType
</span></span><span style=display:flex><span>-------- -------- ----                                     --------
</span></span><span style=display:flex><span>True     True     Int32[]                                  System.Array
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#268bd2>$intArray</span> | <span style=color:#b58900>Get-Member</span>
</span></span><span style=display:flex><span>   TypeName: System.Int32
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Name        MemberType Definition
</span></span><span style=display:flex><span>----        ---------- ----------
</span></span><span style=display:flex><span>CompareTo   Method     int CompareTo(System.Object value), int CompareTo(int value), int IComparab...
</span></span><span style=display:flex><span>Equals      Method     bool Equals(System.Object obj), bool Equals(int obj), bool IEquatable[<span style=color:#cb4b16>int</span>]....
</span></span><span style=display:flex><span>GetHashCode Method     int GetHashCode()
</span></span><span style=display:flex><span>GetType     Method     <span style=color:#b58900>type </span>GetType()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># If we want to see the type of members in an array</span>
</span></span><span style=display:flex><span><span style=color:#586e75># $arrayName | Get-Member</span>
</span></span><span style=display:flex><span><span style=color:#586e75># will send members of the array one by one</span>
</span></span></code></pre></div><h4 id=get-childitem-variable>Get-ChildItem variable:
<a class=header-link href=#get-childitem-variable><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h4><p>Returns all available variables.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#b58900>Get-ChildItem</span> variable:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Name                           Value
</span></span><span style=display:flex><span>----                           -----
</span></span><span style=display:flex><span>$                              <span style=color:#b58900>clear
</span></span></span><span style=display:flex><span><span style=color:#b58900></span>?                              True
</span></span><span style=display:flex><span>^                              <span style=color:#b58900>clear
</span></span></span><span style=display:flex><span><span style=color:#b58900></span>args                           {}
</span></span><span style=display:flex><span>mixedArray                     {<span style=color:#2aa198>1</span>, hello, <span style=color:#2aa198>2.3</span>}
</span></span><span style=display:flex><span>moreNumbers                    {<span style=color:#2aa198>10</span>, <span style=color:#2aa198>11</span>, <span style=color:#2aa198>12</span>, <span style=color:#2aa198>13</span>}
</span></span><span style=display:flex><span>someNumbers                    {<span style=color:#2aa198>0</span>, <span style=color:#2aa198>1</span>, <span style=color:#2aa198>2</span>, <span style=color:#2aa198>3</span>...}
</span></span></code></pre></div><h3 id=user-properties-of-cmdlet-output>User Properties of Cmdlet Output
<a class=header-link href=#user-properties-of-cmdlet-output><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>Cmdlets do not have properties by themselves, their output is an object which
has properties.</p><p>E.g., the output of <code>Get-Process</code> is an array with members of type
<code>System.Diagnostics.Process</code>. We can get the first member and see its methods:</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; (<span style=color:#b58900>Get-Process</span>)[<span style=color:#2aa198>0</span>] | <span style=color:#b58900>Get-Member</span>
</span></span><span style=display:flex><span>   TypeName: System.Diagnostics.<span style=color:#719e07>Process</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Name                       MemberType     Definition
</span></span><span style=display:flex><span>----                       ----------     ----------
</span></span><span style=display:flex><span>Handles                    AliasProperty  Handles = Handlecount
</span></span><span style=display:flex><span>Name                       AliasProperty  Name = ProcessName
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># Executing one of the methods is also simple</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; (<span style=color:#b58900>Get-Process</span>)[<span style=color:#2aa198>30</span>].ToString()
</span></span><span style=display:flex><span>System.Diagnostics.<span style=color:#719e07>Process</span> (chrome)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># Or read a Property</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; (<span style=color:#b58900>Get-Process</span>)[<span style=color:#2aa198>30</span>].ProcessName
</span></span><span style=display:flex><span>chrome
</span></span></code></pre></div><h3 id=double-quotes-vs-single-quotes>Double Quotes vs. Single Quotes
<a class=header-link href=#double-quotes-vs-single-quotes><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>Double quote expands the value inside while single quote doesn't.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#b58900>echo </span><span style=color:#2aa198>&#34;This is the array </span><span style=color:#268bd2>$someNumbers</span><span style=color:#2aa198>&#34;</span>
</span></span><span style=display:flex><span>This is the array <span style=color:#2aa198>0</span> <span style=color:#2aa198>1</span> <span style=color:#2aa198>2</span> <span style=color:#2aa198>3</span> <span style=color:#2aa198>4</span> <span style=color:#2aa198>5</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#b58900>echo </span><span style=color:#2aa198>&#39;This is the array $someNumbers&#39;</span>
</span></span><span style=display:flex><span>This is the array <span style=color:#268bd2>$someNumbers</span>
</span></span></code></pre></div><p>You can escape stuff in double quotes to prevent them from being expanded with
backtick (cannot do it here because it will mess with markdown highlighting):</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#b58900>echo </span><span style=color:#2aa198>&#34;This is the array </span><span style=color:#cb4b16>`$</span><span style=color:#2aa198>somenumbers`: </span><span style=color:#268bd2>$someNumbers</span><span style=color:#2aa198>&#34;</span>
</span></span><span style=display:flex><span>This is the array <span style=color:#268bd2>$somenumbers</span>: <span style=color:#2aa198>0</span> <span style=color:#2aa198>1</span> <span style=color:#2aa198>2</span> <span style=color:#2aa198>3</span> <span style=color:#2aa198>4</span> <span style=color:#2aa198>5</span>
</span></span></code></pre></div><p>To expand properties of objects, wrap them in <code>()</code>. Otherwise, it will just print
the variable and then put the text of the method after it:</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#b58900>echo </span><span style=color:#2aa198>&#34;Today is </span>$(<span style=color:#b58900>Get-Date</span>)<span style=color:#2aa198>&#34;</span>
</span></span><span style=display:flex><span>Today is <span style=color:#2aa198>07</span>/<span style=color:#2aa198>29</span>/<span style=color:#2aa198>2016</span> <span style=color:#2aa198>17</span>:<span style=color:#2aa198>49</span>:<span style=color:#2aa198>01</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#b58900>echo </span><span style=color:#2aa198>&#34;Today is </span>$((<span style=color:#b58900>Get-Date</span>).DayOfWeek)<span style=color:#2aa198>&#34;</span>
</span></span><span style=display:flex><span>Today is Friday
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#b58900>echo </span><span style=color:#2aa198>&#34;Today is </span>$(<span style=color:#b58900>Get-Date</span>)<span style=color:#2aa198>.DayOfWeek&#34;</span>
</span></span><span style=display:flex><span>Today is <span style=color:#2aa198>07</span>/<span style=color:#2aa198>29</span>/<span style=color:#2aa198>2016</span> <span style=color:#2aa198>17</span>:<span style=color:#2aa198>49</span>:<span style=color:#2aa198>22</span>.DayOfWeek
</span></span></code></pre></div><hr><h2 id=section-4---flow-control>Section 4 - Flow Control
<a class=header-link href=#section-4---flow-control><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p><a href=https://tutorials.cyberaces.org/tutorials/view/3-3-4 target=_blank rel="noreferrer noopener">https://tutorials.cyberaces.org/tutorials/view/3-3-4</a></p><h3 id=whatif---confirm---verbose>WhatIf - Confirm - Verbose
<a class=header-link href=#whatif---confirm---verbose><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>These are three switches that help with running commands. <code>WhatIf</code> is the most
interesting (and probably useful).</p><ul><li><strong>-WhatIf</strong> does not run the command. Instead it says what it would do if it was executed.</li><li><strong>-Confirm</strong> does what it says. It asks for confirmation before running the command.</li><li><strong>-Verbose</strong> runs the command but gives us extra information.</li></ul><p>For example let's try to create a directory with <code>mkdir</code> (which is not exactly
an alias for <code>New-Item</code> although if you run <code>help mkdir</code> we will see info for
<code>New-Item</code>):</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#586e75># Testing -WhatIf</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\test&gt; mkdir <span style=color:#b58900>new-directory</span> -WhatIf
</span></span><span style=display:flex><span>What <span style=color:#719e07>if</span>: Performing the operation <span style=color:#2aa198>&#34;Create Directory&#34;</span> on target <span style=color:#2aa198>&#34;Destination: C:\test\new-directory&#34;</span>.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># But the command was not actually executed because ls returns nothing</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\test&gt; <span style=color:#b58900>ls
</span></span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\test&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># Testing -Confirm</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\test&gt; mkdir <span style=color:#b58900>new-directory</span> -Confirm
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Confirm
</span></span><span style=display:flex><span>Are you sure you want to perform this action?
</span></span><span style=display:flex><span>Performing the operation <span style=color:#2aa198>&#34;Create Directory&#34;</span> on target <span style=color:#2aa198>&#34;Destination: C:\test\new-directory&#34;</span>.
</span></span><span style=display:flex><span>[<span style=color:#cb4b16>Y] Yes  [A] Yes to All  [N] No  [L] No to All  [S</span>] Suspend  [?] Help (<span style=color:#719e07>default</span> is <span style=color:#2aa198>&#34;Y&#34;</span>): L
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\test&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># Testing -Verbose</span>
</span></span><span style=display:flex><span><span style=color:#586e75># It actually runs the command but gives us extra info.</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\test&gt; mkdir <span style=color:#b58900>new-directory</span> -Verbose
</span></span><span style=display:flex><span>VERBOSE: Performing the operation <span style=color:#2aa198>&#34;Create Directory&#34;</span> on target <span style=color:#2aa198>&#34;Destination: C:\test\new-directory&#34;</span>.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Directory: C:\test
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Mode                LastWriteTime         Length Name
</span></span><span style=display:flex><span>----                -------------         ------ ----
</span></span><span style=display:flex><span>d-----        <span style=color:#2aa198>7</span>/<span style=color:#2aa198>31</span>/<span style=color:#2aa198>2016</span>   <span style=color:#2aa198>7</span>:<span style=color:#2aa198>18</span> PM                <span style=color:#b58900>new-directory</span>
</span></span></code></pre></div><p>Not all commands have these. Usually PowerShell core commands that
<strong>change the state of the machine</strong> have this. E.g., <code>ls</code> does not have neither
<code>-Confirm</code> nor <code>-WhatIf</code> and <code>-Verbose</code> does not change its behavior.</p><p>To see what commands support <code>-WhatIF</code> we can run the following PowerShell
command <a href=http://www.computerperformance.co.uk/powershell/powershell_whatif_confirm.htm target=_blank rel="noreferrer noopener">source at computerperformance.co.uk</a>
(similar for <code>-Confirm</code> and <code>-Verbose</code>):</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b58900>Get-Command</span> -commandType cmdlet | <span style=color:#b58900>where </span>{ <span style=color:#268bd2>$_</span>.parameters.keys <span style=color:#719e07>-Contains</span> <span style=color:#2aa198>&#34;Confirm&#34;</span>} | <span style=color:#b58900>Format-Table</span> Name
</span></span></code></pre></div><p>We can add support for these commands to our own scripts as shown here:<br><a href=https://blogs.msdn.microsoft.com/powershell/2007/02/25/supporting-whatif-confirm-verbose-in-scripts/ target=_blank rel="noreferrer noopener">https://blogs.msdn.microsoft.com/powershell/2007/02/25/supporting-whatif-confirm-verbose-in-scripts/</a></p><h3 id=operators>Operators
<a class=header-link href=#operators><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><ul><li>Operators are at: <a href=https://technet.microsoft.com/en-us/library/hh847732.aspx target=_blank rel="noreferrer noopener">https://technet.microsoft.com/en-us/library/hh847732.aspx</a>.</li></ul><table><thead><tr><th style=text-align:left>Operator</th><th style=text-align:left>Meaning</th></tr></thead><tbody><tr><td style=text-align:left>-eq</td><td style=text-align:left>Equal</td></tr><tr><td style=text-align:left>-ne</td><td style=text-align:left>Not equal</td></tr><tr><td style=text-align:left>-lt</td><td style=text-align:left>Less than</td></tr><tr><td style=text-align:left>-le</td><td style=text-align:left>Less than or equal</td></tr><tr><td style=text-align:left>-gt</td><td style=text-align:left>Greater than</td></tr><tr><td style=text-align:left>-ge</td><td style=text-align:left>Greater than or equal</td></tr><tr><td style=text-align:left>-match</td><td style=text-align:left>regex match</td></tr><tr><td style=text-align:left>-notmatch</td><td style=text-align:left>negative regex match</td></tr><tr><td style=text-align:left>-like</td><td style=text-align:left>wildcard match</td></tr><tr><td style=text-align:left>-notlike</td><td style=text-align:left>negative wildcard match</td></tr><tr><td style=text-align:left>-and</td><td style=text-align:left>&&</td></tr><tr><td style=text-align:left>-or</td><td style=text-align:left>or</td></tr><tr><td style=text-align:left>-xor</td><td style=text-align:left>XOR</td></tr><tr><td style=text-align:left>-not</td><td style=text-align:left>not</td></tr><tr><td style=text-align:left>%</td><td style=text-align:left>mod</td></tr></tbody></table><h3 id=if---then---else>If - Then - Else
<a class=header-link href=#if---then---else><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>Usage is similar to programming languages (there is no <code>then</code> either).</p><p>To create these scripts, it's easier to just use the <code>PowerShell_ise.exe</code>
(PowerShell Integrated Scripting Environment).</p><p>Create a new script and write it on top. Run the script using the button or
press <code>F5</code> and the bottom panel will show the result.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#268bd2>$ten</span> = <span style=color:#2aa198>10</span>
</span></span><span style=display:flex><span><span style=color:#719e07>if</span> (<span style=color:#268bd2>$ten</span> <span style=color:#719e07>-eq</span> <span style=color:#2aa198>0</span>)
</span></span><span style=display:flex><span>    { <span style=color:#2aa198>&#34;Ten does not equal zero.&#34;</span> }
</span></span><span style=display:flex><span><span style=color:#719e07>elseif</span> (<span style=color:#268bd2>$ten</span> <span style=color:#719e07>-lt</span> <span style=color:#2aa198>5</span>)
</span></span><span style=display:flex><span>    { <span style=color:#2aa198>&#34;Ten is not less than 5.&#34;</span> }
</span></span><span style=display:flex><span><span style=color:#719e07>else</span>
</span></span><span style=display:flex><span>    { <span style=color:#2aa198>&#34;Ten is ten.&#34;</span> }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Ten is ten.
</span></span></code></pre></div><h3 id=where-object-filtering>Where-Object Filtering
<a class=header-link href=#where-object-filtering><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>Has two aliases</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#b58900>get-Alias</span> -Definition <span style=color:#b58900>where-object</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>CommandType     Name
</span></span><span style=display:flex><span>-----------     ----
</span></span><span style=display:flex><span><span style=color:#b58900>Alias</span>           ? -&gt; <span style=color:#b58900>Where-Object</span>
</span></span><span style=display:flex><span><span style=color:#b58900>Alias</span>           <span style=color:#b58900>where </span>-&gt; <span style=color:#b58900>Where-Object</span>
</span></span></code></pre></div><p>Pipe the output of a command to <code>Where-Object</code> (or one of the aliases). Then
inside the block you can use <code>$_</code> to refer to it. Imagine it's like a for that
goes through each member of the output and you can filter. To take action (as in
run a new command use <code>ForEach-Object</code>).</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b58900>PS </span>C:\Python27&gt; <span style=color:#b58900>ls </span>| ? {<span style=color:#268bd2>$_</span>.Name <span style=color:#719e07>-like</span> <span style=color:#2aa198>&#34;*py*&#34;</span>}
</span></span><span style=display:flex><span>    Directory: C:\Python27
</span></span><span style=display:flex><span>Mode                LastWriteTime         Length Name
</span></span><span style=display:flex><span>----                -------------         ------ ----
</span></span><span style=display:flex><span>-a----        <span style=color:#2aa198>12</span>/<span style=color:#2aa198>5</span>/<span style=color:#2aa198>2015</span>   <span style=color:#2aa198>8</span>:<span style=color:#2aa198>41</span> PM          <span style=color:#2aa198>28160</span> python.exe
</span></span><span style=display:flex><span>-a----        <span style=color:#2aa198>12</span>/<span style=color:#2aa198>5</span>/<span style=color:#2aa198>2015</span>   <span style=color:#2aa198>8</span>:<span style=color:#2aa198>41</span> PM          <span style=color:#2aa198>28160</span> pythonw.exe
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># We can use different format (perhaps more readable) too (this will work for all three)</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\Python27&gt; <span style=color:#b58900>ls </span>| <span style=color:#b58900>Where </span>Name <span style=color:#719e07>-Like</span> <span style=color:#2aa198>&#34;*py*&#34;</span>
</span></span><span style=display:flex><span>    Directory: C:\Python27
</span></span><span style=display:flex><span>Mode                LastWriteTime         Length Name
</span></span><span style=display:flex><span>----                -------------         ------ ----
</span></span><span style=display:flex><span>-a----        <span style=color:#2aa198>12</span>/<span style=color:#2aa198>5</span>/<span style=color:#2aa198>2015</span>   <span style=color:#2aa198>8</span>:<span style=color:#2aa198>41</span> PM          <span style=color:#2aa198>28160</span> python.exe
</span></span><span style=display:flex><span>-a----        <span style=color:#2aa198>12</span>/<span style=color:#2aa198>5</span>/<span style=color:#2aa198>2015</span>   <span style=color:#2aa198>8</span>:<span style=color:#2aa198>41</span> PM          <span style=color:#2aa198>28160</span> pythonw.exe
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># We can practice a little regex with -Match</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\Python27&gt; <span style=color:#b58900>ls </span>| ? Name <span style=color:#719e07>-Match</span> <span style=color:#2aa198>&#34;.*py&#34;</span>
</span></span><span style=display:flex><span>    Directory: C:\Python27
</span></span><span style=display:flex><span>Mode                LastWriteTime         Length Name
</span></span><span style=display:flex><span>----                -------------         ------ ----
</span></span><span style=display:flex><span>-a----        <span style=color:#2aa198>12</span>/<span style=color:#2aa198>5</span>/<span style=color:#2aa198>2015</span>   <span style=color:#2aa198>8</span>:<span style=color:#2aa198>41</span> PM          <span style=color:#2aa198>28160</span> python.exe
</span></span><span style=display:flex><span>-a----        <span style=color:#2aa198>12</span>/<span style=color:#2aa198>5</span>/<span style=color:#2aa198>2015</span>   <span style=color:#2aa198>8</span>:<span style=color:#2aa198>41</span> PM          <span style=color:#2aa198>28160</span> pythonw.exe
</span></span></code></pre></div><h3 id=foreach-object>ForEach-Object
<a class=header-link href=#foreach-object><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>Similar to <code>Where-Object</code> but you can run a new command with each iterated item.</p><ul><li><a href=https://technet.microsoft.com/en-us/library/ee176828.aspx target=_blank rel="noreferrer noopener">https://technet.microsoft.com/en-us/library/ee176828.aspx</a></li></ul><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt;<span style=color:#b58900>Get-Process</span> | % { <span style=color:#b58900>Write </span>$(<span style=color:#268bd2>$_</span>.ProcessName + <span style=color:#2aa198>&#34;-&#34;</span> + <span style=color:#268bd2>$_</span>.Id) }
</span></span></code></pre></div><p>To concat two strings for printing like above do <code>$( $_.whatever + "something" )</code>.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#586e75># Rename jpeg files to jpeg</span>
</span></span><span style=display:flex><span><span style=color:#b58900>ls </span>*.jpeg |  <span style=color:#b58900>ren </span>-NewName {<span style=color:#268bd2>$_</span>.BaseName +<span style=color:#2aa198>&#34;.jpg&#34;</span>}
</span></span></code></pre></div><h3 id=select-object>Select-Object
<a class=header-link href=#select-object><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>"Filter properties so only certain ones are passed through the pipeline."</p><p>We can recreate the <code>$_.ProcessName</code> command because items passed through end of
last pipe are printed on the screen.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#b58900>Get-Process</span> | <span style=color:#b58900>Select-Object</span> ProcessName, Id
</span></span></code></pre></div><p><strong>But how do we process the tuple in the next pipe line (e.g. Write)? do we do $_[0]? Is the output an array?</strong></p><h3 id=output-and-the-format-verb>Output and the Format Verb
<a class=header-link href=#output-and-the-format-verb><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>We can format output. We have seen them before.</p><ul><li><code>Format-Table</code> or <code>ft</code>.</li><li><code>Format-List</code> or <code>fl</code>.</li></ul><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt;<span style=color:#b58900>Get-Process</span> | <span style=color:#b58900>ft
</span></span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt;<span style=color:#b58900>Get-Process</span> | <span style=color:#b58900>fl
</span></span></span><span style=display:flex><span><span style=color:#b58900></span>
</span></span><span style=display:flex><span><span style=color:#586e75># Without parameters they only display the default fields, use * to display all</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt;<span style=color:#b58900>Get-Process</span> | <span style=color:#b58900>ft </span>*
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt;<span style=color:#b58900>Get-Process</span> | <span style=color:#b58900>fl </span>*
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># The Autosize parameter adjusts the column widths to minimize truncation.</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt;<span style=color:#b58900>Get-Process</span> | <span style=color:#b58900>ft </span>-Auto
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># You can do Groupbys</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#b58900>Get-Process</span> | <span style=color:#b58900>ft </span>-GroupBy ProcessName
</span></span><span style=display:flex><span>   ProcessName: atom
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Handles  NPM(K)    PM(K)      WS(K) VM(M)   CPU(s)     Id  <span style=color:#b58900>SI </span>ProcessName
</span></span><span style=display:flex><span>-------  ------    -----      ----- -----   ------     --  -- -----------
</span></span><span style=display:flex><span>    <span style=color:#2aa198>274</span>      <span style=color:#2aa198>22</span>    <span style=color:#2aa198>26852</span>      <span style=color:#2aa198>39156</span>   <span style=color:#2aa198>226</span>    <span style=color:#2aa198>23.77</span>   <span style=color:#2aa198>1136</span>   <span style=color:#2aa198>5</span> atom
</span></span><span style=display:flex><span>    <span style=color:#2aa198>546</span>      <span style=color:#2aa198>36</span>    <span style=color:#2aa198>51260</span>      <span style=color:#2aa198>77708</span>   <span style=color:#2aa198>332</span>    <span style=color:#2aa198>11.77</span>   <span style=color:#2aa198>6584</span>   <span style=color:#2aa198>5</span> atom
</span></span><span style=display:flex><span>    <span style=color:#2aa198>245</span>      <span style=color:#2aa198>23</span>    <span style=color:#2aa198>20852</span>      <span style=color:#2aa198>32160</span>   <span style=color:#2aa198>289</span>     <span style=color:#2aa198>9.08</span>   <span style=color:#2aa198>7524</span>   <span style=color:#2aa198>5</span> atom
</span></span><span style=display:flex><span>    <span style=color:#2aa198>346</span>      <span style=color:#2aa198>47</span>   <span style=color:#2aa198>294676</span>     <span style=color:#2aa198>308828</span>   <span style=color:#2aa198>665</span>    <span style=color:#2aa198>65.30</span>   <span style=color:#2aa198>7644</span>   <span style=color:#2aa198>5</span> atom
</span></span><span style=display:flex><span>    <span style=color:#2aa198>175</span>      <span style=color:#2aa198>15</span>     <span style=color:#2aa198>4508</span>      <span style=color:#2aa198>10880</span>   <span style=color:#2aa198>156</span>     <span style=color:#2aa198>0.36</span>   <span style=color:#2aa198>8420</span>   <span style=color:#2aa198>5</span> atom
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># Usually it&#39;s a good idea to sort the output based on the GroupBy in the table before piping it to the table</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#b58900>Get-Process</span> | <span style=color:#b58900>Sort-Object</span> ProcessName | <span style=color:#b58900>Format-Table</span> -GroupBy ProcessName
</span></span></code></pre></div><h3 id=file-output>File Output
<a class=header-link href=#file-output><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>Using the redirection <code>></code> it only uses Unicode. Instead we can use <code>Out-File</code> to
get ASCII etc. <code>Out-File</code> also has more options.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#586e75># Write to a file</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\test&gt; <span style=color:#b58900>Get-Process</span> | <span style=color:#b58900>Out-File</span> process1.txt
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\test&gt; <span style=color:#b58900>ls
</span></span></span><span style=display:flex><span><span style=color:#b58900></span>    Directory: C:\test
</span></span><span style=display:flex><span>Mode                LastWriteTime         Length Name
</span></span><span style=display:flex><span>----                -------------         ------ ----
</span></span><span style=display:flex><span>-a----         <span style=color:#2aa198>8</span>/<span style=color:#2aa198>1</span>/<span style=color:#2aa198>2016</span>   <span style=color:#2aa198>4</span>:<span style=color:#2aa198>19</span> PM          <span style=color:#2aa198>30506</span> process1.txt
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># By default Out-File will overwrite any existing files.</span>
</span></span><span style=display:flex><span><span style=color:#586e75># -Append does what it says</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\test&gt; <span style=color:#b58900>Get-Process</span> | <span style=color:#b58900>Out-File</span> process1.txt -Append
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\test&gt; <span style=color:#b58900>ls
</span></span></span><span style=display:flex><span><span style=color:#b58900></span>    Directory: C:\test
</span></span><span style=display:flex><span>Mode                LastWriteTime         Length Name
</span></span><span style=display:flex><span>----                -------------         ------ ----
</span></span><span style=display:flex><span>-a----         <span style=color:#2aa198>8</span>/<span style=color:#2aa198>1</span>/<span style=color:#2aa198>2016</span>   <span style=color:#2aa198>4</span>:<span style=color:#2aa198>22</span> PM          <span style=color:#2aa198>61494</span> process1.txt
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># -NoClobber will prevent over-writing, PowerShell will give you an error if the file already exists</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\test&gt; <span style=color:#b58900>Get-Process</span> | <span style=color:#b58900>Out-File</span> process1.txt -NoClobber
</span></span><span style=display:flex><span><span style=color:#b58900>Out-File</span> : The file <span style=color:#2aa198>&#39;C:\test\process1.txt&#39;</span> already exists.
</span></span><span style=display:flex><span>At line:<span style=color:#2aa198>1</span> char:<span style=color:#2aa198>15</span>
</span></span><span style=display:flex><span>+ <span style=color:#b58900>Get-Process</span> | <span style=color:#b58900>Out-File</span> process1.txt -NoClobber
</span></span><span style=display:flex><span>+               ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</span></span><span style=display:flex><span>    + CategoryInfo          : ResourceExists: (C:\test\process1.txt:String) [<span style=color:#b58900>Out-File</span>], IOException
</span></span><span style=display:flex><span>    + FullyQualifiedErrorId : NoClobber,Microsoft.PowerShell.Commands.OutFileCommand
</span></span></code></pre></div><p>Send output in ASCII format (by default it is Unicode).</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b58900>PS </span>C:\test&gt; <span style=color:#b58900>Get-Process</span> | <span style=color:#b58900>Out-File</span> process1.txt -Encoding ASCII
</span></span></code></pre></div><p>You can also use the redirection <code>></code>.</p><ul><li><p><code>></code>: Overwrite</p></li><li><p><code>>></code>: Append</p></li><li><p><code>1></code>: Same as <code>></code></p></li><li><p><code>2></code>: Redirect errors</p></li><li><p><code>3></code>: Redirect warnings</p></li><li><p><code>4></code>: Debug</p></li></ul><p>Combinations work too: <code>2>&amp;1</code>.</p><h3 id=export-csv-and-import-csv>Export-CSV and Import-CSV
<a class=header-link href=#export-csv-and-import-csv><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>We can export the files in CSV format. It will create the columns too. Then we
can open these CSV files in Excel.</p><p>Later we can import them back into variables (for example).</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#586e75># Export running processes (and their other info) to a csv file</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\test&gt; <span style=color:#b58900>Get-Process</span> | <span style=color:#b58900>Export-CSV</span> process1.csv
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># Now importing back from file</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\test&gt; <span style=color:#268bd2>$processes</span> = <span style=color:#b58900>Import-CSV</span> process1.csv
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># Display the variable in the table format</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\test&gt; <span style=color:#268bd2>$processes</span> | <span style=color:#b58900>Format-Table</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Name                     <span style=color:#b58900>SI </span>Handles VM            WS        PM        NPM    Path
</span></span><span style=display:flex><span>----                     -- ------- --            --        --        ---    ----
</span></span><span style=display:flex><span>alg                      <span style=color:#2aa198>0</span>  <span style=color:#2aa198>89</span>      <span style=color:#2aa198>2199052992512</span> <span style=color:#2aa198>2244608</span>   <span style=color:#2aa198>1642496</span>   <span style=color:#2aa198>8480</span>
</span></span><span style=display:flex><span>AMPAgent                 <span style=color:#2aa198>0</span>  <span style=color:#2aa198>205</span>     <span style=color:#2aa198>80158720</span>      <span style=color:#2aa198>11603968</span>  <span style=color:#2aa198>3735552</span>   <span style=color:#2aa198>19048</span>
</span></span></code></pre></div><p>We can <code>Import-CSV</code> without the header and choosing the delimiter</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#268bd2>$csvfile</span> = <span style=color:#b58900>Import-CSV</span> -Delimiter <span style=color:#2aa198>&#34; &#34;</span> -Path whatever.txt -Header <span style=color:#2aa198>&#34;Column1&#34;</span>, <span style=color:#2aa198>&#34;Column2&#34;</span>, <span style=color:#2aa198>&#34;Column3&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># Now we can do stuff for columns, like sort by a column.</span>
</span></span><span style=display:flex><span><span style=color:#268bd2>$csvfile</span> | <span style=color:#b58900>sort </span>-Property Column3 -Descending
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># or do math stuff</span>
</span></span><span style=display:flex><span><span style=color:#268bd2>$csvfile</span> | <span style=color:#b58900>Measure-Object</span> -Property Column3 -Ave -Min -Max
</span></span></code></pre></div><h3 id=measure-object>Measure-Object
<a class=header-link href=#measure-object><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>"Calculates numeric properties of objects."</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#586e75># Calculate the number of files and directories</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\test&gt; <span style=color:#b58900>ls </span>| <span style=color:#b58900>Measure-Object</span>
</span></span><span style=display:flex><span>Count    : <span style=color:#2aa198>2</span>
</span></span><span style=display:flex><span>Average  :
</span></span><span style=display:flex><span>Sum      :
</span></span><span style=display:flex><span>Maximum  :
</span></span><span style=display:flex><span>Minimum  :
</span></span><span style=display:flex><span>Property :
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\test&gt; <span style=color:#b58900>ls
</span></span></span><span style=display:flex><span><span style=color:#b58900></span>    Directory: C:\test
</span></span><span style=display:flex><span>Mode                LastWriteTime         Length Name
</span></span><span style=display:flex><span>----                -------------         ------ ----
</span></span><span style=display:flex><span>-a----         <span style=color:#2aa198>8</span>/<span style=color:#2aa198>1</span>/<span style=color:#2aa198>2016</span>   <span style=color:#2aa198>5</span>:<span style=color:#2aa198>07</span> PM          <span style=color:#2aa198>82290</span> process1.csv
</span></span><span style=display:flex><span>-a----         <span style=color:#2aa198>8</span>/<span style=color:#2aa198>1</span>/<span style=color:#2aa198>2016</span>   <span style=color:#2aa198>4</span>:<span style=color:#2aa198>22</span> PM          <span style=color:#2aa198>61494</span> process1.txt
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># Do stuff with file length</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\test&gt; <span style=color:#b58900>Get-ChildItem</span> | <span style=color:#b58900>Measure-Object</span> -Property length -Minimum -Maximum -Average
</span></span><span style=display:flex><span>Count    : <span style=color:#2aa198>2</span>
</span></span><span style=display:flex><span>Average  : <span style=color:#2aa198>71892</span>
</span></span><span style=display:flex><span>Sum      :
</span></span><span style=display:flex><span>Maximum  : <span style=color:#2aa198>82290</span>
</span></span><span style=display:flex><span>Minimum  : <span style=color:#2aa198>61494</span>
</span></span><span style=display:flex><span>Property : Length
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># Measure characters, words and lines in a text file</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\test&gt; <span style=color:#b58900>cat </span>.\process1.txt | <span style=color:#b58900>Measure-Object</span> -Word -Line -Character
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Lines Words Characters Property
</span></span><span style=display:flex><span>----- ----- ---------- --------
</span></span><span style=display:flex><span>  <span style=color:#2aa198>254</span>  <span style=color:#2aa198>2160</span>      <span style=color:#2aa198>30226</span>
</span></span></code></pre></div><h2 id=section-5---practical-uses--conclusion>Section 5 - Practical Uses & Conclusion
<a class=header-link href=#section-5---practical-uses--conclusion><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p><a href=https://tutorials.cyberaces.org/tutorials/view/3-3-5 target=_blank rel="noreferrer noopener">https://tutorials.cyberaces.org/tutorials/view/3-3-5</a></p><h3 id=ping-all-ips-in-a-range>Ping All IPs in a Range
<a class=header-link href=#ping-all-ips-in-a-range><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p><code>PS C:\> 1..254 | % { ping "192.168.0.$_" }</code></p><h3 id=process-manipulation>Process Manipulation
<a class=header-link href=#process-manipulation><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>Things to do with processes.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#586e75># Start a process</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#b58900>Start-Process</span> -FilePath <span style=color:#2aa198>&#34;notepad.exe&#34;</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#b58900>Start-Process</span> notepad
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># We get more control with Start-Process</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># Redirect input and output</span>
</span></span><span style=display:flex><span><span style=color:#586e75># From Get-Help Start-Process -Examples</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#b58900>Start-Process</span> -FilePath <span style=color:#2aa198>&#34;Sort.exe&#34;</span> -RedirectStandardInput <span style=color:#2aa198>&#34;Testsort.txt&#34;</span> -RedirectStandardOutput
</span></span><span style=display:flex><span>    <span style=color:#2aa198>&#34;Sorted.txt&#34;</span> -RedirectStandardError <span style=color:#2aa198>&#34;SortError.txt&#34;</span> -UseNewEnvironment
</span></span><span style=display:flex><span><span style=color:#586e75># The UseNewEnvironment parameter specifies that the process runs with its own environment variables.</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># Start a process in a maximized window</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#b58900>Start-Process</span> -FilePath <span style=color:#2aa198>&#34;notepad&#34;</span> -Wait -WindowStyle Maximized
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># Start Windows PowerShell as an administrator</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#b58900>Start-Process</span> -FilePath <span style=color:#2aa198>&#34;powershell&#34;</span> -Verb runAs
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75>#  Starts a PowerShell process in a new console window.</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\&gt; <span style=color:#b58900>Start-Process</span> -FilePath <span style=color:#2aa198>&#34;powershell.exe&#34;</span> -Verb open
</span></span></code></pre></div><p>Kill process by ID, name or path</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#586e75># PID</span>
</span></span><span style=display:flex><span><span style=color:#b58900>Stop-Process</span> <span style=color:#2aa198>1234</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># Name</span>
</span></span><span style=display:flex><span><span style=color:#b58900>Stop-Process</span> notepad
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># Path</span>
</span></span><span style=display:flex><span><span style=color:#b58900>ps </span>| ? { <span style=color:#268bd2>$_</span>.Path <span style=color:#719e07>-Like</span> <span style=color:#2aa198>&#34;C:\python27\*&#34;</span> } | <span style=color:#b58900>kill
</span></span></span></code></pre></div><h3 id=-verb>-Verb
<a class=header-link href=#-verb><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>What are these verbs? The verbs are determined by the file extension.</p><p>To find Verbs for each file use:</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b58900>PS </span>C:\test&gt; <span style=color:#268bd2>$txtFile</span> = <span style=color:#b58900>New-Object</span> System.Diagnostics.ProcessStartInfo -Args process1.txt
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\test&gt; <span style=color:#268bd2>$txtFile</span>.Verbs
</span></span><span style=display:flex><span>open
</span></span><span style=display:flex><span>print
</span></span><span style=display:flex><span>printto
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># Now we can run one the verbs</span>
</span></span><span style=display:flex><span><span style=color:#586e75># This will open it in notepad (default program for txt files)</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\test&gt; <span style=color:#b58900>Start-Process</span> -FilePath .\process1.txt -Verb open
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># We can print it with the Print Verb</span>
</span></span></code></pre></div><h3 id=iterate-through-files-in-a-folder>Iterate Through Files in a Folder
<a class=header-link href=#iterate-through-files-in-a-folder><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>Folders (directories) are containers while files are not. We can check it with
<code>PsIsContainer</code>.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b58900>ls </span>| ? { !<span style=color:#268bd2>$_</span>.PsIsContainer } == <span style=color:#b58900>ls </span>| ? { <span style=color:#719e07>-not</span> <span style=color:#268bd2>$_</span>.PsIsContainer }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># To view hidden and system files</span>
</span></span><span style=display:flex><span><span style=color:#586e75># -Fo or -Force</span>
</span></span><span style=display:flex><span><span style=color:#b58900>ls </span>-Force
</span></span></code></pre></div><h3 id=get-filehash>Get-FileHash
<a class=header-link href=#get-filehash><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>Calculate file hash using different hashing algorithms. PowerShell 4.0 and up.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#586e75># Default algorithm is SHA256 and as you can see the output is truncated (because it&#39;s too long).</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\test&gt; <span style=color:#b58900>Get-FileHash</span> .\process1.txt
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Algorithm       Hash                                                                   Path
</span></span><span style=display:flex><span>---------       ----                                                                   ----
</span></span><span style=display:flex><span>SHA256          FDA966B28DB48262D48DBC1680268B5DE814F0D3E2BBFEC4F7C2CBF3A4047802       C:\tes...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># To see the whole output we can pipe it to Format-List</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\test&gt; <span style=color:#b58900>Get-FileHash</span> .\process1.txt | <span style=color:#b58900>Format-List</span>
</span></span><span style=display:flex><span>Algorithm : SHA256
</span></span><span style=display:flex><span>Hash      : FDA966B28DB48262D48DBC1680268B5DE814F0D3E2BBFEC4F7C2CBF3A4047802
</span></span><span style=display:flex><span>Path      : C:\test\process1.txt
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># To use a different hashing algorithm use -Algorithm</span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>C:\test&gt; <span style=color:#b58900>Get-FileHash</span> .\process1.txt -Algorithm SHA384 | <span style=color:#b58900>Format-List</span>
</span></span><span style=display:flex><span>Algorithm : SHA384
</span></span><span style=display:flex><span>Hash      : DAFC5DFEC5E52441EFD4453D226486CAF011C2BCECF857690F2BC09AC1A7354E2D7E4D1935AB2CB92A82
</span></span><span style=display:flex><span>            F485699C0CCA
</span></span><span style=display:flex><span>Path      : C:\test\process1.txt
</span></span></code></pre></div><p>Different algorithms:</p><ul><li>SHA1</li><li>SHA256</li><li>SHA384</li><li>SHA512</li><li>MACTripleDES</li><li>MD5</li><li>RIPEMD160</li></ul><p>It seems like it does not have one for strings.</p><h3 id=select-string-almost-like-grep>Select-String (almost like grep)
<a class=header-link href=#select-string-almost-like-grep><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>Unfortunately it cannot do recursive searching. (<code>-r</code> for <code>grep</code>).</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b58900>ls </span>-Force -Filter *.txt -Recursive | <span style=color:#b58900>Select-String</span> <span style=color:#2aa198>&#34;password&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># -Force -fo: Show hidden and system files.</span>
</span></span><span style=display:flex><span><span style=color:#586e75># -Filter -fi *.txt: Show only txt files.</span>
</span></span><span style=display:flex><span>* -Recursive: -r
</span></span></code></pre></div></div><footer><p class=meta></span></p></footer></article></div><aside class="sidebar thirds"><section class="first odd"><h2>Table of Contents</h2><nav id=TableOfContents><ul><li><ul><li><a href=#case-sensitivity>Case Sensitivity</a></li><li><a href=#how-to-get-help---this-is-your-best-friend>How to Get Help - This is Your Best Friend</a><ul><li><a href=#get-help-or-help-or-man>Get-Help or help or man</a></li></ul></li><li><a href=#aliases>Aliases</a><ul><li><a href=#get-alias-cmdlet>Get-Alias Cmdlet</a></li><li><a href=#set-alias>Set-Alias</a></li><li><a href=#common-aliases-between-powershell-and-bash>Common Aliases Between PowerShell and Bash</a></li></ul></li><li><a href=#session-1---introduction-to-powershell>Session 1 - Introduction to PowerShell</a><ul><li><a href=#naming-convention>Naming Convention</a></li><li><a href=#parameters>Parameters</a></li><li><a href=#get-member>Get-Member</a></li><li><a href=#piping>Piping</a></li></ul></li><li><a href=#session-2---cmdlets>Session 2 - Cmdlets</a><ul><li><a href=#get-childitem>Get-ChildItem</a><ul><li><a href=#read-registry>Read Registry</a></li><li><a href=#read-windows-certificate-store>Read Windows Certificate Store</a></li></ul></li><li><a href=#cd-or-change-directory>cd or Change Directory</a></li></ul></li><li><a href=#session-3-scripting-variables-and-syntax>Session 3: Scripting, Variables and Syntax</a><ul><li><a href=#executionpolicy>ExecutionPolicy</a></li><li><a href=#variables>Variables</a><ul><li><a href=#variable-types>Variable Types</a></li></ul></li><li><a href=#arrays>Arrays</a></li><li><a href=#get-member-1>Get-Member</a><ul><li><a href=#get-childitem-variable>Get-ChildItem variable:</a></li></ul></li><li><a href=#user-properties-of-cmdlet-output>User Properties of Cmdlet Output</a></li><li><a href=#double-quotes-vs-single-quotes>Double Quotes vs. Single Quotes</a></li></ul></li><li><a href=#section-4---flow-control>Section 4 - Flow Control</a><ul><li><a href=#whatif---confirm---verbose>WhatIf - Confirm - Verbose</a></li><li><a href=#operators>Operators</a></li><li><a href=#if---then---else>If - Then - Else</a></li><li><a href=#where-object-filtering>Where-Object Filtering</a></li><li><a href=#foreach-object>ForEach-Object</a></li><li><a href=#select-object>Select-Object</a></li><li><a href=#output-and-the-format-verb>Output and the Format Verb</a></li><li><a href=#file-output>File Output</a></li><li><a href=#export-csv-and-import-csv>Export-CSV and Import-CSV</a></li><li><a href=#measure-object>Measure-Object</a></li></ul></li><li><a href=#section-5---practical-uses--conclusion>Section 5 - Practical Uses & Conclusion</a><ul><li><a href=#ping-all-ips-in-a-range>Ping All IPs in a Range</a></li><li><a href=#process-manipulation>Process Manipulation</a></li><li><a href=#-verb>-Verb</a></li><li><a href=#iterate-through-files-in-a-folder>Iterate Through Files in a Folder</a></li><li><a href=#get-filehash>Get-FileHash</a></li><li><a href=#select-string-almost-like-grep>Select-String (almost like grep)</a></li></ul></li></ul></li></ul></nav></section></aside></div></div><footer role=contentinfo><p>Copyright &copy; 2023 Parsia-Clone - <a href=https://parsiya.io/license/>License</a> -
<span class=credit>Powered by <a target=_blank href=https://gohugo.io rel="noopener noreferrer">Hugo</a> and <a target=_blank href=https://github.com/parsiya/hugo-octopress/ rel="noopener noreferrer">Hugo-Octopress</a> theme.</p></footer></body></html>