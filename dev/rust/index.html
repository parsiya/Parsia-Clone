<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,minimum-scale=1,maximum-scale=1"><link href=/css/fonts.css rel=stylesheet type=text/css><title>Rust</title>
<link rel=stylesheet href=/css/hugo-octopress.css><link rel=stylesheet href=https://parsiya.io//clone.css><link rel=stylesheet href=/css/fork-awesome.min.css><link href=https://parsiya.io/favicon.png rel=icon><meta name=description content><meta name=keywords content="[Parsia Hakimian Parsiya infosec information security]"><meta name=author content="Parsia-Clone"><meta name=generator content="Hugo 0.125.4"><meta name=twitter:card content="summary"><meta name=twitter:title content="Rust"><meta name=twitter:description content="Learning Rust &#34;The book&#34;: https://doc.rust-lang.org/stable/book/ Playground: https://play.rust-lang.org/ Install Rust in WSL (from https://www.rust-lang.org/tools/install):
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh Chapter 1 cargo whatever # create a package in `whatever` directory under the current path. `whatever/src/main.rs` will have `hello world`. cd whatever cargo check # check if it compiles without building cargo building # build the package cargo run # run Chapter 2 Every variable is immutable, have to make it mutable with mut: let mut something = 1;"><meta name=twitter:domain content="parsiya.io"><meta name=twitter:creator content="@CryptoGangsta"></head><body><header role=banner><hgroup><h1><a href=https://parsiya.io/>Parsia-Clone</a></h1><h2>'Documentation is a love letter that you write to your future self.' - Damian Conway</h2></hgroup></header><nav role=navigation><fieldset class=mobile-nav><select onchange="location=this.value"><option value>Navigate…</option><option value=https://github.com/parsiya/Parsia-Clone>» Parsia-Clone on Github</option><option value=https://parsiya.net/categories/clone/>» How did I make this?</option><option value=https://parsiya.net>» My Main Website</option></select></fieldset><ul class=main-navigation><li><a href=https://github.com/parsiya/Parsia-Clone title="Parsia-Clone on Github" target=_blank rel="noopener noreferrer">Parsia-Clone on Github</a></li><li><a href=https://parsiya.net/categories/clone/ title="How did I make this?" target=_blank rel="noopener noreferrer">How did I make this?</a></li><li><a href=https://parsiya.net title="My Main Website" target=_blank rel="noopener noreferrer">My Main Website</a></li></ul><ul class=subscription></ul><form action=https://www.google.com/search method=get target=_blank rel="noopener noreferrer"><fieldset role=search><input class=search type=text name=q results=0 placeholder=Search>
<input type=hidden name=q value=site:https://parsiya.io/></fieldset></form></nav><div id=main><div id=content><div><article class=hentry role=article><header><p class=meta>52 minute read
- <a class=label href=https://parsiya.io/categories/development/>Development</a></p><h1 class=entry-title>Rust</h1><a href=https://github.com/parsiya/Parsia-Clone/tree/main/dev/rust.md target=_blank>Github Link</a></header><div class=entry-content><nav id=TableOfContents><ul><li><a href=#learning-rust>Learning Rust</a></li><li><a href=#chapter-1>Chapter 1</a></li><li><a href=#chapter-2>Chapter 2</a><ul><li><a href=#dependencies>Dependencies</a></li><li><a href=#adding-a-loop>Adding a Loop</a></li><li><a href=#handling-invalid-input>Handling Invalid Input</a></li></ul></li><li><a href=#chapter-3>Chapter 3</a><ul><li><a href=#mutability>Mutability</a></li><li><a href=#constants>Constants</a></li><li><a href=#shadowing>Shadowing</a></li><li><a href=#integers>Integers</a></li><li><a href=#floating-point>Floating Point</a></li><li><a href=#numeric-operations>Numeric Operations</a></li><li><a href=#boolean>Boolean</a></li><li><a href=#character-type>Character Type</a></li><li><a href=#tuple>Tuple</a></li><li><a href=#array>Array</a></li><li><a href=#string-literals>String Literals</a></li><li><a href=#functions>Functions</a></li><li><a href=#if-else>if-else</a></li><li><a href=#loop>loop</a></li><li><a href=#while>while</a></li><li><a href=#loop-through-collections-with-for>Loop Through Collections with for</a></li></ul></li><li><a href=#chapter-4>Chapter 4</a><ul><li><a href=#ownership-rules>Ownership Rules</a></li><li><a href=#the-string-type>The String Type</a></li><li><a href=#move>Move</a></li><li><a href=#clone>Clone</a></li><li><a href=#copy>Copy</a></li><li><a href=#ownership-and-functions>Ownership and Functions</a></li><li><a href=#references>References</a></li><li><a href=#mutable-references>Mutable References</a></li><li><a href=#reference-scope>Reference Scope</a></li><li><a href=#dangling-reference>Dangling Reference</a></li><li><a href=#the-slice-type>The Slice Type</a></li><li><a href=#string-slice>String Slice</a></li><li><a href=#other-slices>Other Slices</a></li></ul></li><li><a href=#chapter-5>Chapter 5</a><ul><li><a href=#structs>Structs</a></li><li><a href=#field-init-shorthand>Field Init Shorthand</a></li><li><a href=#struct-update-syntax>Struct Update Syntax</a></li><li><a href=#tuple-structs>Tuple Structs</a></li><li><a href=#unit-like-structs>Unit-Like Structs</a></li><li><a href=#derived-traits>Derived Traits</a></li><li><a href=#the-dbg-macro>The dbg Macro</a></li><li><a href=#methods>Methods</a></li><li><a href=#automatic-referencing-and-dereferencing>Automatic Referencing and Dereferencing</a></li><li><a href=#associated-functions>Associated Functions</a></li></ul></li><li><a href=#chapter-6>Chapter 6</a><ul><li><a href=#define-an-enum>Define an Enum</a></li><li><a href=#enum-methods-and-match>Enum Methods and match</a></li><li><a href=#option-enum>Option Enum</a></li><li><a href=#matching-with-optiont>Matching with Option<t></a></li><li><a href=#if-let>if let</a></li></ul></li><li><a href=#chapter-7>Chapter 7</a><ul><li><a href=#packages--crates>Packages & Crates</a></li><li><a href=#modules>Modules</a></li><li><a href=#paths>Paths</a></li><li><a href=#rusts-privacy-boundary>Rust's Privacy Boundary</a></li><li><a href=#super>Super</a></li><li><a href=#public-structs>Public Structs</a></li><li><a href=#public-enums>Public Enums</a></li><li><a href=#the-use-keyword>The use Keyword</a></li><li><a href=#pub-use>pub use</a></li><li><a href=#nested-paths-in-use>Nested Paths in use</a></li><li><a href=#modules-in-different-files>Modules in Different Files</a></li></ul></li><li><a href=#chapter-8>Chapter 8</a><ul><li><a href=#vectors>Vectors</a></li><li><a href=#read-vector-values>Read Vector Values</a></li><li><a href=#iterate-over-vector-elements>Iterate over Vector Elements</a></li><li><a href=#using-an-enum-to-store-multiple-types>Using an Enum to Store Multiple Types</a></li><li><a href=#remove-vector-values>Remove Vector Values</a></li><li><a href=#strings>Strings</a></li><li><a href=#hashmaps>HashMaps</a></li><li><a href=#hashmaps-and-ownership>HashMaps and Ownership</a></li><li><a href=#reading-hashmaps>Reading HashMaps</a></li><li><a href=#iterating-over-the-hashmap>Iterating over the HashMap</a></li><li><a href=#updating-a-hash-map>Updating a Hash Map</a></li></ul></li><li><a href=#chapter-9>Chapter 9</a><ul><li><a href=#panic>panic!</a></li><li><a href=#recoverable-errors>Recoverable Errors</a></li><li><a href=#matching-on-different-errors>Matching on Different Errors</a></li><li><a href=#unwrap-and-expect>unwrap and expect</a></li><li><a href=#propagating-errors>Propagating Errors</a></li><li><a href=#shortcut-for-propagating-errors>Shortcut for Propagating Errors</a></li></ul></li><li><a href=#misc>Misc</a><ul><li><a href=#type-alias>Type Alias</a></li><li><a href=#extension-trait>Extension Trait</a></li><li><a href=#import-an-adjacent-module>Import an Adjacent Module</a></li><li><a href=#crate-level-pub>Crate Level Pub</a></li><li><a href=#embed-files-in-the-binary>Embed Files in the Binary</a></li><li><a href=#convert-vecstring-to-vecstr>Convert Vec<string> to Vec&lt;&amp;str></a></li><li><a href=#extend-a-struct-in-another>Extend a Struct in Another</a></li></ul></li></ul></nav><h1 id=learning-rust>Learning Rust
<a class=header-link href=#learning-rust><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><ul><li>"The book": <a href=https://doc.rust-lang.org/stable/book/ target=_blank rel="noreferrer noopener">https://doc.rust-lang.org/stable/book/</a></li><li>Playground: <a href=https://play.rust-lang.org/ target=_blank rel="noreferrer noopener">https://play.rust-lang.org/</a></li></ul><p>Install Rust in WSL (from <a href=https://www.rust-lang.org/tools/install%29 target=_blank rel="noreferrer noopener">https://www.rust-lang.org/tools/install)</a>:</p><ul><li><code>curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh</code></li></ul><h1 id=chapter-1>Chapter 1
<a class=header-link href=#chapter-1><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><pre tabindex=0><code>cargo whatever
# create a package in `whatever` directory under the current path.
`whatever/src/main.rs` will have `hello world`.

cd whatever

cargo check     # check if it compiles without building

cargo building  # build the package

cargo run       # run
</code></pre><h1 id=chapter-2>Chapter 2
<a class=header-link href=#chapter-2><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><p>Every variable is immutable, have to make it mutable with <code>mut</code>:
<code>let mut something = 1;</code></p><p>References passed to functions can also be mutable or not regardless of the
underlying variable. E.g., we can create an immutable reference to a mutable
variable. In the code below <code>read_line</code> needs a <code>mut string</code>, so we pass
<code>&amp;mut guess</code> instead of just <code>&amp;guess</code>.</p><p><code>read_line</code> appends whatever is read from the command line to the argument. It
does not overwrite anything. Here, it doesn't matter because <code>guess</code> is empty.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>use</span> std::io;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> <span style=color:#719e07>mut</span> guess <span style=color:#719e07>=</span> <span style=color:#b58900>String</span>::new();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    io::stdin()
</span></span><span style=display:flex><span>        .read_line(<span style=color:#719e07>&amp;</span><span style=color:#719e07>mut</span> guess)
</span></span><span style=display:flex><span>        .expect(<span style=color:#2aa198>&#34;Failed to read line&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;You guessed: </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, guess);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><code>expect</code>: The result of <code>read_line</code> is an enum of type <code>io::Result</code>. It can be
<code>Ok</code> or <code>Err</code>. If the value is <code>Err</code> then <code>expect</code> is called that crashes the
program and displays the message passed to it (<code>Failed to</code>). If the value is
<code>Ok</code> then <code>expect</code> will return the number of bytes read which we are not using
here. We can use it like this:</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#268bd2>let</span> bytes <span style=color:#719e07>=</span> io::stdin()
</span></span><span style=display:flex><span>    <span style=color:#586e75>// Read from input and append to guess.
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    .read_line(<span style=color:#719e07>&amp;</span><span style=color:#719e07>mut</span> guess)
</span></span><span style=display:flex><span>    .expect(<span style=color:#2aa198>&#34;Failed to read line&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>println!(<span style=color:#2aa198>&#34;Read </span><span style=color:#2aa198>{}</span><span style=color:#2aa198> bytes&#34;</span>, bytes);
</span></span></code></pre></div><p>Finally, we have the placeholder similar to <code>printf(%v)</code> in Go.</p><h2 id=dependencies>Dependencies
<a class=header-link href=#dependencies><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Edit <code>Cargo.toml</code> and add dependencies like <code>rand = "0.8.3"</code>. Then <code>cargo build</code>.</p><p><code>cargo update</code> ignores <code>Cargo.lock</code> and grabs the latest versions of libraries
(that fit the versions specified in <code>Cargo.toml</code>).</p><p>Now, we can use <code>rand</code> here like this:</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>use</span> rand::Rng;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;Guess the number!&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#586e75>// Generate a &#34;random&#34; number between 1 and 100.
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#586e75>// Alternative param to &#34;1..101&#34; is &#34;1..=100&#34;.
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#268bd2>let</span> secret_number <span style=color:#719e07>=</span> rand::thread_rng().gen_range(<span style=color:#2aa198>1</span><span style=color:#719e07>..</span><span style=color:#2aa198>101</span>);
</span></span><span style=display:flex><span>    <span style=color:#586e75>// removed
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>}
</span></span></code></pre></div><p><code>1..101</code> range == <code>[1, 101)</code> == number between 1 and 100 == <code>1..=100</code>.</p><p>The VS Code Rust language server shows us the docs for methods (and does other
things like autocomplete), but it's also possible to see the crate docs with
<code>crate doc --open</code>. This will build the docs for each of the dependencies and
open them in the browser.</p><p>To do a comparison, we add <code>std::cmp::Ordering</code> which is another enum with three
values: <code>Less/Greater/Equal</code>.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#586e75>// ch02/guessing_game/src/main.rs
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#719e07>use</span> std::cmp::Ordering;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#586e75>// removed
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>
</span></span><span style=display:flex><span>    <span style=color:#586e75>// Create a mutable string.
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#268bd2>let</span> <span style=color:#719e07>mut</span> guess <span style=color:#719e07>=</span> <span style=color:#b58900>String</span>::new();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> bytes <span style=color:#719e07>=</span> io::stdin()
</span></span><span style=display:flex><span>        <span style=color:#586e75>// Read from input and append to guess.
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>        .read_line(<span style=color:#719e07>&amp;</span><span style=color:#719e07>mut</span> guess)
</span></span><span style=display:flex><span>        .expect(<span style=color:#2aa198>&#34;Failed to read line&#34;</span>);
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#586e75>// cmp compares two values
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#719e07>match</span> guess.cmp(<span style=color:#719e07>&amp;</span>secret_number) {
</span></span><span style=display:flex><span>        Ordering::Less <span style=color:#719e07>=&gt;</span> println!(<span style=color:#2aa198>&#34;Too small!&#34;</span>),
</span></span><span style=display:flex><span>        Ordering::Greater <span style=color:#719e07>=&gt;</span> println!(<span style=color:#2aa198>&#34;Too big!&#34;</span>),
</span></span><span style=display:flex><span>        Ordering::Equal <span style=color:#719e07>=&gt;</span> println!(<span style=color:#2aa198>&#34;You win!&#34;</span>),
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#586e75>// removed
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>}
</span></span></code></pre></div><p><code>cmp</code> compares two values. Usable on anything that can be compared. The result
is an enum of <code>Ordering</code>. We can use the <code>match</code> to do something based on what
was returned. In this case we have three <code>arms</code> (choices). Each arm has a
<code>pattern</code> (e.g., <code>Ordering::Less</code>) and an action <code>println!</code>.</p><p>This won't compile because <code>secret_number</code> is of type <code>integer</code> and <code>guess</code> is a
<code>string</code> so we cannot compare them.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#268bd2>let</span> guess: <span style=color:#dc322f>u32</span> <span style=color:#719e07>=</span> guess.trim().parse().expect(<span style=color:#2aa198>&#34;Please type a number!&#34;</span>);
</span></span></code></pre></div><p>Instead of creating a new variable to store <code>guess</code> converted to an integer, we
can <code>shadow</code> the previous value. This allows us to reuse the variable name and
usually used in situations like this.</p><p><code>guess.trim()</code> removes whitespace before/after the string. The string has the
new line character(s) because we pressed enter to finish it so it must be
trimmed.</p><p><code>.parse()</code> converts a string into a number. To tell Rust which kind of number,
we annotate the variable with <code>let guess: u32</code>.</p><p><code>.expect</code> returns the error if <code>parse</code> returns an error and the converted number
if the return value is <code>Ok</code>.</p><h2 id=adding-a-loop>Adding a Loop
<a class=header-link href=#adding-a-loop><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>We can do an infinite loop with</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>loop</span> {
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;Please input your guess.&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#586e75>// removed
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;You guessed: </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, guess);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>We can break out of it with <code>break</code>. We want to leave the loop when we guess the
number correctly so we add to the actions for the <code>Ordering::Equal</code> arm.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>match</span> guess.cmp(<span style=color:#719e07>&amp;</span>secret_number) {
</span></span><span style=display:flex><span>    Ordering::Less <span style=color:#719e07>=&gt;</span> println!(<span style=color:#2aa198>&#34;Too small!&#34;</span>),
</span></span><span style=display:flex><span>    Ordering::Greater <span style=color:#719e07>=&gt;</span> println!(<span style=color:#2aa198>&#34;Too big!&#34;</span>),
</span></span><span style=display:flex><span>    Ordering::Equal <span style=color:#719e07>=&gt;</span> {
</span></span><span style=display:flex><span>        println!(<span style=color:#2aa198>&#34;You win!&#34;</span>);
</span></span><span style=display:flex><span>        <span style=color:#719e07>break</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=handling-invalid-input>Handling Invalid Input
<a class=header-link href=#handling-invalid-input><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Entering a non-number will crash the program. Let's handle it. Instead of
calling <code>expect</code> we <code>match</code> on the return value of <code>parse</code>.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#268bd2>let</span> guess: <span style=color:#dc322f>u32</span> <span style=color:#719e07>=</span> <span style=color:#719e07>match</span> guess.trim().parse() {
</span></span><span style=display:flex><span>    <span style=color:#b58900>Ok</span>(num) <span style=color:#719e07>=&gt;</span> num,     <span style=color:#586e75>// If parse worked correctly, store the number in guess.
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#b58900>Err</span>(_) <span style=color:#719e07>=&gt;</span> <span style=color:#719e07>continue</span>, <span style=color:#586e75>// If parse returned an error, go back to the beginning of the loop.
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>};
</span></span></code></pre></div><p>If <code>parse</code> worked correctly it returns an <code>Ok</code> value that contains the number.
Otherwise, it returns an <code>Err</code> with the error message. In <code>Err(_)</code> we are
catching every message (with <code>_</code>).</p><h1 id=chapter-3>Chapter 3
<a class=header-link href=#chapter-3><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><p>Some programming concepts in Rust.</p><h2 id=mutability>Mutability
<a class=header-link href=#mutability><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>We already know this. Every variable is immutable unless we use <code>mut</code>. If we
want to modify an immutable variable, the compiler warns us and does not compile
the program. See <a href=ch03/variables/src/main.rs>ch03/variables/src/main.rs</a>.</p><h2 id=constants>Constants
<a class=header-link href=#constants><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Created with <code>const</code> keyword. We cannot use <code>mut</code> with them because they are
always immutable. Can only be set to a constant expression not something that is
calculated at runtime.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>const</span> <span style=color:#cb4b16>FIRST_NAME</span> <span style=color:#719e07>=</span> <span style=color:#2aa198>&#34;Parsia&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#719e07>const</span> <span style=color:#cb4b16>TIME</span>: <span style=color:#dc322f>u32</span> <span style=color:#719e07>=</span> <span style=color:#2aa198>10</span> <span style=color:#719e07>*</span> <span style=color:#2aa198>20</span> <span style=color:#719e07>*</span> <span style=color:#2aa198>30</span>;
</span></span></code></pre></div><p>Naming convention: All uppercase with underscore between words.</p><h2 id=shadowing>Shadowing
<a class=header-link href=#shadowing><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Declare a variable with the same name. Interestingly, this can be done in
specific scopes. E.g., we can shadow a variable inside a block but it will not
be modified outside.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#586e75>// ch03/shadowing/src/main.rs
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> x <span style=color:#719e07>=</span> <span style=color:#2aa198>5</span>;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> x <span style=color:#719e07>=</span> x <span style=color:#719e07>+</span> <span style=color:#2aa198>1</span>; <span style=color:#586e75>// x = 6
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#586e75>// Seems like we can just create random blocks here.
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    {
</span></span><span style=display:flex><span>        <span style=color:#268bd2>let</span> x <span style=color:#719e07>=</span> x <span style=color:#719e07>*</span> <span style=color:#2aa198>2</span>;  <span style=color:#586e75>// x = 12
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>        <span style=color:#586e75>// x is only shadowed in this scope.
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>        println!(<span style=color:#2aa198>&#34;The value of x in the inner scope is: </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, x);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#586e75>// x = 6 because this one is not touched.
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    println!(<span style=color:#2aa198>&#34;The value of x is: </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, x);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Seems like we can just make blocks with <code>{ }</code>.</p><p>Differences with <code>mut</code>:</p><ol><li>We can shadow an immutable variable and create an immutable variable with the
same name.</li><li>We can change the type and reuse the name. We cannot change the type of a
mutable variable.</li></ol><p>This works because we are shadowing <code>spaces</code> and creating a new variable of type
int.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> spaces <span style=color:#719e07>=</span> <span style=color:#2aa198>&#34;   &#34;</span>;
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> spaces <span style=color:#719e07>=</span> spaces.len();
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>We can also make the new <code>spaces</code> mutable:</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#586e75>// ch03/shadowing2/src/main.rs
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> spaces <span style=color:#719e07>=</span> <span style=color:#2aa198>&#34;   &#34;</span>;
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;spaces: </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, spaces);
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> <span style=color:#719e07>mut</span> spaces <span style=color:#719e07>=</span> spaces.len();
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;spaces: </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, spaces);
</span></span><span style=display:flex><span>    spaces <span style=color:#719e07>=</span> <span style=color:#2aa198>1234</span>;
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;spaces: </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, spaces);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>returns:</p><pre tabindex=0><code>spaces: [prints three spaces]
spaces: 3
spaces: 1234
</code></pre><p>If we make a variable mutable but do not modify it, the compiler will give us a
warning saying it should not be mutable.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> spaces <span style=color:#719e07>=</span> <span style=color:#2aa198>&#34;   &#34;</span>;
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;spaces: </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, spaces);
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> <span style=color:#719e07>mut</span> spaces <span style=color:#719e07>=</span> spaces.len();
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;spaces: </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, spaces);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>The shadowing <code>spaces</code> (2nd one) is mutable but not modified so we get:</p><pre tabindex=0><code>Compiling playground v0.0.1 (/playground)
warning: variable does not need to be mutable
 --&gt; src/main.rs:4:9
  |
4 |     let mut spaces = spaces.len();
  |         ----^^^^^^
  |         |
  |         help: remove this `mut`
  |
  = note: `#[warn(unused_mut)]` on by default

warning: `playground` (bin &#34;playground&#34;) generated 1 warning
    Finished dev [unoptimized + debuginfo] target(s) in 1.79s
     Running `target/debug/playground`
Standard Output
spaces:    
spaces: 3
</code></pre><h2 id=integers>Integers
<a class=header-link href=#integers><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Like we have seen before. We can have 8, 16, 32, 64, and 128-bit integers.
Default is <code>i32</code>.</p><ul><li>Signed: <code>i8 i16 i32 i64 i128</code></li><li>Unsigned: <code>u8 u16 u32 u64 u128</code></li></ul><p>There's also <code>isize</code> (signed) and <code>usize</code> (unsigned) which are based on the
machine. E.g., i64 for 64-bit machines.</p><p>When writing integer literals we can use some help:</p><ul><li><code>_</code> is ignored so <code>1_200</code> and <code>1200</code> are equal.</li><li>Start<ul><li>Hex number with <code>0x</code>: <code>0xAB</code>.</li><li>Octal number with <code>0o</code> (zero and the letter <code>o</code>): <code>0o77</code>.</li><li>Binary number with <code>0b</code>: <code>0b0011_1111</code>. See the <code>_</code> for better readability.</li><li>Byte with <code>b</code> (only <code>u8</code>): <code>b'A'</code>.</li></ul></li></ul><h2 id=floating-point>Floating Point
<a class=header-link href=#floating-point><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p><code>f32</code> and <code>f64</code> (default). To specify <code>f32</code> we need to annotate it:</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> x <span style=color:#719e07>=</span> <span style=color:#2aa198>2.0</span>; <span style=color:#586e75>// f64
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> y: <span style=color:#dc322f>f32</span> <span style=color:#719e07>=</span> <span style=color:#2aa198>3.0</span>; <span style=color:#586e75>// f32
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>}
</span></span></code></pre></div><h2 id=numeric-operations>Numeric Operations
<a class=header-link href=#numeric-operations><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>As you can imagine.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#586e75>// ch03/numeric_operations.rs
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#586e75>// addition
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#268bd2>let</span> sum <span style=color:#719e07>=</span> <span style=color:#2aa198>5</span> <span style=color:#719e07>+</span> <span style=color:#2aa198>10</span>;
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;5 + 10 = </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, sum); <span style=color:#586e75>// 5 + 10 = 15
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>
</span></span><span style=display:flex><span>    <span style=color:#586e75>// subtraction
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#268bd2>let</span> difference <span style=color:#719e07>=</span> <span style=color:#2aa198>95.5</span> <span style=color:#719e07>-</span> <span style=color:#2aa198>4.3</span>;
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;95.5 - 4.3 = </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, difference); <span style=color:#586e75>// 95.5 - 4.3 = 91.2
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>
</span></span><span style=display:flex><span>    <span style=color:#586e75>// multiplication
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#268bd2>let</span> product <span style=color:#719e07>=</span> <span style=color:#2aa198>4</span> <span style=color:#719e07>*</span> <span style=color:#2aa198>30</span>;
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;4 * 30 = </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, product); <span style=color:#586e75>// 4 * 30 = 120
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>
</span></span><span style=display:flex><span>    <span style=color:#586e75>// division
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#268bd2>let</span> quotient <span style=color:#719e07>=</span> <span style=color:#2aa198>56.7</span> <span style=color:#719e07>/</span> <span style=color:#2aa198>32.2</span>;
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> floored <span style=color:#719e07>=</span> <span style=color:#2aa198>2</span> <span style=color:#719e07>/</span> <span style=color:#2aa198>3</span>; <span style=color:#586e75>// Results in 0
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    println!(<span style=color:#2aa198>&#34;56.7 / 32.2 = </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, quotient); <span style=color:#586e75>// 56.7 / 32.2 = 1.7608695652173911
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    println!(<span style=color:#2aa198>&#34;2 / 3 = </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, floored); <span style=color:#586e75>// 2 / 3 = 0
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>
</span></span><span style=display:flex><span>    <span style=color:#586e75>// remainder
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#268bd2>let</span> remainder <span style=color:#719e07>=</span> <span style=color:#2aa198>43</span> <span style=color:#719e07>%</span> <span style=color:#2aa198>5</span>;
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;43 % 5 = </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, remainder); <span style=color:#586e75>// 43 % 5 = 3
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>}
</span></span></code></pre></div><h2 id=boolean>Boolean
<a class=header-link href=#boolean><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p><code>true</code> and <code>false</code>.</p><h2 id=character-type>Character Type
<a class=header-link href=#character-type><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p><code>char</code>: 4-bytes Unicode Scalar values. E.g., <code>U+0031</code> or emojis.</p><p>Used with <code>'</code> (strings use <code>"</code>).</p><h2 id=tuple>Tuple
<a class=header-link href=#tuple><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Fixed-size array/slice of values with different types.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#586e75>// ch03/tuple.rs
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#586e75>// create a tuple like this, note the type annotation.
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#268bd2>let</span> tup: (<span style=color:#dc322f>i32</span>, <span style=color:#dc322f>f64</span>, <span style=color:#dc322f>u8</span>) <span style=color:#719e07>=</span> (<span style=color:#2aa198>500</span>, <span style=color:#2aa198>6.4</span>, <span style=color:#2aa198>1</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#586e75>// destructure it to get the values.
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#268bd2>let</span> (x, y, z) <span style=color:#719e07>=</span> tup;
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;x = </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>, y = </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>, z = </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, x, y, z);
</span></span><span style=display:flex><span>    <span style=color:#586e75>// x = 500, y = 6.4, z = 1
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>
</span></span><span style=display:flex><span>    <span style=color:#586e75>// can also get the value by `var.index`.
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    println!(<span style=color:#2aa198>&#34;tup.0 = </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>, tup.1 = </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>, tup.2 = </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, tup.<span style=color:#2aa198>0</span>, tup.<span style=color:#2aa198>1</span>, tup.<span style=color:#2aa198>2</span>); 
</span></span><span style=display:flex><span>    <span style=color:#586e75>// tup.0 = 500, tup.1 = 6.4, tup.2 = 1
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>}
</span></span></code></pre></div><h2 id=array>Array
<a class=header-link href=#array><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Fixed-size array of values with the same type. Goes on stack instead of heap.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#586e75>// ch03/arrays.rs
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> arr <span style=color:#719e07>=</span> [<span style=color:#2aa198>1</span>, <span style=color:#2aa198>2</span>, <span style=color:#2aa198>3</span>];
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;arr = </span><span style=color:#2aa198>{:?}</span><span style=color:#2aa198>&#34;</span>, arr);
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> strings <span style=color:#719e07>=</span> [<span style=color:#2aa198>&#34;one&#34;</span>, <span style=color:#2aa198>&#34;two&#34;</span>, <span style=color:#2aa198>&#34;three&#34;</span>];
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;strings = </span><span style=color:#2aa198>{:?}</span><span style=color:#2aa198>&#34;</span>, strings);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#586e75>// we can also specify the type and size. See below why we are using &amp;str here.
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#268bd2>let</span> arr2: [<span style=color:#719e07>&amp;</span><span style=color:#dc322f>str</span>; <span style=color:#2aa198>3</span>] <span style=color:#719e07>=</span> [<span style=color:#2aa198>&#34;one&#34;</span>, <span style=color:#2aa198>&#34;two&#34;</span>, <span style=color:#2aa198>&#34;three&#34;</span>];
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;arr2 = </span><span style=color:#2aa198>{:?}</span><span style=color:#2aa198>&#34;</span>, arr2);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Specify one initial value for all elements:</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#586e75>// these are the same
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#268bd2>let</span> a <span style=color:#719e07>=</span> [<span style=color:#2aa198>3</span>; <span style=color:#2aa198>5</span>];
</span></span><span style=display:flex><span><span style=color:#268bd2>let</span> b <span style=color:#719e07>=</span> [<span style=color:#2aa198>3</span>, <span style=color:#2aa198>3</span>, <span style=color:#2aa198>3</span>, <span style=color:#2aa198>3</span>, <span style=color:#2aa198>3</span>];
</span></span></code></pre></div><p>Access array elements like most other languages:</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#268bd2>let</span> arr <span style=color:#719e07>=</span> [<span style=color:#2aa198>1</span>, <span style=color:#2aa198>2</span>, <span style=color:#2aa198>3</span>];
</span></span><span style=display:flex><span><span style=color:#268bd2>let</span> b <span style=color:#719e07>=</span> arr[<span style=color:#2aa198>0</span>]; <span style=color:#586e75>// b = 1;
</span></span></span></code></pre></div><p>It's possible to access elements beyond the capacity. If the value is known when
compiling, the Rust compiler will give us an error:</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> arr2: [<span style=color:#719e07>&amp;</span><span style=color:#dc322f>str</span>; <span style=color:#2aa198>3</span>] <span style=color:#719e07>=</span> [<span style=color:#2aa198>&#34;one&#34;</span>, <span style=color:#2aa198>&#34;two&#34;</span>, <span style=color:#2aa198>&#34;three&#34;</span>];
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;arr2 = </span><span style=color:#2aa198>{:?}</span><span style=color:#2aa198>&#34;</span>, arr2);
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;arr2[3] = </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, arr2[<span style=color:#2aa198>3</span>]);
</span></span><span style=display:flex><span>                         <span style=color:#586e75>//  ^^^^^^^ index out of bounds: the length is 3 but the index is 3
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> c <span style=color:#719e07>=</span> <span style=color:#2aa198>1</span> <span style=color:#719e07>+</span> <span style=color:#2aa198>2</span>;
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;arr2[c] = </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, arr2[c]);
</span></span><span style=display:flex><span>                         <span style=color:#586e75>//  ^^^^^^^ index out of bounds: the length is 3 but the index is 3
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>}
</span></span></code></pre></div><p>However, we can provide a dynamic variable (e.g., get it from the user) and the
program will panic with an out of bounds access.</p><h2 id=string-literals>String Literals
<a class=header-link href=#string-literals><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>So I had this problem above, when you create something like this
<code>let a = "whatever";</code> you are creating a <code>string literal</code> or <code>&amp;str</code> which is a
read-only string and not the same as the type <code>String</code>.</p><p>So when I wanted to annotate the type for the same array like this, I got an
error:</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#268bd2>let</span> arr2: [<span style=color:#dc322f>str</span>, <span style=color:#2aa198>3</span>] <span style=color:#719e07>=</span> [<span style=color:#2aa198>&#34;one&#34;</span>, <span style=color:#2aa198>&#34;two&#34;</span>, <span style=color:#2aa198>&#34;three&#34;</span>];
</span></span><span style=display:flex><span>                      <span style=color:#719e07>^^^^^</span> expected `<span style=color:#dc322f>str</span>`, found `<span style=color:#719e07>&amp;</span><span style=color:#dc322f>str</span>`
</span></span></code></pre></div><p>So we have to annotate it like this with <code>&amp;str</code> but I had another problem
printing it:</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#268bd2>let</span> arr2: [<span style=color:#719e07>&amp;</span><span style=color:#dc322f>str</span>, <span style=color:#2aa198>3</span>] <span style=color:#719e07>=</span> [<span style=color:#2aa198>&#34;one&#34;</span>, <span style=color:#2aa198>&#34;two&#34;</span>, <span style=color:#2aa198>&#34;three&#34;</span>];
</span></span><span style=display:flex><span>println!(<span style=color:#2aa198>&#34;arr2 = </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, arr2);
</span></span><span style=display:flex><span>                      <span style=color:#719e07>^^^^</span> `[<span style=color:#719e07>&amp;</span><span style=color:#dc322f>str</span>; <span style=color:#2aa198>3</span>]` cannot be formatted with the default formatter
</span></span><span style=display:flex><span>  <span style=color:#719e07>=</span> help: <span style=color:#268bd2>the</span> <span style=color:#719e07>trait</span> `std::fmt::Display` is not implemented <span style=color:#719e07>for</span> `[<span style=color:#719e07>&amp;</span><span style=color:#dc322f>str</span>; <span style=color:#2aa198>3</span>]`
</span></span><span style=display:flex><span>  <span style=color:#719e07>=</span> note: <span style=color:#268bd2>in</span> format strings you may be able to <span style=color:#719e07>use</span> `{:<span style=color:#719e07>?</span>}` (or {:#<span style=color:#719e07>?</span>} <span style=color:#719e07>for</span> pretty<span style=color:#719e07>-</span>print) instead
</span></span></code></pre></div><p>We can use the note to pretty print:</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span>println!(<span style=color:#2aa198>&#34;arr2 = </span><span style=color:#2aa198>{:?}</span><span style=color:#2aa198>&#34;</span>, arr2);
</span></span><span style=display:flex><span><span style=color:#586e75>// arr2 = [&#34;one&#34;, &#34;two&#34;, &#34;three&#34;]
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>
</span></span><span style=display:flex><span>println!(<span style=color:#2aa198>&#34;arr2 = </span><span style=color:#2aa198>{:#?}</span><span style=color:#2aa198>&#34;</span>, arr2);
</span></span><span style=display:flex><span><span style=color:#586e75>// arr2 = [
</span></span></span><span style=display:flex><span><span style=color:#586e75>//     &#34;one&#34;,
</span></span></span><span style=display:flex><span><span style=color:#586e75>//     &#34;two&#34;,
</span></span></span><span style=display:flex><span><span style=color:#586e75>//     &#34;three&#34;,
</span></span></span><span style=display:flex><span><span style=color:#586e75>// ]
</span></span></span></code></pre></div><h2 id=functions>Functions
<a class=header-link href=#functions><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Similar to other languages.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    my_func(<span style=color:#2aa198>10</span>, <span style=color:#2aa198>&#39;a&#39;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75>// we can define parameters.
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#719e07>fn</span> <span style=color:#268bd2>my_func</span>(param1: <span style=color:#dc322f>i32</span>, param2: <span style=color:#dc322f>char</span>) {
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;param1 = </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>, param2 = </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, param1, param2);
</span></span><span style=display:flex><span>    <span style=color:#586e75>// param1 = 10, param2 = a
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>}
</span></span></code></pre></div><p>The last expression in the function can act as the return value.</p><blockquote><p>blocks of code evaluate to the last expression in them, and numbers by
themselves are also expressions</p></blockquote><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;double_me(1) = </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, double_me(<span style=color:#2aa198>1</span>)); <span style=color:#586e75>// double_me(1) = 2
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75>// return values
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#719e07>fn</span> <span style=color:#268bd2>double_me</span>(x: <span style=color:#dc322f>i32</span>) -&gt; <span style=color:#dc322f>i32</span> {
</span></span><span style=display:flex><span>    x <span style=color:#719e07>+</span> <span style=color:#2aa198>1</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>However, if we change it to <code>x + 1;</code> it becomes an statement and we get an
error.</p><pre tabindex=0><code>  |
6 | fn double_me(x: i32) -&gt; i32 {
  |    ---------            ^^^ expected `i32`, found `()`
  |    |
  |    implicitly returns `()` as its body has no tail or `return` expression
7 |     x + 1;
  |          - help: consider removing this semicolon
</code></pre><p>Instead, we can use the <code>return</code> keyword.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;double_me(1) = </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, double_me(<span style=color:#2aa198>1</span>));
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75>// return values
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#719e07>fn</span> <span style=color:#268bd2>double_me</span>(x: <span style=color:#dc322f>i32</span>) -&gt; <span style=color:#dc322f>i32</span> {
</span></span><span style=display:flex><span>    <span style=color:#719e07>return</span> x <span style=color:#719e07>+</span> <span style=color:#2aa198>1</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=if-else>if-else
<a class=header-link href=#if-else><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Similar to other languages.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> number <span style=color:#719e07>=</span> <span style=color:#2aa198>3</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#719e07>if</span> number <span style=color:#719e07>&lt;</span> <span style=color:#2aa198>5</span> {
</span></span><span style=display:flex><span>        println!(<span style=color:#2aa198>&#34;less than five&#34;</span>);
</span></span><span style=display:flex><span>    } <span style=color:#719e07>else</span> <span style=color:#719e07>if</span> number <span style=color:#719e07>==</span> <span style=color:#2aa198>5</span> {
</span></span><span style=display:flex><span>        println!(<span style=color:#2aa198>&#34;equals five&#34;</span>);
</span></span><span style=display:flex><span>    } <span style=color:#719e07>else</span> <span style=color:#719e07>if</span> number <span style=color:#719e07>&gt;</span> <span style=color:#2aa198>5</span> {
</span></span><span style=display:flex><span>        println!(<span style=color:#2aa198>&#34;more than five&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Doing unneeded parentheses around the condition returns a warning
(e.g., <code>if (number &lt; 5)</code>):</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span>  <span style=color:#719e07>|</span>
</span></span><span style=display:flex><span><span style=color:#2aa198>4</span> <span style=color:#719e07>|</span>     <span style=color:#719e07>if</span> (number <span style=color:#719e07>&lt;</span> <span style=color:#2aa198>5</span>) {
</span></span><span style=display:flex><span>  <span style=color:#719e07>|</span>        <span style=color:#719e07>^</span>          <span style=color:#719e07>^</span>
</span></span><span style=display:flex><span>  <span style=color:#719e07>|</span>
</span></span><span style=display:flex><span>  <span style=color:#719e07>=</span> note: `<span style=color:#719e07>#[warn(unused_parens)]</span>` on by default
</span></span><span style=display:flex><span>help: <span style=color:#268bd2>remove</span> these parentheses
</span></span><span style=display:flex><span>  <span style=color:#719e07>|</span>
</span></span><span style=display:flex><span><span style=color:#2aa198>4</span> <span style=color:#719e07>-</span>     <span style=color:#719e07>if</span> (number <span style=color:#719e07>&lt;</span> <span style=color:#2aa198>5</span>) {
</span></span><span style=display:flex><span><span style=color:#2aa198>4</span> <span style=color:#719e07>+</span>     <span style=color:#719e07>if</span> number <span style=color:#719e07>&lt;</span> <span style=color:#2aa198>5</span> {
</span></span><span style=display:flex><span>  <span style=color:#719e07>|</span> 
</span></span></code></pre></div><p>We can use <code>if</code> in a <code>let</code> statement:</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> condition <span style=color:#719e07>=</span> <span style=color:#cb4b16>true</span>;
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> number <span style=color:#719e07>=</span> <span style=color:#719e07>if</span> condition { <span style=color:#2aa198>5</span> } <span style=color:#719e07>else</span> { <span style=color:#2aa198>6</span> };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;The value of number is: </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, number);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=loop>loop
<a class=header-link href=#loop><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>We've already seen it. <code>loop</code> can use <code>break</code> and <code>continue</code> to leave to go back
to the start. When loops are nested, these only apply only to their parent loop.</p><p>We can also have <code>labeled loops</code> so we can interact with outer loops</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#586e75>// ch03/labeled_loop.rs
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> <span style=color:#719e07>mut</span> count <span style=color:#719e07>=</span> <span style=color:#2aa198>0</span>;
</span></span><span style=display:flex><span>    &#39;parent_loop: <span style=color:#268bd2>loop</span> {
</span></span><span style=display:flex><span>        println!(<span style=color:#2aa198>&#34;count = </span><span style=color:#2aa198>{}</span><span style=color:#2aa198> in &#39;parent_loop&#34;</span>, count);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#719e07>loop</span> {
</span></span><span style=display:flex><span>            println!(<span style=color:#2aa198>&#34;count = </span><span style=color:#2aa198>{}</span><span style=color:#2aa198> in inside loop&#34;</span>, count);
</span></span><span style=display:flex><span>            <span style=color:#719e07>if</span> count <span style=color:#719e07>==</span> <span style=color:#2aa198>2</span> {
</span></span><span style=display:flex><span>                <span style=color:#586e75>// break out of the &#39;parent_loop
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>                <span style=color:#719e07>break</span> &#39;parent_loop;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            count <span style=color:#719e07>+=</span> <span style=color:#2aa198>1</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;End count = </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, count);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75>// count = 0 in &#39;parent_loop
</span></span></span><span style=display:flex><span><span style=color:#586e75>// count = 0 in inside loop
</span></span></span><span style=display:flex><span><span style=color:#586e75>// count = 1 in inside loop
</span></span></span><span style=display:flex><span><span style=color:#586e75>// count = 2 in inside loop
</span></span></span><span style=display:flex><span><span style=color:#586e75>// End count = 2
</span></span></span></code></pre></div><p>We can also return values from loop (lol wut?). We can assign the loop to a
variable and then return <code>break value;</code>.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#586e75>// ch03/return_value_loop.rs
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> <span style=color:#719e07>mut</span> count <span style=color:#719e07>=</span> <span style=color:#2aa198>0</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> counted <span style=color:#719e07>=</span> <span style=color:#719e07>loop</span> {
</span></span><span style=display:flex><span>        count <span style=color:#719e07>+=</span> <span style=color:#2aa198>1</span>;
</span></span><span style=display:flex><span>        <span style=color:#719e07>if</span> count <span style=color:#719e07>==</span> <span style=color:#2aa198>5</span> {
</span></span><span style=display:flex><span>            <span style=color:#719e07>break</span> count;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;counted = </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, counted); <span style=color:#586e75>// counted = 5
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>}
</span></span></code></pre></div><h2 id=while>while
<a class=header-link href=#while><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p><code>loop</code>s don't have conditions. We can use <code>while</code> instead.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#586e75>// ch03/while.rs
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> <span style=color:#719e07>mut</span> count <span style=color:#719e07>=</span> <span style=color:#2aa198>0</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#719e07>while</span> count <span style=color:#719e07>!=</span> <span style=color:#2aa198>5</span> {
</span></span><span style=display:flex><span>        count <span style=color:#719e07>+=</span> <span style=color:#2aa198>1</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;count = </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, count); <span style=color:#586e75>// count = 5
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>}
</span></span></code></pre></div><h2 id=loop-through-collections-with-for>Loop Through Collections with for
<a class=header-link href=#loop-through-collections-with-for><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>We can iterate through a collection (e.g., array but not tuple) with <code>for</code>.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#586e75>// ch03/while.rs
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> strings <span style=color:#719e07>=</span> [<span style=color:#2aa198>&#34;one&#34;</span>, <span style=color:#2aa198>&#34;two&#34;</span>, <span style=color:#2aa198>&#34;three&#34;</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#719e07>for</span> s <span style=color:#719e07>in</span> strings {
</span></span><span style=display:flex><span>        println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, s);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Trying to use <code>for</code> with a tuple returns this error.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#268bd2>let</span> tup: (<span style=color:#dc322f>i32</span>, <span style=color:#dc322f>f64</span>, <span style=color:#dc322f>u8</span>) <span style=color:#719e07>=</span> (<span style=color:#2aa198>500</span>, <span style=color:#2aa198>6.4</span>, <span style=color:#2aa198>1</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>for</span> t <span style=color:#719e07>in</span> tup {
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, t);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#719e07>|</span>
</span></span><span style=display:flex><span><span style=color:#2aa198>10</span>  <span style=color:#719e07>|</span>     <span style=color:#719e07>for</span> t <span style=color:#719e07>in</span> tup {
</span></span><span style=display:flex><span>    <span style=color:#719e07>|</span>              <span style=color:#719e07>^^^</span> `(<span style=color:#dc322f>i32</span>, <span style=color:#dc322f>f64</span>, <span style=color:#dc322f>u8</span>)` is not an iterator
</span></span><span style=display:flex><span>    <span style=color:#719e07>|</span>
</span></span><span style=display:flex><span>    <span style=color:#719e07>=</span> help: <span style=color:#268bd2>the</span> <span style=color:#719e07>trait</span> `<span style=color:#b58900>Iterator</span>` is not implemented <span style=color:#719e07>for</span> `(<span style=color:#dc322f>i32</span>, <span style=color:#dc322f>f64</span>, <span style=color:#dc322f>u8</span>)`
</span></span><span style=display:flex><span>    <span style=color:#719e07>=</span> note: <span style=color:#268bd2>required</span> because of the requirements on the <span style=color:#719e07>impl</span> of `<span style=color:#b58900>IntoIterator</span>` <span style=color:#719e07>for</span> `(<span style=color:#dc322f>i32</span>, <span style=color:#dc322f>f64</span>, <span style=color:#dc322f>u8</span>)`
</span></span><span style=display:flex><span>note: <span style=color:#268bd2>required</span> by `into_iter`
</span></span></code></pre></div><p>The book says <code>for</code> is the most common way to use loops. We can use it to repeat
things a certain number of times by using it over a range.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#586e75>// rev is reversing the range.
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#719e07>for</span> number <span style=color:#719e07>in</span> (<span style=color:#2aa198>1</span><span style=color:#719e07>..</span><span style=color:#2aa198>4</span>).rev() {
</span></span><span style=display:flex><span>        println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{}</span><span style=color:#2aa198>!&#34;</span>, number);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;LIFTOFF!!!&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75>// 3!
</span></span></span><span style=display:flex><span><span style=color:#586e75>// 2!
</span></span></span><span style=display:flex><span><span style=color:#586e75>// 1!
</span></span></span><span style=display:flex><span><span style=color:#586e75>// LIFTOFF!!!
</span></span></span></code></pre></div><h1 id=chapter-4>Chapter 4
<a class=header-link href=#chapter-4><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><p>Stack: LIFO. Data on stack must have a known and fixed size. Faster.</p><p>Heap: Data with unknown size at compile time or a size that might change. You
ask for a certain amount of space on heap, the memory allocator locates some
free space and returns a pointer to it (and sets it in-use). Slower.</p><h2 id=ownership-rules>Ownership Rules
<a class=header-link href=#ownership-rules><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><ul><li>Each value in Rust has a variable that’s called its <em>owner</em>.</li><li>There can only be one owner at a time.</li><li>When the owner goes out of scope, the value will be dropped.</li></ul><h2 id=the-string-type>The String Type
<a class=header-link href=#the-string-type><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>String literals are immutable (type <code>&amp;str</code>). See the section <code>String Literals</code>
above for more info.</p><p>We can use <code>String</code> which exists on the heap. We can create them from a string
literal and modify it.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> <span style=color:#719e07>mut</span> s <span style=color:#719e07>=</span> <span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;hello&#34;</span>);
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#586e75>// append something to it with push_str
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    s.push_str(<span style=color:#2aa198>&#34;, world!&#34;</span>);
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#586e75>// we cannot do this because it&#39;s not a string literal.
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#586e75>// println!(s); // Compiler error
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>
</span></span><span style=display:flex><span>    <span style=color:#586e75>// print it
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, s); <span style=color:#586e75>// hello, world!
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>}
</span></span></code></pre></div><h2 id=move>Move
<a class=header-link href=#move><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>When the value leaves the scope, Rust automatically calls <code>drop</code> at the closing
curly braces. A String has three parts:</p><ol><li>ptr: Pointer to the memory with the values.</li><li>len: Number of bytes used by the String.</li><li>cap: Total number of bytes of memory assigned to the String by the allocator.</li></ol><p>Let's create a String and then assign it to another variable like this:</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#268bd2>let</span> s1 <span style=color:#719e07>=</span> <span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;hello&#34;</span>);
</span></span><span style=display:flex><span><span style=color:#268bd2>let</span> s2 <span style=color:#719e07>=</span> s1;
</span></span></code></pre></div><p>The <code>ptr</code> in both s1 and s2 will point to the same location on the heap with the
value of the string. The value is not copied for s2.</p><p>When both s1 and s2 go out of scope we might have gotten a double-free bug
because both wanted to free the memory. To prevent this issue, Rust makes s1
invalid as soon as the assignment happens (<code>let s2 = s1;</code>). We cannot use s1
after that.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#586e75>// create a String.
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#268bd2>let</span> s1 <span style=color:#719e07>=</span> <span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;hello&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#586e75>// assign it to s2
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#268bd2>let</span> s2 <span style=color:#719e07>=</span> s1;
</span></span><span style=display:flex><span>    <span style=color:#586e75>// try to use s1.
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, s1);
</span></span><span style=display:flex><span>    <span style=color:#586e75>// use s2 so we don&#39;t get an &#34;unused variable warning&#34;
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, s2);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>And we get an error because s1 was moved.</p><pre tabindex=0><code>error[E0382]: borrow of moved value: `s1`
 --&gt; src/main.rs:7:20
  |
3 |     let s1 = String::from(&#34;hello&#34;);
  |         -- move occurs because `s1` has type `String`, which does not implement the `Copy` trait
4 |     // assign it to s2
5 |     let s2 = s1;
  |              -- value moved here
6 |     // try to use s1.
7 |     println!(&#34;{}&#34;, s1);
  |                    ^^ value borrowed here after move
</code></pre><h2 id=clone>Clone
<a class=header-link href=#clone><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>But what if we want to make a copy? We use <code>clone</code>.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#586e75>// create a String.
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#268bd2>let</span> s1 <span style=color:#719e07>=</span> <span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;hello&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#586e75>// clone it
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#268bd2>let</span> s2 <span style=color:#719e07>=</span> s1.clone();
</span></span><span style=display:flex><span>    <span style=color:#586e75>// try to use s1
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, s1); <span style=color:#586e75>// hello
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#586e75>// use s2 so we don&#39;t get an &#34;unused variable warning&#34;
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, s2); <span style=color:#586e75>// hello
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>}
</span></span></code></pre></div><h2 id=copy>Copy
<a class=header-link href=#copy><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>But we have seen assignments in other types and both work.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> x <span style=color:#719e07>=</span> <span style=color:#2aa198>5</span>;
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> y <span style=color:#719e07>=</span> x;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#586e75>// we can use both x and y.
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    println!(<span style=color:#2aa198>&#34;x = </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>, y = </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, x, y); <span style=color:#586e75>// x = 5, y = 5
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>}
</span></span></code></pre></div><p>These types have a known size at compile time and are stored on the stack. So
assignment here creates a new copy of the entire object on the stack.</p><p>If a type has the <code>Copy</code> trait, this behavior occurs: Integers, floats, chars,
bools, and Tuples if the types in it have all implemented the <code>Copy</code> trait.</p><h2 id=ownership-and-functions>Ownership and Functions
<a class=header-link href=#ownership-and-functions><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Passing a value to a function will move or copy a value like an assignment.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#586e75>// ch04/func_string.rs
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#586e75>// create a string
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#268bd2>let</span> s <span style=color:#719e07>=</span> <span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;hello&#34;</span>); 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#586e75>// pass it to a function
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    use_string(s);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#586e75>// we cannot use s here anymore because it was moved to `some_string` and
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#586e75>// it went out of scope when `use_string` returned.
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, s);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>use_string</span>(some_string: <span style=color:#b58900>String</span>) {
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, some_string);
</span></span><span style=display:flex><span>    <span style=color:#586e75>// some_string goes out of scope. drop is called. Memory is freed.
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>}
</span></span></code></pre></div><p>We get an error because <code>s</code> was moved when passed to the function.</p><pre tabindex=0><code>error[E0382]: borrow of moved value: `s`
  --&gt; src/main.rs:10:20
   |
3  |     let s = String::from(&#34;hello&#34;); 
   |         - move occurs because `s` has type `String`, which does not implement the `Copy` trait
...
6  |     use_string(s);
   |                - value moved here
...
10 |     println!(&#34;{}&#34;, s);
   |                    ^ value borrowed here after move
</code></pre><p>But we won't have this issue if the type implements the <code>Copy</code> trait (e.g., int).</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#586e75>// ch04/func_int.rs
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#586e75>// create an int
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#268bd2>let</span> x <span style=color:#719e07>=</span> <span style=color:#2aa198>5</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#586e75>// x does not move because i32 implements `Copy`.
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    use_int(x); <span style=color:#586e75>// 5
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>                
</span></span><span style=display:flex><span>    <span style=color:#586e75>// we can still use x here.
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, x);  <span style=color:#586e75>// 5
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>use_int</span>(some_integer: <span style=color:#dc322f>i32</span>) {
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, some_integer);
</span></span><span style=display:flex><span>} <span style=color:#586e75>// some_integer goes out of scope. Nothing special happens.
</span></span></span></code></pre></div><p>Same thing happens with returns. If we pass a String to a function, we need to
return it from the function to be able to use it later.</p><h2 id=references>References
<a class=header-link href=#references><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>To avoid this whole mess of moving when passing variables to function we can use
references. A reference refers to the variable but does not own it. So when we
pass a reference to the function there will be no moves.</p><p><code>We call the action of creating a reference borrowing.</code></p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#586e75>// create a string
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#268bd2>let</span> s1 <span style=color:#719e07>=</span> <span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;hello&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#586e75>// pass it as a reference to calculate_length
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#268bd2>let</span> len <span style=color:#719e07>=</span> calculate_length(<span style=color:#719e07>&amp;</span>s1);
</span></span><span style=display:flex><span>    <span style=color:#586e75>// we can still use s1 here.
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    println!(<span style=color:#2aa198>&#34;The length of &#39;</span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#39; is </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>.&#34;</span>, s1, len);
</span></span><span style=display:flex><span>    <span style=color:#586e75>// The length of &#39;hello&#39; is 5.
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75>// note the annotation here, the param type is &amp;String
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#719e07>fn</span> <span style=color:#268bd2>calculate_length</span>(s: <span style=color:#719e07>&amp;</span><span style=color:#b58900>String</span>) -&gt; <span style=color:#dc322f>usize</span> {
</span></span><span style=display:flex><span>    <span style=color:#719e07>return</span> s.len();
</span></span><span style=display:flex><span>    <span style=color:#586e75>// `s.len()` would do the same
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>}
</span></span></code></pre></div><p>When <code>s</code> goes out of scope at the end of the function, the value for <code>s1</code> is not
dropped because <code>s</code> does not own it.</p><p>We cannot modify <code>s</code> inside.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#586e75>// create a string
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#268bd2>let</span> s1 <span style=color:#719e07>=</span> <span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;hello&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#586e75>// pass it as a reference
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    modify_s(<span style=color:#719e07>&amp;</span>s1);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>modify_s</span>(s: <span style=color:#719e07>&amp;</span><span style=color:#b58900>String</span>) {
</span></span><span style=display:flex><span>    s.push_str(<span style=color:#2aa198>&#34; yolo!&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>We get an error.</p><pre tabindex=0><code>error[E0596]: cannot borrow `*s` as mutable, as it is behind a `&amp;` reference
 --&gt; src/main.rs:9:5
  |
8 | fn modify_s(s: &amp;String) {
  |                ------- help: consider changing this to be a mutable reference: `&amp;mut String`
9 |     s.push_str(&#34; yolo!&#34;);
  |     ^^^^^^^^^^^^^^^^^^^^ `s` is a `&amp;` reference, so the data it refers to cannot be borrowed as mutable
</code></pre><p>Let's use the suggestion and pass a mutable reference to the function.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#586e75>// create a string
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#268bd2>let</span> s1 <span style=color:#719e07>=</span> <span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;hello&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#586e75>// pass it as a reference
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    modify_mut_s(<span style=color:#719e07>&amp;</span><span style=color:#719e07>mut</span> s1);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>modify_mut_s</span>(s: <span style=color:#719e07>&amp;</span><span style=color:#268bd2>mut</span> <span style=color:#b58900>String</span>) {
</span></span><span style=display:flex><span>    s.push_str(<span style=color:#2aa198>&#34; yolo!&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>We get another error because <code>s1</code> is not mutable we cannot borrow it as mutable.</p><pre tabindex=0><code>error[E0596]: cannot borrow `s1` as mutable, as it is not declared as mutable
 --&gt; src/main.rs:5:18
  |
3 |     let s1 = String::from(&#34;hello&#34;);
  |         -- help: consider changing this to be mutable: `mut s1`
4 |     // pass it as a reference
5 |     modify_mut_s(&amp;mut s1);
  |                  ^^^^^^^ cannot borrow as mutable
</code></pre><p>Let's make <code>s1</code> mutable, too.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#586e75>// create a mutable string
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#268bd2>let</span> <span style=color:#719e07>mut</span> s1 <span style=color:#719e07>=</span> <span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;hello&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#586e75>// pass it as a mutable reference
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    modify_mut_s(<span style=color:#719e07>&amp;</span><span style=color:#719e07>mut</span> s1);
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, s1); <span style=color:#586e75>// hello yolo!
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>modify_mut_s</span>(s: <span style=color:#719e07>&amp;</span><span style=color:#268bd2>mut</span> <span style=color:#b58900>String</span>) {
</span></span><span style=display:flex><span>    s.push_str(<span style=color:#2aa198>&#34; yolo!&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>And this works! Remember that although <code>s1</code> is mutable, we could have borrowed
it as immutable.</p><h2 id=mutable-references>Mutable References
<a class=header-link href=#mutable-references><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>We can only have one mutable reference to a value at a time. This code won't
work:</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#586e75>// create a mutable string
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#268bd2>let</span> <span style=color:#719e07>mut</span> s1 <span style=color:#719e07>=</span> <span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;hello&#34;</span>);
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> r1 <span style=color:#719e07>=</span> <span style=color:#719e07>&amp;</span><span style=color:#719e07>mut</span> s1;
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> r2 <span style=color:#719e07>=</span> <span style=color:#719e07>&amp;</span><span style=color:#719e07>mut</span> s1;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{}</span><span style=color:#2aa198>, </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, r1, r2);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>We get this error:</p><pre tabindex=0><code>error[E0499]: cannot borrow `s1` as mutable more than once at a time
 --&gt; src/main.rs:6:14
  |
5 |     let r1 = &amp;mut s1;
  |              ------- first mutable borrow occurs here
6 |     let r2 = &amp;mut s1;
  |              ^^^^^^^ second mutable borrow occurs here
7 | 
8 |     println!(&#34;{}, {}&#34;, r1, r2);
  |                        -- first borrow later used here
</code></pre><p>This supposedly helps with data races.</p><p>We cannot also have mutable and immutable borrows at the same time.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> <span style=color:#719e07>mut</span> s <span style=color:#719e07>=</span> <span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;hello&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> r1 <span style=color:#719e07>=</span> <span style=color:#719e07>&amp;</span>s; <span style=color:#586e75>// no problem
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#268bd2>let</span> r2 <span style=color:#719e07>=</span> <span style=color:#719e07>&amp;</span>s; <span style=color:#586e75>// no problem
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#268bd2>let</span> r3 <span style=color:#719e07>=</span> <span style=color:#719e07>&amp;</span><span style=color:#719e07>mut</span> s; <span style=color:#586e75>// BIG PROBLEM
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{}</span><span style=color:#2aa198>, </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>, and </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, r1, r2, r3);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Because we have an immutable reference in the same scope. Multiple immutable
references are allowed.</p><pre tabindex=0><code>error[E0502]: cannot borrow `s` as mutable because it is also borrowed as immutable
 --&gt; src/main.rs:6:14
  |
4 |     let r1 = &amp;s; // no problem
  |              -- immutable borrow occurs here
5 |     let r2 = &amp;s; // no problem
6 |     let r3 = &amp;mut s; // BIG PROBLEM
  |              ^^^^^^ mutable borrow occurs here
7 | 
8 |     println!(&#34;{}, {}, and {}&#34;, r1, r2, r3);
  |                                -- immutable borrow later used here
</code></pre><h2 id=reference-scope>Reference Scope
<a class=header-link href=#reference-scope><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>The scope of a reference starts from where it's introduced until the last time
it is used even though the block has not finished. It's a bit different from
variable references. E.g., this will work because r1 and r2 are not used after
r3 is created.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> <span style=color:#719e07>mut</span> s <span style=color:#719e07>=</span> <span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;hello&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> r1 <span style=color:#719e07>=</span> <span style=color:#719e07>&amp;</span>s; <span style=color:#586e75>// no problem
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#268bd2>let</span> r2 <span style=color:#719e07>=</span> <span style=color:#719e07>&amp;</span>s; <span style=color:#586e75>// no problem
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{}</span><span style=color:#2aa198> and </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, r1, r2);
</span></span><span style=display:flex><span>    <span style=color:#586e75>// variables r1 and r2 will not be used after this point
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> r3 <span style=color:#719e07>=</span> <span style=color:#719e07>&amp;</span><span style=color:#719e07>mut</span> s; <span style=color:#586e75>// no problem
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, r3);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=dangling-reference>Dangling Reference
<a class=header-link href=#dangling-reference><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>The compiler does not allow us to create dangling references. This won't work:</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> reference_to_nothing <span style=color:#719e07>=</span> dangle();
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>dangle</span>() -&gt; <span style=color:#719e07>&amp;</span><span style=color:#b58900>String</span> {
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> s <span style=color:#719e07>=</span> <span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;hello&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#719e07>&amp;</span>s
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><code>dangle</code> creates s and wants to return a reference to it. However, after dangle
returns, s goes out of scope and is deallocated. Hence, a dangling reference.
The compiler returns an error. Instead, we can return the <code>s</code>.</p><pre tabindex=0><code>this function&#39;s return type contains a borrowed value, but there is no value for
it to be borrowed from help: consider using the `&#39;static` lifetime
</code></pre><h2 id=the-slice-type>The Slice Type
<a class=header-link href=#the-slice-type><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Similar to slice in Go? You can reference a sequence in a collection without
ownership.</p><p>Small function to find the index of the first word in a string.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>first_word</span>(s: <span style=color:#719e07>&amp;</span><span style=color:#b58900>String</span>) -&gt; <span style=color:#dc322f>usize</span> {
</span></span><span style=display:flex><span>    <span style=color:#586e75>// converts the string to an array of bytes
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#268bd2>let</span> bytes <span style=color:#719e07>=</span> s.as_bytes();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#586e75>// bytes.iter.enumerate() returns a tuple. The index and a reference to the item
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#586e75>// here we are destructuring the tuple
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#719e07>for</span> (i, <span style=color:#719e07>&amp;</span>item) <span style=color:#719e07>in</span> bytes.iter().enumerate() {
</span></span><span style=display:flex><span>        <span style=color:#586e75>// compare the character with space
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>        <span style=color:#719e07>if</span> item <span style=color:#719e07>==</span> <span style=color:#2aa198>b</span><span style=color:#2aa198>&#39; &#39;</span> {
</span></span><span style=display:flex><span>            <span style=color:#719e07>return</span> i;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#586e75>// if there&#39;s no space in the string, all of it is the word
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    s.len()
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>However, this is not useful because it's an index to a string that might have
been modified since then. Instead, we can return a String slice with the words.</p><h2 id=string-slice>String Slice
<a class=header-link href=#string-slice><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Create it like this. Note the second index is exclusive. E.g., <code>[0..5]</code> starts
from index 0 and ends at 4.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> s <span style=color:#719e07>=</span> <span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;hello world&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> hello <span style=color:#719e07>=</span> <span style=color:#719e07>&amp;</span>s[<span style=color:#2aa198>0</span><span style=color:#719e07>..</span><span style=color:#2aa198>5</span>];
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> world <span style=color:#719e07>=</span> <span style=color:#719e07>&amp;</span>s[<span style=color:#2aa198>6</span><span style=color:#719e07>..</span><span style=color:#2aa198>11</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{}</span><span style=color:#2aa198> - </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, hello, world);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>We can drop the lower range if we want to start from the beginning. So <code>[0..5]</code>
and <code>[..5]</code> are the same.</p><p>If the higher range is the end we can drop it. E.g., <code>[4..]</code> goes from index 4
to the end.</p><p><code>[..]</code> creates a slice from the whole string. <code>let slice = &amp;s[..]</code>. Now, we can
rewrite the function to return a slice.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>first_word</span>(s: <span style=color:#719e07>&amp;</span><span style=color:#b58900>String</span>) -&gt; <span style=color:#719e07>&amp;</span><span style=color:#dc322f>str</span> {
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> bytes <span style=color:#719e07>=</span> s.as_bytes();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#719e07>for</span> (i, <span style=color:#719e07>&amp;</span>item) <span style=color:#719e07>in</span> bytes.iter().enumerate() {
</span></span><span style=display:flex><span>        <span style=color:#719e07>if</span> item <span style=color:#719e07>==</span> <span style=color:#2aa198>b</span><span style=color:#2aa198>&#39; &#39;</span> {
</span></span><span style=display:flex><span>            <span style=color:#719e07>return</span> <span style=color:#719e07>&amp;</span>s[<span style=color:#2aa198>0</span><span style=color:#719e07>..</span>i];
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#719e07>&amp;</span>s[<span style=color:#719e07>..</span>]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>String literals are slices.</strong> Remember what we saw in the string literal
section? Their type is <code>&amp;str</code>.</p><h2 id=other-slices>Other Slices
<a class=header-link href=#other-slices><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>We can create slices of other types.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> a <span style=color:#719e07>=</span> [<span style=color:#2aa198>1</span>, <span style=color:#2aa198>2</span>, <span style=color:#2aa198>3</span>, <span style=color:#2aa198>4</span>, <span style=color:#2aa198>5</span>];
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> slice <span style=color:#719e07>=</span> <span style=color:#719e07>&amp;</span>a[<span style=color:#2aa198>1</span><span style=color:#719e07>..</span><span style=color:#2aa198>3</span>];
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{:?}</span><span style=color:#2aa198>&#34;</span>, slice);    <span style=color:#586e75>// [2, 3]
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>}
</span></span></code></pre></div><h1 id=chapter-5>Chapter 5
<a class=header-link href=#chapter-5><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><h2 id=structs>Structs
<a class=header-link href=#structs><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Similar to other programming languages.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#586e75>// ch05/basic_struct.rs
</span></span></span><span style=display:flex><span><span style=color:#586e75>// define a struct
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#719e07>struct</span> <span style=color:#268bd2>Game</span> {
</span></span><span style=display:flex><span>        name: <span style=color:#b58900>String</span>,
</span></span><span style=display:flex><span>        hours_played: <span style=color:#dc322f>u32</span>,
</span></span><span style=display:flex><span>        path: <span style=color:#b58900>String</span>,
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#586e75>// create a mutable object
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#268bd2>let</span> <span style=color:#719e07>mut</span> game1 <span style=color:#719e07>=</span> Game {
</span></span><span style=display:flex><span>        name: <span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;Windows Calculator&#34;</span>),
</span></span><span style=display:flex><span>        hours_played: <span style=color:#2aa198>123</span>,
</span></span><span style=display:flex><span>        path: <span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;C:/Windows/System32/calc.exe&#34;</span>),
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#586e75>// access fields
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{}</span><span style=color:#2aa198>, </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>, </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, game1.name, game1.hours_played, game1.path);
</span></span><span style=display:flex><span>    <span style=color:#586e75>// Windows Calculator, 123, C:/Windows/System32/calc.exe
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    
</span></span><span style=display:flex><span>    <span style=color:#586e75>// change fields
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    game1.path <span style=color:#719e07>=</span> <span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;C:</span><span style=color:#cb4b16>\\</span><span style=color:#2aa198>Windows</span><span style=color:#cb4b16>\\</span><span style=color:#2aa198>System32</span><span style=color:#cb4b16>\\</span><span style=color:#2aa198>calc.exe&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#586e75>// print the modified field
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, game1.path);
</span></span><span style=display:flex><span>    <span style=color:#586e75>// C:\Windows\System32\calc.exe
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>}
</span></span></code></pre></div><p>We cannot set specific fields to mutable. Whole object needs to be mutable or
not.</p><h2 id=field-init-shorthand>Field Init Shorthand
<a class=header-link href=#field-init-shorthand><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Let's say we have this function to create a new <code>Game</code> object.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>build_game</span>(name: <span style=color:#b58900>String</span>, hours_played: <span style=color:#dc322f>u32</span>, path: <span style=color:#b58900>String</span>) -&gt; <span style=color:#268bd2>Game</span> {
</span></span><span style=display:flex><span>    Game {
</span></span><span style=display:flex><span>        name: <span style=color:#268bd2>name</span>,
</span></span><span style=display:flex><span>        hours_played: <span style=color:#268bd2>hours_played</span>,
</span></span><span style=display:flex><span>        path: <span style=color:#268bd2>path</span>,
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#586e75>// apparently using the return keyword is _bad_.
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>}
</span></span></code></pre></div><p>If the name of the field and the variable with the value is the same like the
above we can do a shorthand like this.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#586e75>// complete example in ch05/field_init_shorthand.rs
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#719e07>fn</span> <span style=color:#268bd2>build_game</span>(name: <span style=color:#b58900>String</span>, hours_played: <span style=color:#dc322f>u32</span>, path: <span style=color:#b58900>String</span>) -&gt; <span style=color:#268bd2>Game</span> {
</span></span><span style=display:flex><span>    Game {
</span></span><span style=display:flex><span>        name,
</span></span><span style=display:flex><span>        hours_played,
</span></span><span style=display:flex><span>        path,
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=struct-update-syntax>Struct Update Syntax
<a class=header-link href=#struct-update-syntax><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>We can create a new object with the values from a previous object and only
modify some.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#586e75>// complete example in ch05/struct_update.rs
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>
</span></span><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#586e75>// create a game object
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#268bd2>let</span> game1 <span style=color:#719e07>=</span> Game {
</span></span><span style=display:flex><span>        name: <span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;Windows Calculator&#34;</span>),
</span></span><span style=display:flex><span>        hours_played: <span style=color:#2aa198>123</span>,
</span></span><span style=display:flex><span>        path: <span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;C:/Windows/System32/calc.exe&#34;</span>),
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#586e75>// create game2 based on game1 with a new path
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#268bd2>let</span> game2 <span style=color:#719e07>=</span> Game {
</span></span><span style=display:flex><span>        path: <span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;C:</span><span style=color:#cb4b16>\\</span><span style=color:#2aa198>Windows</span><span style=color:#cb4b16>\\</span><span style=color:#2aa198>System32</span><span style=color:#cb4b16>\\</span><span style=color:#2aa198>calc.exe&#34;</span>),
</span></span><span style=display:flex><span>        <span style=color:#719e07>..</span>game1
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#586e75>// access fields
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{}</span><span style=color:#2aa198>, </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>, </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, game2.name, game2.hours_played, game2.path);
</span></span><span style=display:flex><span>    <span style=color:#586e75>// Windows Calculator, 123, C:\Windows\System32\calc.exe
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>}
</span></span></code></pre></div><p><strong>However, we moved game1 so we cannot use it anymore.</strong> Because we used the
value of <code>String</code> for the <code>name</code> field. If we had only copied the fixed-length
values of <code>game1</code> then we would have been able to use it. Here's an example to
show that.</p><p>Note how <code>print_game</code> accepts a reference, if we had passed the
actual object it would have been moved after calling the function and we could
not have used it anymore.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#586e75>// ch05/struct_update_move.rs
</span></span></span><span style=display:flex><span><span style=color:#586e75>// define a struct
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#719e07>struct</span> <span style=color:#268bd2>Game</span> {
</span></span><span style=display:flex><span>    name: <span style=color:#b58900>String</span>,
</span></span><span style=display:flex><span>    hours_played: <span style=color:#dc322f>u32</span>,
</span></span><span style=display:flex><span>    path: <span style=color:#b58900>String</span>,
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>print_game</span>(game: <span style=color:#719e07>&amp;</span><span style=color:#268bd2>Game</span>) {
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{}</span><span style=color:#2aa198>, </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>, </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, game.name, game.hours_played, game.path);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#586e75>// create a game object
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#268bd2>let</span> game1 <span style=color:#719e07>=</span> Game {
</span></span><span style=display:flex><span>        name: <span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;Windows Calculator&#34;</span>),
</span></span><span style=display:flex><span>        hours_played: <span style=color:#2aa198>123</span>,
</span></span><span style=display:flex><span>        path: <span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;C:/Windows/System32/calc.exe&#34;</span>),
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#586e75>// create game1_new based on game1 but only reuse hours_played which is the
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#586e75>// only fixed-length field
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#268bd2>let</span> game1_new <span style=color:#719e07>=</span> Game {
</span></span><span style=display:flex><span>        name: <span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;Guild Wars&#34;</span>),
</span></span><span style=display:flex><span>        path: <span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;C:/Guild Wars/gw.exe&#34;</span>),
</span></span><span style=display:flex><span>        <span style=color:#719e07>..</span>game1
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#586e75>// we can still use game1 here because we did not &#34;move&#34; any of the Strings
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#586e75>// create game2 based on game1 with a new path
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    print_game(<span style=color:#719e07>&amp;</span>game1);
</span></span><span style=display:flex><span>    <span style=color:#586e75>// Windows Calculator, 123, C:/Windows/System32/calc.exe
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    
</span></span><span style=display:flex><span>    print_game(<span style=color:#719e07>&amp;</span>game1_new);
</span></span><span style=display:flex><span>    <span style=color:#586e75>// Guild Wars, 123, C:/Guild Wars/gw.exe
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    
</span></span><span style=display:flex><span>    <span style=color:#586e75>// create game2_new but reuse the Strings so they are &#34;moved&#34;
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#268bd2>let</span> game1_new_new <span style=color:#719e07>=</span> Game {
</span></span><span style=display:flex><span>        hours_played: <span style=color:#2aa198>6000</span>,
</span></span><span style=display:flex><span>        <span style=color:#719e07>..</span>game1
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#586e75>// we cannot use game1 anymore.
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    print_game(<span style=color:#719e07>&amp;</span>game1);  <span style=color:#586e75>// &lt;-- error here
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    print_game(<span style=color:#719e07>&amp;</span>game1_new_new);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>We get an error in the last <code>print_game(&amp;game1)</code> because <code>game1</code> was partially
moved when creating <code>game1_new_new</code>.</p><pre tabindex=0><code>error[E0382]: borrow of partially moved value: `game1`
  --&gt; src/main.rs:44:16
   |
38 |       let game1_new_new = Game {
   |  _________________________-
39 | |         hours_played: 6000,
40 | |         ..game1
41 | |     };
   | |_____- value partially moved here
...
44 |       print_game(&amp;game1);  // &lt;-- error here
   |                  ^^^^^^ value borrowed here after partial move
   |
   = note: partial move occurs because `game1.path` has type `String`, which does not implement the `Copy` trait
</code></pre><h2 id=tuple-structs>Tuple Structs
<a class=header-link href=#tuple-structs><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Think of them as structs but without field names. We can access the fields by
index (see in <code>print_game</code>).</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#586e75>// ch05/tuple_struct.rs
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>
</span></span><span style=display:flex><span><span style=color:#586e75>// define two tuple structs
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#719e07>struct</span> <span style=color:#268bd2>Game</span>(<span style=color:#b58900>String</span>, <span style=color:#dc322f>u32</span>, <span style=color:#b58900>String</span>);
</span></span><span style=display:flex><span><span style=color:#719e07>struct</span> <span style=color:#268bd2>App</span>(<span style=color:#b58900>String</span>, <span style=color:#dc322f>u32</span>, <span style=color:#b58900>String</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>print_game</span>(game: <span style=color:#719e07>&amp;</span><span style=color:#268bd2>Game</span>) {
</span></span><span style=display:flex><span>    <span style=color:#586e75>// we can access the tuple struct&#39;s fields with the index
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{}</span><span style=color:#2aa198>, </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>, </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, game.<span style=color:#2aa198>0</span>, game.<span style=color:#2aa198>1</span>, game.<span style=color:#2aa198>2</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> game1 <span style=color:#719e07>=</span> Game(
</span></span><span style=display:flex><span>        <span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;Guild Wars&#34;</span>),
</span></span><span style=display:flex><span>        <span style=color:#2aa198>5000</span>,
</span></span><span style=display:flex><span>        <span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;C:/Guild Wars/gw.exe&#34;</span>)
</span></span><span style=display:flex><span>    );
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    print_game(<span style=color:#719e07>&amp;</span>game1);
</span></span><span style=display:flex><span>    <span style=color:#586e75>// Guild Wars, 5000, C:/Guild Wars/gw.exe
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> app1 <span style=color:#719e07>=</span> App(
</span></span><span style=display:flex><span>        <span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;Windows Calculator&#34;</span>),
</span></span><span style=display:flex><span>        <span style=color:#2aa198>123</span>,
</span></span><span style=display:flex><span>        <span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;C:/Windows/System32/Calc.exe&#34;</span>)
</span></span><span style=display:flex><span>    );
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#586e75>// we cannot call print_game with &amp;App because they are different structs
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#586e75>// although they have the same fields
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    print_game(<span style=color:#719e07>&amp;</span>app1);  <span style=color:#586e75>// &lt;-- error &#39;expected struct `Game`, found struct `App`&#39;
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>}
</span></span></code></pre></div><p><code>Game</code> and <code>App</code> are different structs although they have similar fields.</p><h2 id=unit-like-structs>Unit-Like Structs
<a class=header-link href=#unit-like-structs><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>They don't have any fields.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>struct</span> <span style=color:#268bd2>Whatever</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#268bd2>let</span> wt <span style=color:#719e07>=</span> Whatever;
</span></span></code></pre></div><h2 id=derived-traits>Derived Traits
<a class=header-link href=#derived-traits><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>We cannot use <code>println!</code> to print the <code>Game</code> struct.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>struct</span> <span style=color:#268bd2>Game</span> {
</span></span><span style=display:flex><span>    name: <span style=color:#b58900>String</span>,
</span></span><span style=display:flex><span>    hours_played: <span style=color:#dc322f>u32</span>,
</span></span><span style=display:flex><span>    path: <span style=color:#b58900>String</span>,
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> game1 <span style=color:#719e07>=</span> Game {
</span></span><span style=display:flex><span>        name: <span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;Guild Wars&#34;</span>),
</span></span><span style=display:flex><span>        hours_played: <span style=color:#2aa198>5000</span>,
</span></span><span style=display:flex><span>        path: <span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;C:/Guild Wars/gw.exe&#34;</span>)
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, game1);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>We get an error in <code>println!</code> because it does not implement the
<code>std::fmt::Display</code> trait.</p><pre tabindex=0><code>error[E0277]: `Game` doesn&#39;t implement `std::fmt::Display`
  --&gt; src/main.rs:15:20
   |
15 |     println!(&#34;{}&#34;, game1);
   |                    ^^^^^ `Game` cannot be formatted with the default formatter
   |
   = help: the trait `std::fmt::Display` is not implemented for `Game`
   = note: in format strings you may be able to use `{:?}` (or {:#?} for pretty-print) instead
</code></pre><p>The error tells us we can use <code>println!("{:?}", game1);</code> which results in
another error:</p><pre tabindex=0><code>error[E0277]: `Game` doesn&#39;t implement `Debug`
  --&gt; src/main.rs:15:22
   |
15 |     println!(&#34;{:?}&#34;, game1);
   |                      ^^^^^ `Game` cannot be formatted using `{:?}`
   |
   = help: the trait `Debug` is not implemented for `Game`
   = note: add `#[derive(Debug)]` to `Game` or manually `impl Debug for Game`
   = note: this error originates in the macro `$crate::format_args_nl` (in Nightly builds, run with -Z macro-backtrace for more info)
</code></pre><p>Let's add <code>#[derive(Debug)]</code> to <code>Game</code>.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>#[derive(Debug)]</span>
</span></span><span style=display:flex><span><span style=color:#719e07>struct</span> <span style=color:#268bd2>Game</span> {
</span></span><span style=display:flex><span>    name: <span style=color:#b58900>String</span>,
</span></span><span style=display:flex><span>    hours_played: <span style=color:#dc322f>u32</span>,
</span></span><span style=display:flex><span>    path: <span style=color:#b58900>String</span>,
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> game1 <span style=color:#719e07>=</span> Game {
</span></span><span style=display:flex><span>        name: <span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;Guild Wars&#34;</span>),
</span></span><span style=display:flex><span>        hours_played: <span style=color:#2aa198>5000</span>,
</span></span><span style=display:flex><span>        path: <span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;C:/Guild Wars/gw.exe&#34;</span>)
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{:?}</span><span style=color:#2aa198>&#34;</span>, game1);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Finally:
<code>Game { name: "Guild Wars", hours_played: 5000, path: "C:/Guild Wars/gw.exe" }</code>.</p><h2 id=the-dbg-macro>The dbg Macro
<a class=header-link href=#the-dbg-macro><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>We can use the <code>dbg!</code> macro to print to <code>stderr</code> (<code>println!</code> prints to
<code>stdout</code>). It prints info about the parameter and returns their ownership. We
can also pass references to it.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>#[derive(Debug)]</span>
</span></span><span style=display:flex><span><span style=color:#719e07>struct</span> <span style=color:#268bd2>Game</span> {
</span></span><span style=display:flex><span>    name: <span style=color:#b58900>String</span>,
</span></span><span style=display:flex><span>    hours_played: <span style=color:#dc322f>u32</span>,
</span></span><span style=display:flex><span>    path: <span style=color:#b58900>String</span>,
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> game1 <span style=color:#719e07>=</span> Game {
</span></span><span style=display:flex><span>        name: <span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;Guild Wars&#34;</span>),
</span></span><span style=display:flex><span>        hours_played: <span style=color:#268bd2>dbg</span><span style=color:#719e07>!</span>(<span style=color:#2aa198>5000</span>),
</span></span><span style=display:flex><span>        path: <span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;C:/Guild Wars/gw.exe&#34;</span>)
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    dbg!(<span style=color:#719e07>&amp;</span>game1);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>The result:</p><pre tabindex=0><code>[src/main.rs:12] 5000 = 5000
[src/main.rs:16] &amp;game1 = Game {
    name: &#34;Guild Wars&#34;,
    hours_played: 5000,
    path: &#34;C:/Guild Wars/gw.exe&#34;,
}
</code></pre><h2 id=methods>Methods
<a class=header-link href=#methods><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>We can convert <code>print_game</code> into a method that we can call on <code>Game</code> objects.
They are defined similar to normal functions, but their first parameter is
always <code>self</code>.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#586e75>// ch05/method1.rs
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#719e07>struct</span> <span style=color:#268bd2>Game</span> {
</span></span><span style=display:flex><span>    name: <span style=color:#b58900>String</span>,
</span></span><span style=display:flex><span>    hours_played: <span style=color:#dc322f>u32</span>,
</span></span><span style=display:flex><span>    path: <span style=color:#b58900>String</span>,
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>impl</span> Game {
</span></span><span style=display:flex><span>    <span style=color:#586e75>// implement print for Game
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#719e07>fn</span> <span style=color:#268bd2>print</span>(<span style=color:#719e07>&amp;</span><span style=color:#268bd2>self</span>) {
</span></span><span style=display:flex><span>        println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{}</span><span style=color:#2aa198>, </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>, </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, <span style=color:#268bd2>self</span>.name, <span style=color:#268bd2>self</span>.hours_played, <span style=color:#268bd2>self</span>.path);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> game1 <span style=color:#719e07>=</span> Game {
</span></span><span style=display:flex><span>        name: <span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;Guild Wars&#34;</span>),
</span></span><span style=display:flex><span>        hours_played: <span style=color:#2aa198>5000</span>,
</span></span><span style=display:flex><span>        path: <span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;C:/Guild Wars/gw.exe&#34;</span>),
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    game1.print();
</span></span><span style=display:flex><span>    <span style=color:#586e75>// Guild Wars, 5000, C:/Guild Wars/gw.exe
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>}
</span></span></code></pre></div><p>Note how we are passing <code>&amp;self</code> to <code>print</code>. Methods can also take ownership of
<code>self</code> and other parameters.</p><p>We can name a method the same as a field. Usually, these are getters and return
the value of the field.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>impl</span> Game {
</span></span><span style=display:flex><span>    <span style=color:#719e07>fn</span> <span style=color:#268bd2>name</span>(<span style=color:#719e07>&amp;</span><span style=color:#268bd2>self</span>) -&gt; <span style=color:#b58900>String</span> {
</span></span><span style=display:flex><span>        <span style=color:#268bd2>self</span>.name
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Now, we can call <code>game1.name()</code> to get the value of <code>name</code>.</p><h2 id=automatic-referencing-and-dereferencing>Automatic Referencing and Dereferencing
<a class=header-link href=#automatic-referencing-and-dereferencing><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>When calling methods, Rust automatically add <code>&</code>, <code>&amp;mut</code>, or <code>*</code> to the object
to match the method signature. Hence, why we did not do <code>(&amp;game1).print()</code>
although the receiver was <code>&amp;self</code>.</p><h2 id=associated-functions>Associated Functions
<a class=header-link href=#associated-functions><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Functions inside an <code>impl</code> block are called <code>associated functions</code> because they
are associated with a struct.</p><p>We can define non-method associated functions (they do not have the <code>&amp;self</code>
parameter). Let's add a function that creates a game object for calc.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#586e75>// ch05/associated_method_calc.rs
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#719e07>struct</span> <span style=color:#268bd2>Game</span> {
</span></span><span style=display:flex><span>    name: <span style=color:#b58900>String</span>,
</span></span><span style=display:flex><span>    hours_played: <span style=color:#dc322f>u32</span>,
</span></span><span style=display:flex><span>    path: <span style=color:#b58900>String</span>,
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>impl</span> Game {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#719e07>fn</span> <span style=color:#268bd2>print</span>(<span style=color:#719e07>&amp;</span><span style=color:#268bd2>self</span>) {
</span></span><span style=display:flex><span>        println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{}</span><span style=color:#2aa198>, </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>, </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, <span style=color:#268bd2>self</span>.name, <span style=color:#268bd2>self</span>.hours_played, <span style=color:#268bd2>self</span>.path);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#719e07>fn</span> <span style=color:#268bd2>calc</span>() -&gt; <span style=color:#268bd2>Game</span> {
</span></span><span style=display:flex><span>        Game {
</span></span><span style=display:flex><span>            name: <span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;Windows Calculator&#34;</span>),
</span></span><span style=display:flex><span>            hours_played: <span style=color:#2aa198>0</span>,
</span></span><span style=display:flex><span>            path: <span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;C:/Windows/System32/calc.exe&#34;</span>),
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> calc <span style=color:#719e07>=</span> Game::calc();
</span></span><span style=display:flex><span>    calc.print();
</span></span><span style=display:flex><span>    <span style=color:#586e75>// Windows Calculator, 0, C:/Windows/System32/calc.exe
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>}
</span></span></code></pre></div><p>We can call it with <code>Game::calc()</code> similar to <code>String::from(...)</code>.</p><p><strong>We can have multiple impl blocks</strong>.</p><h1 id=chapter-6>Chapter 6
<a class=header-link href=#chapter-6><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><h2 id=define-an-enum>Define an Enum
<a class=header-link href=#define-an-enum><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>We can create an enum:</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>enum</span> <span style=color:#268bd2>AppType</span> {
</span></span><span style=display:flex><span>    Utility,
</span></span><span style=display:flex><span>    Game,
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75>// get an enum
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#268bd2>let</span> util <span style=color:#719e07>=</span> AppType::Utility;
</span></span></code></pre></div><p>We can define functions that take a parameter of type <code>AppType</code>. Revamping the
game example from before:</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#586e75>// ch06/enum1.rs
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>
</span></span><span style=display:flex><span><span style=color:#586e75>// needed to print the AppType values
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#719e07>#[derive(Debug)]</span>
</span></span><span style=display:flex><span><span style=color:#719e07>enum</span> <span style=color:#268bd2>AppType</span> {
</span></span><span style=display:flex><span>    Utility,
</span></span><span style=display:flex><span>    Game,
</span></span><span style=display:flex><span>} 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>struct</span> <span style=color:#268bd2>App</span> {
</span></span><span style=display:flex><span>    name: <span style=color:#b58900>String</span>,
</span></span><span style=display:flex><span>    hours_played: <span style=color:#dc322f>u32</span>,
</span></span><span style=display:flex><span>    path: <span style=color:#b58900>String</span>,
</span></span><span style=display:flex><span>    app_type: <span style=color:#268bd2>AppType</span>,
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>impl</span> App {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#719e07>fn</span> <span style=color:#268bd2>print</span>(<span style=color:#719e07>&amp;</span><span style=color:#268bd2>self</span>) {
</span></span><span style=display:flex><span>        println!(
</span></span><span style=display:flex><span>            <span style=color:#2aa198>&#34;Name: </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>, Hours played: </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>, Path: </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>, Type: </span><span style=color:#2aa198>{:?}</span><span style=color:#2aa198>&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#268bd2>self</span>.name,
</span></span><span style=display:flex><span>            <span style=color:#268bd2>self</span>.hours_played,
</span></span><span style=display:flex><span>            <span style=color:#268bd2>self</span>.path,
</span></span><span style=display:flex><span>            <span style=color:#268bd2>self</span>.app_type
</span></span><span style=display:flex><span>        );
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> calc <span style=color:#719e07>=</span> App {
</span></span><span style=display:flex><span>        name: <span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;Windows Calculator&#34;</span>),
</span></span><span style=display:flex><span>        hours_played: <span style=color:#2aa198>123</span>,
</span></span><span style=display:flex><span>        path: <span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;C:/Windows/System32/calc.exe&#34;</span>),
</span></span><span style=display:flex><span>        app_type: <span style=color:#268bd2>AppType</span>::Utility,
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    calc.print();
</span></span><span style=display:flex><span>    <span style=color:#586e75>// Name: Windows Calculator, Hours played: 123, Path: C:/Windows/System32/calc.exe, Type: Utility
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>}
</span></span></code></pre></div><p>Note how I have used <code>#[derive(Debug)]</code> before the enum to print its value with
<code>{:?}</code>. Otherwise it does not work.</p><p>We can also ditch the struct and do everything in the enum.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#586e75>// ch06/enum2.rs
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#719e07>#[derive(Debug)]</span>
</span></span><span style=display:flex><span><span style=color:#719e07>enum</span> <span style=color:#268bd2>AppType</span> {
</span></span><span style=display:flex><span>    <span style=color:#586e75>// name and path.
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    Utility(<span style=color:#b58900>String</span>, <span style=color:#b58900>String</span>),
</span></span><span style=display:flex><span>    <span style=color:#586e75>// name, path, hours_played
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    Game(<span style=color:#b58900>String</span>, <span style=color:#b58900>String</span>, <span style=color:#dc322f>u32</span>),
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> calc <span style=color:#719e07>=</span> AppType::Utility(
</span></span><span style=display:flex><span>        <span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;Windows Calculator&#34;</span>),
</span></span><span style=display:flex><span>        <span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;C:/Windows/System32/calc.exe&#34;</span>),
</span></span><span style=display:flex><span>    );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> gw <span style=color:#719e07>=</span> AppType::Game(
</span></span><span style=display:flex><span>        <span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;Guild Wars&#34;</span>),
</span></span><span style=display:flex><span>        <span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;C:/Guild Wars/gw.exe&#34;</span>),
</span></span><span style=display:flex><span>        <span style=color:#2aa198>5000</span>,
</span></span><span style=display:flex><span>    );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{:?}</span><span style=color:#2aa198>&#34;</span>, calc);
</span></span><span style=display:flex><span>    <span style=color:#586e75>// Utility(&#34;Windows Calculator&#34;, &#34;C:/Windows/System32/calc.exe&#34;)
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{:?}</span><span style=color:#2aa198>&#34;</span>, gw);
</span></span><span style=display:flex><span>    <span style=color:#586e75>// Game(&#34;Guild Wars&#34;, &#34;C:/Guild Wars/gw.exe&#34;, 5000)
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>}
</span></span></code></pre></div><p>We can also define structs and pass them as a parameter to the enum function.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#586e75>// ch06/enum3.rs
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#719e07>#[derive(Debug)]</span>
</span></span><span style=display:flex><span><span style=color:#719e07>struct</span> <span style=color:#268bd2>GameStruct</span> {
</span></span><span style=display:flex><span>    name: <span style=color:#b58900>String</span>,
</span></span><span style=display:flex><span>    path: <span style=color:#b58900>String</span>,
</span></span><span style=display:flex><span>    hours_played: <span style=color:#dc322f>u32</span>,
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>#[derive(Debug)]</span>
</span></span><span style=display:flex><span><span style=color:#719e07>struct</span> <span style=color:#268bd2>UtilStruct</span> {
</span></span><span style=display:flex><span>    name: <span style=color:#b58900>String</span>,
</span></span><span style=display:flex><span>    path: <span style=color:#b58900>String</span>,
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>#[derive(Debug)]</span>
</span></span><span style=display:flex><span><span style=color:#719e07>enum</span> <span style=color:#268bd2>AppType</span> {
</span></span><span style=display:flex><span>    Game(GameStruct),
</span></span><span style=display:flex><span>    Utility(UtilStruct),
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> calc <span style=color:#719e07>=</span> AppType::Utility(UtilStruct {
</span></span><span style=display:flex><span>        name: <span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;Windows Calculator&#34;</span>),
</span></span><span style=display:flex><span>        path: <span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;C:/Windows/System32/calc.exe&#34;</span>),
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{:?}</span><span style=color:#2aa198>&#34;</span>, calc);
</span></span><span style=display:flex><span>    <span style=color:#586e75>// Utility(UtilStruct { name: &#34;Windows Calculator&#34;, path: &#34;C:/Windows/System32/calc.exe&#34; })
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>}
</span></span></code></pre></div><p>We can have different things in the enum like the example from the book:</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>enum</span> <span style=color:#268bd2>Message</span> {
</span></span><span style=display:flex><span>    <span style=color:#586e75>// no data associated with it.
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    Quit,
</span></span><span style=display:flex><span>    <span style=color:#586e75>// named fields like a struct
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    Move { x: <span style=color:#dc322f>i32</span>, y: <span style=color:#dc322f>i32</span> },
</span></span><span style=display:flex><span>    Write(<span style=color:#b58900>String</span>),
</span></span><span style=display:flex><span>    ChangeColor(<span style=color:#dc322f>i32</span>, <span style=color:#dc322f>i32</span>, <span style=color:#dc322f>i32</span>),
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=enum-methods-and-match>Enum Methods and match
<a class=header-link href=#enum-methods-and-match><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>We can also have enum methods. Let's define the new <code>print</code> method that returns
a String that represents each enum.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#586e75>// ch06/enum4.rs
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#719e07>enum</span> <span style=color:#268bd2>AppType</span> {
</span></span><span style=display:flex><span>    Game(GameStruct),
</span></span><span style=display:flex><span>    Utility(UtilStruct),
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>impl</span> AppType {
</span></span><span style=display:flex><span>    <span style=color:#719e07>fn</span> <span style=color:#268bd2>stringer</span>(<span style=color:#719e07>&amp;</span><span style=color:#268bd2>self</span>) -&gt; <span style=color:#b58900>String</span> {
</span></span><span style=display:flex><span>        <span style=color:#719e07>match</span> <span style=color:#268bd2>self</span> {
</span></span><span style=display:flex><span>            AppType::Game(g) <span style=color:#719e07>=&gt;</span> format!(
</span></span><span style=display:flex><span>                <span style=color:#2aa198>&#34;Name: </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>, Path: </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>, Hours Played: </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>,
</span></span><span style=display:flex><span>                g.name, g.path, g.hours_played
</span></span><span style=display:flex><span>            ),
</span></span><span style=display:flex><span>            AppType::Utility(u) <span style=color:#719e07>=&gt;</span> format!(<span style=color:#2aa198>&#34;Name: </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>, Path: </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, u.name, u.path),
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Note how we are using <code>match</code> and are able to access the enum parameters (in
this case structs). The <code>format!</code> macro returns a formatted <code>String</code>.</p><h2 id=option-enum>Option Enum
<a class=header-link href=#option-enum><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Rust does not have null but the <code>Option</code> enum allows us to have <code>None</code>.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>enum</span> <span style=color:#b58900>Option</span><span style=color:#719e07>&lt;</span>T<span style=color:#719e07>&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#b58900>None</span>,
</span></span><span style=display:flex><span>    <span style=color:#b58900>Some</span>(T),
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>We can use <code>Some</code> and <code>None</code> directly without importing anything.
<code>&lt;T> == lol yes generics</code>.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#586e75>// Option&lt;i32&gt;
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#268bd2>let</span> some_number <span style=color:#719e07>=</span> <span style=color:#b58900>Some</span>(<span style=color:#2aa198>5</span>);
</span></span><span style=display:flex><span><span style=color:#268bd2>let</span> absent_number: <span style=color:#b58900>Option</span><span style=color:#719e07>&lt;</span><span style=color:#dc322f>i32</span><span style=color:#719e07>&gt;</span> <span style=color:#719e07>=</span> <span style=color:#b58900>None</span>;  <span style=color:#586e75>// we have to enter the type for None
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>
</span></span><span style=display:flex><span><span style=color:#586e75>// Option&lt;&amp;str&gt;
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#268bd2>let</span> some_string <span style=color:#719e07>=</span> <span style=color:#b58900>Some</span>(<span style=color:#2aa198>&#34;a string&#34;</span>);
</span></span></code></pre></div><h2 id=matching-with-optiont>Matching with Option<t>
<a class=header-link href=#matching-with-optiont><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>We can try to write a function that extracts the value of <code>u32</code> from
<code>Option&lt;i32></code> like this:</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>extract_option</span>(o: <span style=color:#b58900>Option</span><span style=color:#719e07>&lt;</span><span style=color:#dc322f>u32</span><span style=color:#719e07>&gt;</span>) -&gt; <span style=color:#dc322f>u32</span> {
</span></span><span style=display:flex><span>    <span style=color:#719e07>match</span> o {
</span></span><span style=display:flex><span>        <span style=color:#b58900>Some</span>(i) <span style=color:#719e07>=&gt;</span> i,
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>This returns <code>i</code> for <code>Some(i)</code>, but the compiler complains about not handling
<code>None</code>.</p><pre tabindex=0><code>error[E0004]: non-exhaustive patterns: `None` not covered
   --&gt; src/main.rs:2:11
    |
2   |     match o {
    |           ^ pattern `None` not covered
    |
</code></pre><p>Basically, the match should cover all possible values. They are <strong>exhaustive</strong>.
Here, we will have a dilemma. What should we return as <code>None</code>? <code>None</code> is the
absence of values here. A very naive way would be returning 0. But that means
<code>Some(0)</code> and <code>None</code> would be the same.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>extract_option</span>(o: <span style=color:#b58900>Option</span><span style=color:#719e07>&lt;</span><span style=color:#dc322f>u32</span><span style=color:#719e07>&gt;</span>) -&gt; <span style=color:#dc322f>u32</span> {
</span></span><span style=display:flex><span>    <span style=color:#719e07>match</span> o {
</span></span><span style=display:flex><span>        <span style=color:#b58900>Some</span>(i) <span style=color:#719e07>=&gt;</span> i,
</span></span><span style=display:flex><span>        <span style=color:#b58900>None</span> <span style=color:#719e07>=&gt;</span> <span style=color:#2aa198>0</span>,
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> s1 <span style=color:#719e07>=</span> <span style=color:#b58900>Some</span>(<span style=color:#2aa198>0</span>);
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> n1: <span style=color:#b58900>Option</span><span style=color:#719e07>&lt;</span><span style=color:#dc322f>u32</span><span style=color:#719e07>&gt;</span> <span style=color:#719e07>=</span> <span style=color:#b58900>None</span>;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, extract_option(s1)); <span style=color:#586e75>// 0
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, extract_option(n1)); <span style=color:#586e75>// 0
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>}
</span></span></code></pre></div><p>I still don't know how to use <code>None</code>, but let's move on.</p><p>Writing exhaustive matches will be boring if we only want to take action for a
few values. This is why we have <code>other</code>. So, we can write matches like this.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>match</span> user_input {
</span></span><span style=display:flex><span>    <span style=color:#2aa198>1</span> <span style=color:#719e07>=&gt;</span> {
</span></span><span style=display:flex><span>        do1();
</span></span><span style=display:flex><span>        launch();
</span></span><span style=display:flex><span>    } <span style=color:#586e75>// we can have a block here, too - rustfmt removes the colon here
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#2aa198>2</span> <span style=color:#719e07>=&gt;</span> abort(),
</span></span><span style=display:flex><span>    other <span style=color:#719e07>=&gt;</span> try_again(other), <span style=color:#586e75>// note how we can use `other` in the arm
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>}
</span></span></code></pre></div><p>If we don't want to use the value, we can use <code>_</code> instead of <code>other</code>.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>match</span> user_input {
</span></span><span style=display:flex><span>    <span style=color:#2aa198>1</span> <span style=color:#719e07>=&gt;</span> {
</span></span><span style=display:flex><span>        do1();
</span></span><span style=display:flex><span>        launch();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#2aa198>2</span> <span style=color:#719e07>=&gt;</span> abort(),
</span></span><span style=display:flex><span>    _ <span style=color:#719e07>=&gt;</span> try_again(), <span style=color:#586e75>// run try_again for all other values
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>}
</span></span></code></pre></div><p>If we really don't want to do anything, we can replace <code>try_again()</code> with <code>()</code>:</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>match</span> user_input {
</span></span><span style=display:flex><span>    <span style=color:#2aa198>1</span> <span style=color:#719e07>=&gt;</span> {
</span></span><span style=display:flex><span>        do1();
</span></span><span style=display:flex><span>        launch();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#2aa198>2</span> <span style=color:#719e07>=&gt;</span> abort(),
</span></span><span style=display:flex><span>    _ <span style=color:#719e07>=&gt;</span> (), <span style=color:#586e75>// don&#39;t do anything for all other values
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>}
</span></span></code></pre></div><h2 id=if-let>if let
<a class=header-link href=#if-let><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Well, this is very confusing!</p><p>Similar to a <code>match</code> but not exhaustive. These two are supposedly the same.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#268bd2>let</span> config_max <span style=color:#719e07>=</span> <span style=color:#b58900>Some</span>(<span style=color:#2aa198>3</span>);
</span></span><span style=display:flex><span><span style=color:#719e07>match</span> config_max {
</span></span><span style=display:flex><span>    <span style=color:#b58900>Some</span>(max) <span style=color:#719e07>=&gt;</span> println!(<span style=color:#2aa198>&#34;The maximum is configured to be </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, max),
</span></span><span style=display:flex><span>    _ <span style=color:#719e07>=&gt;</span> (),
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Because of the <code>let</code>, the value of <code>max</code> will be <code>3u8</code> after the <code>if</code>.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#268bd2>let</span> config_max <span style=color:#719e07>=</span> <span style=color:#b58900>Some</span>(<span style=color:#2aa198>3</span>);
</span></span><span style=display:flex><span><span style=color:#719e07>if</span> <span style=color:#268bd2>let</span> <span style=color:#b58900>Some</span>(max) <span style=color:#719e07>=</span> config_max {
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;The maximum is configured to be </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, max);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>This gets more confusing because if we already have a <code>max</code> variable, it will be
shadowed here.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> config_max <span style=color:#719e07>=</span> <span style=color:#b58900>Some</span>(<span style=color:#2aa198>3</span>);
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> max <span style=color:#719e07>=</span> <span style=color:#2aa198>10</span>;
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, max); <span style=color:#586e75>// prints &#34;10&#34;
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>
</span></span><span style=display:flex><span>    <span style=color:#719e07>if</span> <span style=color:#268bd2>let</span> <span style=color:#b58900>Some</span>(max) <span style=color:#719e07>=</span> config_max {
</span></span><span style=display:flex><span>        println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, max); <span style=color:#586e75>// prints &#34;3&#34;
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    }
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, max); <span style=color:#586e75>// prints &#34;10&#34;
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>}
</span></span></code></pre></div><p>I should stop thinking of this as an <code>if</code>. Not sure how I can handle using it
later when writing Rust. We can also have <code>else</code> here which is like the <code>_</code> in
match and matches everything else.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> config_max <span style=color:#719e07>=</span> <span style=color:#b58900>Some</span>(<span style=color:#2aa198>3</span>);
</span></span><span style=display:flex><span>    <span style=color:#719e07>if</span> <span style=color:#268bd2>let</span> <span style=color:#b58900>Some</span>(max) <span style=color:#719e07>=</span> config_max {
</span></span><span style=display:flex><span>        println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, max); <span style=color:#586e75>// prints &#34;3&#34;
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    } <span style=color:#719e07>else</span> {
</span></span><span style=display:flex><span>        println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, <span style=color:#2aa198>&#34;not 3&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h1 id=chapter-7>Chapter 7
<a class=header-link href=#chapter-7><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><h2 id=packages--crates>Packages & Crates
<a class=header-link href=#packages--crates><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><ul><li>Crate: A binary of library.</li><li>Crate root: The source file the compiler starts from.<ul><li><code>src/main.rs</code>: Crate root of binary crate with the same name as the package.<ul><li>More binary crates will be in <code>src/bin</code>.</li></ul></li><li><code>src/lib.rs</code>: Crate root of library crate with the same name as the package.</li></ul></li><li>Package: One or more crates.<ul><li>Has <code>Cargo.toml</code> which describes how to build the crates.</li><li>Has at most one library crate and many binary crates.</li><li>Must have at least one crate.</li></ul></li></ul><h2 id=modules>Modules
<a class=header-link href=#modules><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Modules help us organize code within a crate into groups. Also <code>public/private</code>
items. Defined with the <code>mod</code> keyword. Modules can be nested, too.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>mod</span> applications {
</span></span><span style=display:flex><span>    <span style=color:#719e07>mod</span> games {
</span></span><span style=display:flex><span>        <span style=color:#719e07>fn</span> <span style=color:#268bd2>start</span>() {}
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#719e07>mod</span> utilities {
</span></span><span style=display:flex><span>        <span style=color:#719e07>fn</span> <span style=color:#268bd2>start_utility</span>() {}
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><code>games</code> and <code>utilities</code> are sibling modules. They are defined in the same module
and have the same parent. All top level modules are children of an implicit
module named <code>crate</code>. In this code <code>applications</code> is a child of <code>crate</code>.</p><h2 id=paths>Paths
<a class=header-link href=#paths><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>How to tell Rust where to find an item in the module tree. Separator is <code>::</code>.</p><ul><li>Absolute: Starts with the create name or <code>crate</code>.</li><li>Relative: Starts from the current module and uses <code>self</code>, <code>super</code>, or an
identifier in the current module.</li></ul><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#586e75>// ch07/restaurant/src/lib.rs
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#719e07>mod</span> applications {
</span></span><span style=display:flex><span>    <span style=color:#719e07>mod</span> games {
</span></span><span style=display:flex><span>        <span style=color:#719e07>fn</span> <span style=color:#268bd2>start</span>() {}
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#719e07>mod</span> utilities {
</span></span><span style=display:flex><span>        <span style=color:#719e07>fn</span> <span style=color:#268bd2>start_utility</span>() {}
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75>// pub makes it public, more about it later
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#719e07>pub</span> <span style=color:#719e07>fn</span> <span style=color:#268bd2>run_game</span>() {
</span></span><span style=display:flex><span>    <span style=color:#586e75>// absolute path
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#719e07>crate</span>::applications::games::start();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#586e75>// relative path
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    applications::games::start();
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><code>applications</code> is defined in the same level as run_game so we can start with it
in a relative path.</p><p>We cannot build this with <code>cargo build</code> because the <code>games</code> module is private.</p><pre tabindex=0><code>error[E0603]: module `games` is private
  --&gt; src/lib.rs:13:26
   |
13 |     crate::applications::games::start();
   |                          ^^^^^ private module
   |
note: the module `games` is defined here
  --&gt; src/lib.rs:2:5
   |
2  |     mod games {
   |     ^^^^^^^^^
</code></pre><h2 id=rusts-privacy-boundary>Rust's Privacy Boundary
<a class=header-link href=#rusts-privacy-boundary><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Everything is private by default in Rust. We have to use <code>pub</code> to make them
public.</p><p>Parent modules cannot see items in their child modules, but child
modules can use items in their parent modules.</p><p>If we just make the <code>games</code> module public (<code>pub mod games</code>) we still get an
error because <code>start</code> is still private. It must be public, too.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>mod</span> applications {
</span></span><span style=display:flex><span>    <span style=color:#719e07>pub</span> <span style=color:#719e07>mod</span> games {
</span></span><span style=display:flex><span>        <span style=color:#719e07>pub</span> <span style=color:#719e07>fn</span> <span style=color:#268bd2>start</span>() {}
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#719e07>mod</span> utilities {
</span></span><span style=display:flex><span>        <span style=color:#719e07>fn</span> <span style=color:#268bd2>start_utility</span>() {}
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75>// now this works
</span></span></span><span style=display:flex><span><span style=color:#586e75>// crate::applications::games::start();
</span></span></span></code></pre></div><p>Why can we call stuff in the <code>applications</code> module although it's not public?
Because <code>run_game()</code> is defined in the same module.</p><h2 id=super>Super
<a class=header-link href=#super><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Equal to <code>..</code> in the file system. We can refer to parent modules. <code>delete_stuff</code>
is defined in <code>applications</code>. We can call it <code>super</code> from inside <code>games</code>.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>mod</span> applications {
</span></span><span style=display:flex><span>    <span style=color:#719e07>pub</span> <span style=color:#719e07>mod</span> games {
</span></span><span style=display:flex><span>        <span style=color:#719e07>pub</span> <span style=color:#719e07>fn</span> <span style=color:#268bd2>start</span>() {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#719e07>fn</span> <span style=color:#268bd2>delete</span>() {
</span></span><span style=display:flex><span>            <span style=color:#586e75>// call delete_stuff() from `applications`
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>            <span style=color:#719e07>super</span>::delete_stuff();
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#719e07>mod</span> utilities {
</span></span><span style=display:flex><span>        <span style=color:#719e07>fn</span> <span style=color:#268bd2>start_utility</span>() {}
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#719e07>fn</span> <span style=color:#268bd2>delete_stuff</span>() {}
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=public-structs>Public Structs
<a class=header-link href=#public-structs><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>We can make structs public with <code>pub</code> but the fields will stay private unless we
manually make them public, too.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#586e75>// ch07/applications/src/lib.rs
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#719e07>mod</span> applications {
</span></span><span style=display:flex><span>    <span style=color:#719e07>pub</span> <span style=color:#719e07>mod</span> games {
</span></span><span style=display:flex><span>        <span style=color:#586e75>// public struct
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>        <span style=color:#719e07>pub</span> <span style=color:#719e07>struct</span> <span style=color:#268bd2>Game</span> {
</span></span><span style=display:flex><span>            <span style=color:#719e07>pub</span> name: <span style=color:#b58900>String</span>,   <span style=color:#586e75>// public field
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>            hours_played: <span style=color:#dc322f>u32</span>,  <span style=color:#586e75>// private field
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>pub</span> <span style=color:#719e07>fn</span> <span style=color:#268bd2>create_guild_wars</span>() -&gt; <span style=color:#268bd2>Game</span> {
</span></span><span style=display:flex><span>    applications::games::Game {
</span></span><span style=display:flex><span>        name: <span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;Guild Wars&#34;</span>),
</span></span><span style=display:flex><span>        hours_played: <span style=color:#2aa198>5000</span>,  <span style=color:#586e75>// error here because the field is private
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>We cannot access <code>hours_played</code> inside because it's a private field.</p><pre tabindex=0><code>error[E0451]: field `hours_played` of struct `Game` is private
  --&gt; src/lib.rs:14:9
   |
14 |         hours_played: 123,
   |         ^^^^^^^^^^^^^^^^^ private field
</code></pre><p>If we want to keep the field private, we need to create getters and setters for
it. Another solution is moving the <code>create_calc()</code> function to the <code>games</code>
module. It will be adjacent to the <code>Game</code> struct and can use its fields. This
will work even if <code>Game</code> is not public but we probably want to use it outside of
the module in other parts of the program.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>mod</span> applications {
</span></span><span style=display:flex><span>    <span style=color:#719e07>pub</span> <span style=color:#719e07>mod</span> games {
</span></span><span style=display:flex><span>        <span style=color:#586e75>// public struct
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>        <span style=color:#719e07>pub</span> <span style=color:#719e07>struct</span> <span style=color:#268bd2>Game</span> {
</span></span><span style=display:flex><span>            name: <span style=color:#b58900>String</span>,
</span></span><span style=display:flex><span>            hours_played: <span style=color:#dc322f>u32</span>,
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#719e07>pub</span> <span style=color:#719e07>fn</span> <span style=color:#268bd2>create_guild_wars</span>() -&gt; <span style=color:#268bd2>Game</span> {
</span></span><span style=display:flex><span>            Game {
</span></span><span style=display:flex><span>                name: <span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;Guild Wars&#34;</span>),
</span></span><span style=display:flex><span>                hours_played: <span style=color:#2aa198>5000</span>,
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=public-enums>Public Enums
<a class=header-link href=#public-enums><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Making an enum public will make all its variants public, too. We can use
<code>Utility</code> and <code>Game</code> because <code>AppType</code> is public.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#586e75>// ch07/enums/src/lib.rs
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#719e07>mod</span> applications {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#719e07>pub</span> <span style=color:#719e07>mod</span> app_enums {
</span></span><span style=display:flex><span>        <span style=color:#586e75>// public enum
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>        <span style=color:#719e07>pub</span> <span style=color:#719e07>enum</span> <span style=color:#268bd2>AppType</span> {
</span></span><span style=display:flex><span>            Utility,
</span></span><span style=display:flex><span>            Game,
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>create_enums</span>() {
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> calc <span style=color:#719e07>=</span> applications::app_enums::AppType::Utility;
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> gw <span style=color:#719e07>=</span> applications::app_enums::AppType::Game;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=the-use-keyword>The use Keyword
<a class=header-link href=#the-use-keyword><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>We can bring paths into our scope with <code>use</code>. We don't have to write the
complete path. We can use both absolute and relative paths.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>mod</span> applications {
</span></span><span style=display:flex><span>    <span style=color:#719e07>pub</span> <span style=color:#719e07>mod</span> app_enums {
</span></span><span style=display:flex><span>        <span style=color:#586e75>// public enum
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>        <span style=color:#719e07>pub</span> <span style=color:#719e07>enum</span> <span style=color:#268bd2>AppType</span> {
</span></span><span style=display:flex><span>            Utility,
</span></span><span style=display:flex><span>            Game,
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75>// absolute path
</span></span></span><span style=display:flex><span><span style=color:#586e75>// use crate::applications::app_enums::AppType;
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>
</span></span><span style=display:flex><span><span style=color:#586e75>// can also use relative paths
</span></span></span><span style=display:flex><span><span style=color:#586e75>// use applications::app_enums::AppType;
</span></span></span><span style=display:flex><span><span style=color:#586e75>// or use self in the relative path
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#719e07>use</span> <span style=color:#268bd2>self</span>::applications::app_enums::AppType;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>create_enums</span>() {
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> calc <span style=color:#719e07>=</span> AppType::Utility;
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> gw <span style=color:#719e07>=</span> AppType::Game;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Note how we can use <code>self</code> in the relative path. The book uses <code>self</code> but
removing it did not cause an issue for me.</p><p>We can also bring <code>Utility</code> and <code>Game</code> directly to scope, but that is not
recommended. By using <code>AppType</code> we show they are not locally defined and it
helps us discover where they are defined.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#586e75>// this works but not recommended
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#719e07>use</span> applications::app_enums::AppType::Utility;
</span></span><span style=display:flex><span><span style=color:#719e07>use</span> applications::app_enums::AppType::Game;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>create_enums</span>() {
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> calc <span style=color:#719e07>=</span> Utility;
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> gw <span style=color:#719e07>=</span> Game;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><blockquote><p>when bringing in structs, enums, and other items with use, it’s idiomatic to
specify the full path.</p></blockquote><p>If there are two items with the same name then we can <code>use</code> the parents.</p><p>Or we can use the <code>as</code> keyword to bring an item to the current scope with a
different name. Doesn't make sense here, but good for demonstration.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>use</span> applications::app_enums::AppType <span style=color:#719e07>as</span> ApplicationType;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>create_enums</span>() {
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> calc <span style=color:#719e07>=</span> ApplicationType::Utility;
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> gw <span style=color:#719e07>=</span> ApplicationType::Game;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=pub-use>pub use
<a class=header-link href=#pub-use><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Items brought into the current scope are private to external code. E.g., we have
<code>Config</code> struct imported and we want code that uses are our module to be able to
access it.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>pub</span> <span style=color:#719e07>use</span> configs::Config;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>use_config</span>(c: <span style=color:#268bd2>Config</span>) {
</span></span><span style=display:flex><span>    <span style=color:#586e75>// do something
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>}
</span></span></code></pre></div><h2 id=nested-paths-in-use>Nested Paths in use
<a class=header-link href=#nested-paths-in-use><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>If we are using items from the same path.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>mod</span> applications {
</span></span><span style=display:flex><span>    <span style=color:#719e07>pub</span> <span style=color:#719e07>mod</span> games {
</span></span><span style=display:flex><span>        <span style=color:#719e07>fn</span> <span style=color:#268bd2>start</span>() {}
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#719e07>pub</span> <span style=color:#719e07>mod</span> utilities {
</span></span><span style=display:flex><span>        <span style=color:#719e07>fn</span> <span style=color:#268bd2>start_utility</span>() {}
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>use</span> applications::{games, utilities};
</span></span></code></pre></div><p>We can also use the glob operator <code>*</code> to import everything public under a path.
Useful in tests but not anywhere else: <code>use std::collections::*;</code>.</p><h2 id=modules-in-different-files>Modules in Different Files
<a class=header-link href=#modules-in-different-files><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>We're gonna refactor our <code>applications</code> crate in the
<code>applications_separate_files</code> crate.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#586e75>// ch07/applications_separate_files/lib.rs
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>
</span></span><span style=display:flex><span><span style=color:#586e75>// declare the `applications` module, content will be in `applications.rs`.
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#719e07>mod</span> applications;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>use</span> applications::games::{create_guild_wars, Game};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>create_gw</span>() -&gt; <span style=color:#268bd2>Game</span> {
</span></span><span style=display:flex><span>    <span style=color:#586e75>// do something
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    create_guild_wars()
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><code>mod applications;</code> in the file tells Rust to look for the contents of this
module in <code>applications.rs</code> (in the same file path).</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#586e75>// ch07/applications_separate_files/applications.rs
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#719e07>pub</span> <span style=color:#719e07>mod</span> games {
</span></span><span style=display:flex><span>    <span style=color:#586e75>// removed
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>pub</span> <span style=color:#719e07>mod</span> utilities {
</span></span><span style=display:flex><span>    <span style=color:#586e75>// removed
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>}
</span></span></code></pre></div><p>We could also move <code>games</code> and <code>utilities</code> into their own files.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#586e75>// ch07/applications_separate_files/applications.rs
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#719e07>pub</span> <span style=color:#719e07>mod</span> games;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>pub</span> <span style=color:#719e07>mod</span> utilities;
</span></span></code></pre></div><p>Then put the code in <code>applications/games.rs</code> and <code>applications/utilities.rs</code>
respectively. Note they will be inside the <code>applications</code> directory.</p><pre tabindex=0><code>.
├── Cargo.lock
├── Cargo.toml
└── src
    ├── applications
    │   ├── games.rs
    │   └── utilities.rs
    ├── applications.rs
    └── lib.rs
</code></pre><h1 id=chapter-8>Chapter 8
<a class=header-link href=#chapter-8><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><h2 id=vectors>Vectors
<a class=header-link href=#vectors><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p><code>Vev&lt;T></code> or vectors. Store values of the same type sequentially in memory. All
vector elements are destroyed when vector goes out of scope.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#586e75>// empty vector of u32 values
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#268bd2>let</span> <span style=color:#719e07>mut</span> v: <span style=color:#b58900>Vec</span><span style=color:#719e07>&lt;</span><span style=color:#dc322f>u32</span><span style=color:#719e07>&gt;</span> <span style=color:#719e07>=</span> <span style=color:#b58900>Vec</span>::new();
</span></span><span style=display:flex><span><span style=color:#586e75>// add values with push
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>v.push(<span style=color:#2aa198>1</span>);
</span></span><span style=display:flex><span>v.push(<span style=color:#2aa198>2</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75>// Rust can infer the type with the vec! macro, it will be i32 here
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#268bd2>let</span> v2 <span style=color:#719e07>=</span> vec![<span style=color:#2aa198>1</span>, <span style=color:#2aa198>2</span>, <span style=color:#2aa198>3</span>];
</span></span></code></pre></div><h2 id=read-vector-values>Read Vector Values
<a class=header-link href=#read-vector-values><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>There are two ways to read vector elements.</p><ol><li>Index</li><li><code>.get</code></li></ol><p>Index starts from zero and is similar to other languages.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> <span style=color:#719e07>mut</span> v: <span style=color:#b58900>Vec</span><span style=color:#719e07>&lt;</span><span style=color:#dc322f>u32</span><span style=color:#719e07>&gt;</span> <span style=color:#719e07>=</span> <span style=color:#b58900>Vec</span>::new();
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    v.push(<span style=color:#2aa198>0</span>);
</span></span><span style=display:flex><span>    v.push(<span style=color:#2aa198>1</span>);
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> nem <span style=color:#719e07>=</span> v[<span style=color:#2aa198>1</span>];
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;nem = </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, nem);      <span style=color:#586e75>// 1
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    println!(<span style=color:#2aa198>&#34;v[1] = </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, v[<span style=color:#2aa198>1</span>]);    <span style=color:#586e75>// 1
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#268bd2>let</span> bem <span style=color:#719e07>=</span> <span style=color:#719e07>&amp;</span>v[<span style=color:#2aa198>1</span>];
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;^v[1] = </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, nem);    <span style=color:#586e75>// 1
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>}
</span></span></code></pre></div><p>Using <code>let nem = v[1];</code> is not really a good thing. We are looking at u32 which
is a fixed-length type and hence it's not moved. Let's try with strings.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> <span style=color:#719e07>mut</span> v: <span style=color:#b58900>Vec</span><span style=color:#719e07>&lt;</span><span style=color:#b58900>String</span><span style=color:#719e07>&gt;</span> <span style=color:#719e07>=</span> <span style=color:#b58900>Vec</span>::new();
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    v.push(<span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;0&#34;</span>));
</span></span><span style=display:flex><span>    v.push(<span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;1&#34;</span>));
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> nem <span style=color:#719e07>=</span> v[<span style=color:#2aa198>1</span>];             <span style=color:#586e75>// error here
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    println!(<span style=color:#2aa198>&#34;nem = </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, nem);
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;v[1] = </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, v[<span style=color:#2aa198>1</span>]);
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> bem <span style=color:#719e07>=</span> <span style=color:#719e07>&amp;</span>v[<span style=color:#2aa198>1</span>];
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;^v[1] = </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, nem);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>We get an error because we cannot move and index of a vector (<code>v[1]</code> in this
case).</p><pre tabindex=0><code>error[E0507]: cannot move out of index of `Vec&lt;String&gt;`
  --&gt; src/main.rs:11:15
   |
11 |     let nem = v[1];
   |               ^^^^
   |               |
   |               move occurs because value has type `String`, which does not implement the `Copy` trait
   |               help: consider borrowing here: `&amp;v[1]`
</code></pre><p>Instead we must borrow it.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> <span style=color:#719e07>mut</span> v: <span style=color:#b58900>Vec</span><span style=color:#719e07>&lt;</span><span style=color:#b58900>String</span><span style=color:#719e07>&gt;</span> <span style=color:#719e07>=</span> <span style=color:#b58900>Vec</span>::new();
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    v.push(<span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;0&#34;</span>));
</span></span><span style=display:flex><span>    v.push(<span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;1&#34;</span>));
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> nem <span style=color:#719e07>=</span> <span style=color:#719e07>&amp;</span>v[<span style=color:#2aa198>1</span>];    <span style=color:#586e75>// borrow instead of move
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    println!(<span style=color:#2aa198>&#34;nem = </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, nem);      <span style=color:#586e75>// nem = 1
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    println!(<span style=color:#2aa198>&#34;v[1] = </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, v[<span style=color:#2aa198>1</span>]);    <span style=color:#586e75>// v[1] = 1
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#268bd2>let</span> bem <span style=color:#719e07>=</span> <span style=color:#719e07>&amp;</span>v[<span style=color:#2aa198>1</span>];
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;^v[1] = </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, nem);    <span style=color:#586e75>// ^v[1] = 1
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>}
</span></span></code></pre></div><p>With the <code>get</code> method we receive an <code>Option&lt;T></code> (<code>Option&lt;String></code> here).</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> <span style=color:#719e07>mut</span> v: <span style=color:#b58900>Vec</span><span style=color:#719e07>&lt;</span><span style=color:#b58900>String</span><span style=color:#719e07>&gt;</span> <span style=color:#719e07>=</span> <span style=color:#b58900>Vec</span>::new();
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    v.push(<span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;0&#34;</span>));
</span></span><span style=display:flex><span>    v.push(<span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;1&#34;</span>));
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> index <span style=color:#719e07>=</span> <span style=color:#2aa198>0</span>;
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> v0 <span style=color:#719e07>=</span> v.get(index);
</span></span><span style=display:flex><span>    <span style=color:#719e07>match</span> v0 {
</span></span><span style=display:flex><span>        <span style=color:#b58900>Some</span>(value) <span style=color:#719e07>=&gt;</span> println!(<span style=color:#2aa198>&#34;v[</span><span style=color:#2aa198>{}</span><span style=color:#2aa198>] = </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, index, value),    <span style=color:#586e75>// v[0] = 0
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>        <span style=color:#b58900>None</span> <span style=color:#719e07>=&gt;</span> println!(<span style=color:#2aa198>&#34;v[</span><span style=color:#2aa198>{}</span><span style=color:#2aa198>] = None&#34;</span>, index),
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>This method is usually better because it returns <code>None</code> if the index is out of
range. We can catch it. E.g., changing <code>index</code> to 10 gives us:</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> <span style=color:#719e07>mut</span> v: <span style=color:#b58900>Vec</span><span style=color:#719e07>&lt;</span><span style=color:#b58900>String</span><span style=color:#719e07>&gt;</span> <span style=color:#719e07>=</span> <span style=color:#b58900>Vec</span>::new();
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    v.push(<span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;0&#34;</span>));
</span></span><span style=display:flex><span>    v.push(<span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;1&#34;</span>));
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> index <span style=color:#719e07>=</span> <span style=color:#2aa198>10</span>;
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> v0 <span style=color:#719e07>=</span> v.get(index);
</span></span><span style=display:flex><span>    <span style=color:#719e07>match</span> v0 {
</span></span><span style=display:flex><span>        <span style=color:#b58900>Some</span>(value) <span style=color:#719e07>=&gt;</span> println!(<span style=color:#2aa198>&#34;v[</span><span style=color:#2aa198>{}</span><span style=color:#2aa198>] = </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, index, value),
</span></span><span style=display:flex><span>        <span style=color:#b58900>None</span> <span style=color:#719e07>=&gt;</span> println!(<span style=color:#2aa198>&#34;v[</span><span style=color:#2aa198>{}</span><span style=color:#2aa198>] = None&#34;</span>, index),    <span style=color:#586e75>// v[10] = None
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>However, <code>v[10]</code> using the index will panic.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> <span style=color:#719e07>mut</span> v: <span style=color:#b58900>Vec</span><span style=color:#719e07>&lt;</span><span style=color:#b58900>String</span><span style=color:#719e07>&gt;</span> <span style=color:#719e07>=</span> <span style=color:#b58900>Vec</span>::new();
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    v.push(<span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;0&#34;</span>));
</span></span><span style=display:flex><span>    v.push(<span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;1&#34;</span>));
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> index <span style=color:#719e07>=</span> <span style=color:#2aa198>10</span>;
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;v[</span><span style=color:#2aa198>{}</span><span style=color:#2aa198>] = </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, index, v[index]);
</span></span><span style=display:flex><span>    <span style=color:#586e75>// thread &#39;main&#39; panicked at &#39;index out of bounds: the len is 2 but the
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#586e75>// index is 10&#39;, src/main.rs:8:35
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>}
</span></span></code></pre></div><p><strong>We cannot have both mutable and immutable references to even different
elements of the vector</strong>.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> <span style=color:#719e07>mut</span> v: <span style=color:#b58900>Vec</span><span style=color:#719e07>&lt;</span><span style=color:#b58900>String</span><span style=color:#719e07>&gt;</span> <span style=color:#719e07>=</span> <span style=color:#b58900>Vec</span>::new();
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    v.push(<span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;0&#34;</span>));
</span></span><span style=display:flex><span>    v.push(<span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;1&#34;</span>));
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> immutable_ref <span style=color:#719e07>=</span> v.get(<span style=color:#2aa198>0</span>);
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#586e75>// add something to the vector
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    v.push(<span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;2&#34;</span>));
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#586e75>// use the immutable reference &lt;-- error
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#719e07>match</span> immutable_ref {
</span></span><span style=display:flex><span>        <span style=color:#b58900>Some</span>(val) <span style=color:#719e07>=&gt;</span> println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, val),
</span></span><span style=display:flex><span>        <span style=color:#b58900>None</span> <span style=color:#719e07>=&gt;</span> (),
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>We will get an error when we use <code>immutable_ref</code> after modifying the vector.
Even though our reference is to a specific element. We cannot modify the vector
if we have an immutable reference to any of its elements. Because we might have
to allocate more memory so the vector is moved in memory and the reference to
element is not valid anymore.</p><pre tabindex=0><code>error[E0502]: cannot borrow `v` as mutable because it is also borrowed as immutable
  --&gt; src/main.rs:10:5
   |
7  |     let immutable_ref = v.get(0);
   |                         -------- immutable borrow occurs here
...
10 |     v.push(String::from(&#34;2&#34;));
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^ mutable borrow occurs here
...
13 |     match immutable_ref {
   |           ------------- immutable borrow later used here
</code></pre><h2 id=iterate-over-vector-elements>Iterate over Vector Elements
<a class=header-link href=#iterate-over-vector-elements><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>We can use a <code>for</code> loop.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> <span style=color:#719e07>mut</span> v: <span style=color:#b58900>Vec</span><span style=color:#719e07>&lt;</span><span style=color:#b58900>String</span><span style=color:#719e07>&gt;</span> <span style=color:#719e07>=</span> <span style=color:#b58900>Vec</span>::new();
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    v.push(<span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;0&#34;</span>));
</span></span><span style=display:flex><span>    v.push(<span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;1&#34;</span>));
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#586e75>// modify elements with mutable references
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#719e07>for</span> s <span style=color:#719e07>in</span> <span style=color:#719e07>&amp;</span><span style=color:#719e07>mut</span> v {
</span></span><span style=display:flex><span>        (<span style=color:#719e07>*</span>s).push_str(<span style=color:#2aa198>&#34;0&#34;</span>);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#586e75>// s.push_str(&#34;0&#34;);        
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>        <span style=color:#586e75>// also works because of automatic dereferencing
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#586e75>// print all elements
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#719e07>for</span> s <span style=color:#719e07>in</span> <span style=color:#719e07>&amp;</span>v {
</span></span><span style=display:flex><span>        println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, s);  <span style=color:#586e75>// 00 10
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Because we are iterating over references we need to dereference <code>s</code>. However, we
are calling a method on it to modify it so automatic dereferencing means we can
just do <code>s.push_str(...)</code> and it will work.</p><h2 id=using-an-enum-to-store-multiple-types>Using an Enum to Store Multiple Types
<a class=header-link href=#using-an-enum-to-store-multiple-types><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Vectors can only store values of the same type, but we can define an enum with
different types and then store values of that enum type in the vector.</p><p>This works if we know what types will be added to the vector at compile time.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>enum</span> <span style=color:#268bd2>SpreadsheetCell</span> {
</span></span><span style=display:flex><span>    Int(<span style=color:#dc322f>i32</span>),
</span></span><span style=display:flex><span>    Float(<span style=color:#dc322f>f64</span>),
</span></span><span style=display:flex><span>    Text(<span style=color:#b58900>String</span>),
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#268bd2>let</span> row <span style=color:#719e07>=</span> vec![
</span></span><span style=display:flex><span>    SpreadsheetCell::Int(<span style=color:#2aa198>3</span>),
</span></span><span style=display:flex><span>    SpreadsheetCell::Text(<span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;blue&#34;</span>)),
</span></span><span style=display:flex><span>    SpreadsheetCell::Float(<span style=color:#2aa198>10.12</span>),
</span></span><span style=display:flex><span>];
</span></span></code></pre></div><h2 id=remove-vector-values>Remove Vector Values
<a class=header-link href=#remove-vector-values><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>We can remove the last value with <code>pop</code> and get an <code>Option&lt;T></code> or <code>None</code> if the
vector is empty.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> <span style=color:#719e07>mut</span> v: <span style=color:#b58900>Vec</span><span style=color:#719e07>&lt;</span><span style=color:#b58900>String</span><span style=color:#719e07>&gt;</span> <span style=color:#719e07>=</span> <span style=color:#b58900>Vec</span>::new();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    v.push(<span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;0&#34;</span>));
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, extract_vector_value(v.pop()));  <span style=color:#586e75>// &#34;0&#34;
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, extract_vector_value(v.pop()));  <span style=color:#586e75>// &#34;None&#34;
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>extract_vector_value</span>(s: <span style=color:#b58900>Option</span><span style=color:#719e07>&lt;</span><span style=color:#b58900>String</span><span style=color:#719e07>&gt;</span>) -&gt; <span style=color:#b58900>String</span> {
</span></span><span style=display:flex><span>    <span style=color:#719e07>match</span> s {
</span></span><span style=display:flex><span>        <span style=color:#b58900>Some</span>(st) <span style=color:#719e07>=&gt;</span> st,
</span></span><span style=display:flex><span>        <span style=color:#b58900>None</span> <span style=color:#719e07>=&gt;</span> <span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;None&#34;</span>),
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>There are more methods. See <a href=https://doc.rust-lang.org/std/vec/struct.Vec.html target=_blank rel="noreferrer noopener">https://doc.rust-lang.org/std/vec/struct.Vec.html</a>.</p><h2 id=strings>Strings
<a class=header-link href=#strings><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Mostly talking about <code>String</code> in this section. This type is <code>UTF-8</code> encoded.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#586e75>// create a new String
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#268bd2>let</span> <span style=color:#719e07>mut</span> s1 <span style=color:#719e07>=</span> <span style=color:#b58900>String</span>::new();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75>// convert a string literal to a String
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#268bd2>let</span> s1_lit <span style=color:#719e07>=</span> <span style=color:#2aa198>&#34;Guild Wars&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#268bd2>let</span> s2 <span style=color:#719e07>=</span> s1_lit.to_string();    <span style=color:#586e75>// String type
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>
</span></span><span style=display:flex><span><span style=color:#586e75>// directly convert a string literal to String
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#268bd2>let</span> s3 <span style=color:#719e07>=</span> <span style=color:#2aa198>&#34;Guild Wars&#34;</span>.to_string();
</span></span><span style=display:flex><span><span style=color:#586e75>// we&#39;ve already seen `from`, too
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#268bd2>let</span> <span style=color:#719e07>mut</span> s4 <span style=color:#719e07>=</span> <span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;Guild Wars&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75>// append a string literal to a String
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>s4.push_str(<span style=color:#2aa198>&#34; 2&#34;</span>);  <span style=color:#586e75>// &#34;Guild Wars 2&#34;
</span></span></span><span style=display:flex><span><span style=color:#586e75>// append a single character to a String
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>s4.push(<span style=color:#2aa198>&#39;!&#39;</span>);       <span style=color:#586e75>// &#34;Guild Wars 2!&#34;
</span></span></span></code></pre></div><p>We can also concat String with <code>+</code>. The caveat is that first operand must be a
<code>String</code> and second must be <code>&amp;str</code> and the result is another <code>String</code>. The first
operand will be moved, too.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> first <span style=color:#719e07>=</span> <span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;Guild Wars&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> second <span style=color:#719e07>=</span> <span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34; Rocks!&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, first <span style=color:#719e07>+</span> <span style=color:#719e07>&amp;</span>second);    <span style=color:#586e75>// &#34;Guild Wars Rocks!&#34;
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#586e75>// first has been moved and we cannot use it anymore
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>}
</span></span></code></pre></div><p>We can also use <code>&amp;String</code> because the compiler can coerce it to <code>&amp;str</code>. Rust
uses a deref coercion to convert <code>&amp;second</code> to <code>&amp;second[..]</code>. <code>second</code> is not
moved.</p><blockquote><p>Rust Strings do not support indexing. We cannot do <code>st[1]</code>.</p></blockquote><blockquote><p><strong>Don't slice Strings</strong>. Depending on how the String is sliced, the return
value could be different.</p></blockquote><p>We can iterate over String bytes, but each byte might not be a valid char
depending on the length of each char encoded in UTF-8. E.g., it could be encoded
in 2 bytes and grabbing the first byte does not give us the actual character.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>for</span> c <span style=color:#719e07>in</span> <span style=color:#2aa198>&#34;whatever&#34;</span>.bytes() {
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, c);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>It works here because each char in the string above is encoded as one byte in
UTF-8.</p><h2 id=hashmaps>HashMaps
<a class=header-link href=#hashmaps><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p><code>HashMap&lt;K, V></code> maps keys of type <code>K</code> to values of type <code>V</code>.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>use</span> std::collections::HashMap;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#268bd2>let</span> <span style=color:#719e07>mut</span> hm <span style=color:#719e07>=</span> HashMap::new();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75>// by passing these values the type will be HashMap&lt;String, i32&gt;
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>hm.insert(<span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;key0&#34;</span>), <span style=color:#2aa198>0</span>);
</span></span><span style=display:flex><span>hm.insert(<span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;key1&#34;</span>), <span style=color:#2aa198>1</span>);
</span></span></code></pre></div><p>We can also create a HashMap by using two vectors. One will be key and the other
will be the values.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>use</span> std::collections::HashMap;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#268bd2>let</span> keys <span style=color:#719e07>=</span> vec![<span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;key0&#34;</span>), <span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;key1&#34;</span>)];
</span></span><span style=display:flex><span><span style=color:#268bd2>let</span> values <span style=color:#719e07>=</span> vec![<span style=color:#2aa198>0</span>, <span style=color:#2aa198>1</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#268bd2>let</span> <span style=color:#719e07>mut</span> hm: <span style=color:#268bd2>HashMap</span><span style=color:#719e07>&lt;</span>_, _<span style=color:#719e07>&gt;</span> <span style=color:#719e07>=</span> keys.into_iter().zip(values.into_iter()).collect();
</span></span></code></pre></div><h2 id=hashmaps-and-ownership>HashMaps and Ownership
<a class=header-link href=#hashmaps-and-ownership><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Variable length values will be moved when they are stored in the HashMap.
HashMaps are also stored on the heap because their size is unknown at compile
time.</p><h2 id=reading-hashmaps>Reading HashMaps
<a class=header-link href=#reading-hashmaps><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>We can read the values with <code>.get(&amp;key)</code>. Result is <code>Option&lt;V></code>. <code>Some(value)</code>
if the key exists and <code>None</code> if it doesn't.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#719e07>use</span> std::collections::HashMap;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> <span style=color:#719e07>mut</span> hm <span style=color:#719e07>=</span> HashMap::new();
</span></span><span style=display:flex><span>    hm.insert(<span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;key0&#34;</span>), <span style=color:#2aa198>0</span>);
</span></span><span style=display:flex><span>    hm.insert(<span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;key1&#34;</span>), <span style=color:#2aa198>1</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> val <span style=color:#719e07>=</span> hm.get(<span style=color:#719e07>&amp;</span><span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;key0&#34;</span>));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    print_option(val);                          <span style=color:#586e75>// 0
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    print_option(hm.get(<span style=color:#719e07>&amp;</span><span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;123&#34;</span>))); <span style=color:#586e75>// &#34;None&#34;
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>print_option</span>(o: <span style=color:#b58900>Option</span><span style=color:#719e07>&lt;&amp;</span><span style=color:#dc322f>i32</span><span style=color:#719e07>&gt;</span>) {
</span></span><span style=display:flex><span>    <span style=color:#719e07>match</span> o {
</span></span><span style=display:flex><span>        <span style=color:#b58900>Some</span>(val) <span style=color:#719e07>=&gt;</span> println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, val),
</span></span><span style=display:flex><span>        <span style=color:#b58900>None</span> <span style=color:#719e07>=&gt;</span> println!(<span style=color:#2aa198>&#34;None&#34;</span>),
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=iterating-over-the-hashmap>Iterating over the HashMap
<a class=header-link href=#iterating-over-the-hashmap><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>This is similar to other languages. Be sure to pass a reference to the HashMap
to <code>for</code></p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#719e07>use</span> std::collections::HashMap;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> <span style=color:#719e07>mut</span> hm <span style=color:#719e07>=</span> HashMap::new();
</span></span><span style=display:flex><span>    hm.insert(<span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;key0&#34;</span>), <span style=color:#2aa198>0</span>);
</span></span><span style=display:flex><span>    hm.insert(<span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;key1&#34;</span>), <span style=color:#2aa198>1</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> val <span style=color:#719e07>=</span> hm.get(<span style=color:#719e07>&amp;</span><span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;key0&#34;</span>));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#719e07>for</span> (k, v) <span style=color:#719e07>in</span> <span style=color:#719e07>&amp;</span>hm {
</span></span><span style=display:flex><span>        println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{}</span><span style=color:#2aa198>: </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, k, v);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=updating-a-hash-map>Updating a Hash Map
<a class=header-link href=#updating-a-hash-map><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Calling <code>insert</code> with an existing key will overwrite the value for that key.
Otherwise, it will add the key-value pair.</p><p>Check if a key exists and only add it if it does not.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#719e07>use</span> std::collections::HashMap;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> <span style=color:#719e07>mut</span> hm <span style=color:#719e07>=</span> HashMap::new();
</span></span><span style=display:flex><span>    hm.insert(<span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;key0&#34;</span>), <span style=color:#2aa198>0</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    hm.entry(<span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;key0&#34;</span>)).or_insert(<span style=color:#719e07>-</span><span style=color:#2aa198>1</span>);
</span></span><span style=display:flex><span>    hm.entry(<span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;key1&#34;</span>)).or_insert(<span style=color:#2aa198>1</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{:?}</span><span style=color:#2aa198>&#34;</span>, hm);   <span style=color:#586e75>// {&#34;key0&#34;: 0, &#34;key1&#34;: 1}
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>}
</span></span></code></pre></div><p><code>entry</code> returns an enum called <code>Entry</code>. For an existing key it looks like this:</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#268bd2>let</span> nem <span style=color:#719e07>=</span> hm.entry(<span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;key0&#34;</span>));
</span></span><span style=display:flex><span>println!({<span style=color:#2aa198>&#34;:?}&#34;</span>, nem);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75>// Entry(OccupiedEntry { key: &#34;key0&#34;, value: 0, .. })
</span></span></span></code></pre></div><p>For a non-existing key:</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#268bd2>let</span> bem <span style=color:#719e07>=</span>  hm.entry(<span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;key1&#34;</span>));
</span></span><span style=display:flex><span>println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{:?}</span><span style=color:#2aa198>&#34;</span>, bem);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75>// Entry(VacantEntry(&#34;key1&#34;))
</span></span></span></code></pre></div><p><code>or_insert</code> uses the return value of <code>entry</code> to only add the key/value to the
HashMap if the key does not exist and returns a mutable reference to the value
(old value for existing keys and the new value for new keys). Hence, we cannot
use two return values from <code>or_insert</code> in the same scope because we will have
two mutable references to (although different) values in the hashmap.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#719e07>use</span> std::collections::HashMap;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> <span style=color:#719e07>mut</span> hm <span style=color:#719e07>=</span> HashMap::new();
</span></span><span style=display:flex><span>    hm.insert(<span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;key0&#34;</span>), <span style=color:#2aa198>0</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> key0 <span style=color:#719e07>=</span> hm.entry(<span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;key0&#34;</span>)).or_insert(<span style=color:#719e07>-</span><span style=color:#2aa198>1</span>);
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> key1 <span style=color:#719e07>=</span> hm.entry(<span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;key1&#34;</span>)).or_insert(<span style=color:#2aa198>1</span>); <span style=color:#586e75>// error!
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{:?}</span><span style=color:#2aa198>&#34;</span>, key0);
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{:?}</span><span style=color:#2aa198>&#34;</span>, key1);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>We will get this error:</p><pre tabindex=0><code>error[E0499]: cannot borrow `hm` as mutable more than once at a time
  --&gt; src/main.rs:8:16
   |
7  |     let key0 = hm.entry(String::from(&#34;key0&#34;)).or_insert(-1);
   |                ------------------------------ first mutable borrow occurs here
8  |     let key1 = hm.entry(String::from(&#34;key1&#34;)).or_insert(1);
   |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ second mutable borrow occurs here
9  | 
10 |     println!(&#34;{:?}&#34;, key0);
   |                      ---- first borrow later used here
</code></pre><p>If we get a reference from <code>or_insert</code> we need to dereference to use it.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#719e07>use</span> std::collections::HashMap;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> <span style=color:#719e07>mut</span> hm <span style=color:#719e07>=</span> HashMap::new();
</span></span><span style=display:flex><span>    hm.insert(<span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;key0&#34;</span>), <span style=color:#2aa198>0</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> key0 <span style=color:#719e07>=</span> hm.entry(<span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;key0&#34;</span>)).or_insert(<span style=color:#719e07>-</span><span style=color:#2aa198>1</span>);
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{:?}</span><span style=color:#2aa198>&#34;</span>, key0);     <span style=color:#586e75>// 0
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>
</span></span><span style=display:flex><span>    <span style=color:#719e07>*</span>key0 <span style=color:#719e07>+=</span> <span style=color:#2aa198>1</span>;
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{:?}</span><span style=color:#2aa198>&#34;</span>, key0);     <span style=color:#586e75>// 1
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>}
</span></span></code></pre></div><h1 id=chapter-9>Chapter 9
<a class=header-link href=#chapter-9><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><h2 id=panic>panic!
<a class=header-link href=#panic><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Ends the program and unwinds the stack (walks back and cleans up). This is
expensive. To prevent clean up and just abort after panic (which is quick), add
this to <code>Cargo.toml</code>:</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-toml data-lang=toml><span style=display:flex><span>[profile.release]
</span></span><span style=display:flex><span>panic = <span style=color:#2aa198>&#39;abort&#39;</span>
</span></span></code></pre></div><p>Use the <code>panic!</code> macro:</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    panic!(<span style=color:#2aa198>&#34;pewpew&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75>// thread &#39;main&#39; panicked at &#39;pewpew&#39;, src/main.rs:2:5
</span></span></span><span style=display:flex><span><span style=color:#586e75>// note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
</span></span></span></code></pre></div><h2 id=recoverable-errors>Recoverable Errors
<a class=header-link href=#recoverable-errors><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>The <code>Result</code> enum can be used to return values from functions that might return
errors.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>enum</span> <span style=color:#b58900>Result</span><span style=color:#719e07>&lt;</span>T, E<span style=color:#719e07>&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#b58900>Ok</span>(T),      <span style=color:#586e75>// T: type of value returned in the success case
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#b58900>Err</span>(E),     <span style=color:#586e75>// E: type of value returned in case of errors
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>}
</span></span></code></pre></div><p>Looking at <code>std::fs::File::open</code> and we can see:</p><ul><li>Success: <code>Result&lt;File></code><ul><li><a href=https://doc.rust-lang.org/stable/std/fs/struct.File.html#method.open target=_blank rel="noreferrer noopener">https://doc.rust-lang.org/stable/std/fs/struct.File.html#method.open</a></li></ul></li><li>Error: <code>Err&lt;std::io::Error></code><ul><li><a href=https://doc.rust-lang.org/stable/std/fs/struct.OpenOptions.html#method.open target=_blank rel="noreferrer noopener">https://doc.rust-lang.org/stable/std/fs/struct.OpenOptions.html#method.open</a></li></ul></li></ul><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>use</span> std::fs::File;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> f <span style=color:#719e07>=</span> File::open(<span style=color:#2aa198>&#34;hello.txt&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> f <span style=color:#719e07>=</span> <span style=color:#719e07>match</span> f {
</span></span><span style=display:flex><span>        <span style=color:#b58900>Ok</span>(file) <span style=color:#719e07>=&gt;</span> file,
</span></span><span style=display:flex><span>        <span style=color:#b58900>Err</span>(error) <span style=color:#719e07>=&gt;</span> panic!(<span style=color:#2aa198>&#34;Problem opening the file: </span><span style=color:#2aa198>{:?}</span><span style=color:#2aa198>&#34;</span>, error),
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>The code will attempt to open a file. With success, a handle to the file is
stored in <code>f</code> and <code>panic!</code> otherwise.</p><h2 id=matching-on-different-errors>Matching on Different Errors
<a class=header-link href=#matching-on-different-errors><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>To act differently based on the error, we can <code>match</code> for <code>error.kind()</code> in the
error arm.</p><p>We are checking if the kind of error is <code>ErrorKind::NotFound</code> and if so, we will
create the file. We are also checking if the result of that also returns an
error. For other errors we will just panic.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>use</span> std::fs::File;
</span></span><span style=display:flex><span><span style=color:#719e07>use</span> std::io::ErrorKind;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> f <span style=color:#719e07>=</span> File::open(<span style=color:#2aa198>&#34;hello.txt&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> f <span style=color:#719e07>=</span> <span style=color:#719e07>match</span> f {
</span></span><span style=display:flex><span>        <span style=color:#b58900>Ok</span>(file) <span style=color:#719e07>=&gt;</span> file,   <span style=color:#586e75>// file exists
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>        <span style=color:#b58900>Err</span>(error) <span style=color:#719e07>=&gt;</span> <span style=color:#719e07>match</span> error.kind() {  <span style=color:#586e75>// check the error
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>            <span style=color:#586e75>// if file doesn&#39;t exist, create it
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>            ErrorKind::NotFound <span style=color:#719e07>=&gt;</span> <span style=color:#719e07>match</span> File::create(<span style=color:#2aa198>&#34;hello.txt&#34;</span>) {
</span></span><span style=display:flex><span>                <span style=color:#b58900>Ok</span>(fc) <span style=color:#719e07>=&gt;</span> fc,   <span style=color:#586e75>// new file was created successfully
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>                <span style=color:#b58900>Err</span>(e) <span style=color:#719e07>=&gt;</span> panic!(<span style=color:#2aa198>&#34;Problem creating the file: </span><span style=color:#2aa198>{:?}</span><span style=color:#2aa198>&#34;</span>, e), <span style=color:#586e75>// creating a new file failed
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>            },
</span></span><span style=display:flex><span>            <span style=color:#586e75>// all other errors
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>            other_error <span style=color:#719e07>=&gt;</span> {
</span></span><span style=display:flex><span>                panic!(<span style=color:#2aa198>&#34;Problem opening the file: </span><span style=color:#2aa198>{:?}</span><span style=color:#2aa198>&#34;</span>, other_error)
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>There are better ways of writing this code. We will see them in chapter 13.</p><h2 id=unwrap-and-expect>unwrap and expect
<a class=header-link href=#unwrap-and-expect><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>The <code>unwrap</code> method in this code will return the value if there's no error and
calls <code>panic</code> otherwise.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>use</span> std::fs::File;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> f <span style=color:#719e07>=</span> File::open(<span style=color:#2aa198>&#34;hello.txt&#34;</span>).unwrap();
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75>// thread &#39;main&#39; panicked at &#39;called `Result::unwrap()` on an `Err` value: Os {
</span></span></span><span style=display:flex><span><span style=color:#586e75>// code: 2, kind: NotFound, message: &#34;No such file or directory&#34; }&#39;,
</span></span></span><span style=display:flex><span><span style=color:#586e75>// src/main.rs:4:37
</span></span></span></code></pre></div><p><code>except</code> is the same, but we can choose an error message to return along the
default one.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>use</span> std::fs::File;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> f <span style=color:#719e07>=</span> File::open(<span style=color:#2aa198>&#34;hello.txt&#34;</span>).expect(<span style=color:#2aa198>&#34;panic!!!&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75>// thread &#39;main&#39; panicked at &#39;panic!!!: Os { code: 2, kind: NotFound, message: &#34;No
</span></span></span><span style=display:flex><span><span style=color:#586e75>// such file or directory&#34; }&#39;, src/main.rs:4:37
</span></span></span></code></pre></div><h2 id=propagating-errors>Propagating Errors
<a class=header-link href=#propagating-errors><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>We can return errors from our functions. Here's a convoluted way of writing
<code>FromStr</code>.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>use</span> std::fs::File;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#719e07>match</span> string_to_boolean(<span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;true&#34;</span>)) { <span style=color:#586e75>// &#34;it&#39;s true&#34;
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>        <span style=color:#b58900>Ok</span>(val) <span style=color:#719e07>=&gt;</span> println!(<span style=color:#2aa198>&#34;it&#39;s </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, val),
</span></span><span style=display:flex><span>        <span style=color:#b58900>Err</span>(s) <span style=color:#719e07>=&gt;</span> println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, s),
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#719e07>match</span> string_to_boolean(<span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;FALse&#34;</span>)) { <span style=color:#586e75>// &#34;it&#39;s false&#34;
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>        <span style=color:#b58900>Ok</span>(val) <span style=color:#719e07>=&gt;</span> println!(<span style=color:#2aa198>&#34;it&#39;s </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, val),
</span></span><span style=display:flex><span>        <span style=color:#b58900>Err</span>(s) <span style=color:#719e07>=&gt;</span> println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, s),
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#719e07>match</span> string_to_boolean(<span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;trueee&#34;</span>)) { <span style=color:#586e75>// &#34;not boolean&#34;
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>        <span style=color:#b58900>Ok</span>(val) <span style=color:#719e07>=&gt;</span> println!(<span style=color:#2aa198>&#34;it&#39;s </span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, val),
</span></span><span style=display:flex><span>        <span style=color:#b58900>Err</span>(s) <span style=color:#719e07>=&gt;</span> println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, s),
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>string_to_boolean</span>(s: <span style=color:#b58900>String</span>) -&gt; <span style=color:#b58900>Result</span><span style=color:#719e07>&lt;</span><span style=color:#dc322f>bool</span>, <span style=color:#b58900>String</span><span style=color:#719e07>&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#586e75>// converts a string to boolean. true and false are converted
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#586e75>// (case-insensitive), everything else is an error
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>
</span></span><span style=display:flex><span>    <span style=color:#719e07>match</span> s.to_ascii_lowercase().as_ref() {
</span></span><span style=display:flex><span>        <span style=color:#2aa198>&#34;true&#34;</span> <span style=color:#719e07>=&gt;</span> <span style=color:#b58900>Ok</span>(<span style=color:#cb4b16>true</span>),
</span></span><span style=display:flex><span>        <span style=color:#2aa198>&#34;false&#34;</span> <span style=color:#719e07>=&gt;</span> <span style=color:#b58900>Ok</span>(<span style=color:#cb4b16>false</span>),
</span></span><span style=display:flex><span>        _ <span style=color:#719e07>=&gt;</span> <span style=color:#b58900>Err</span>(<span style=color:#b58900>String</span>::from(<span style=color:#2aa198>&#34;not boolean&#34;</span>)),
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=shortcut-for-propagating-errors>Shortcut for Propagating Errors
<a class=header-link href=#shortcut-for-propagating-errors><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Place a <code>?</code> after a <code>Result</code> value to pass it on. If it's <code>Ok</code> then the program
will continue. For <code>Err</code> the function will return it.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>use</span> std::fs::File;
</span></span><span style=display:flex><span><span style=color:#719e07>use</span> std::io;
</span></span><span style=display:flex><span><span style=color:#719e07>use</span> std::io::Read;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>read_username_from_file</span>() -&gt; <span style=color:#b58900>Result</span><span style=color:#719e07>&lt;</span><span style=color:#b58900>String</span>, io::Error<span style=color:#719e07>&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> <span style=color:#719e07>mut</span> s <span style=color:#719e07>=</span> <span style=color:#b58900>String</span>::new();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    File::open(<span style=color:#2aa198>&#34;hello.txt&#34;</span>)<span style=color:#719e07>?</span>.read_to_string(<span style=color:#719e07>&amp;</span><span style=color:#719e07>mut</span> s)<span style=color:#719e07>?</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#b58900>Ok</span>(s)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>We will return errors if either of <code>open</code> and <code>.read_to_string</code> methods
encounter an error. The return value of the function with <code>?</code> must match
the parent function.</p><p>We can only use the <code>?</code> operator in a function that returns <code>Result</code> or <code>Option</code>
(more but I skipped it for these notes). If the parent function returns
<code>Option&lt;T></code> we can use <code>?</code> on a function inside with the same return value.</p><hr><h1 id=misc>Misc
<a class=header-link href=#misc><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><p>I stopped reading the book. These are my notes from creating projects.</p><h2 id=type-alias>Type Alias
<a class=header-link href=#type-alias><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Type aliases can point to a different type or we can create a new one on the
fly. I mostly used it to create an alias for a type in an external crate.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#719e07>type</span> <span style=color:#268bd2>MyType</span> <span style=color:#719e07>=</span> external_crate::SomeType;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>type</span> <span style=color:#268bd2>Point</span> <span style=color:#719e07>=</span> (<span style=color:#dc322f>u8</span>, <span style=color:#dc322f>u8</span>);
</span></span></code></pre></div><p><a href=https://doc.rust-lang.org/reference/items/type-aliases.html target=_blank rel="noreferrer noopener">https://doc.rust-lang.org/reference/items/type-aliases.html</a></p><h2 id=extension-trait>Extension Trait
<a class=header-link href=#extension-trait><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>You have an external type, you want to extend it. You can add traits to it.
Think of traits as interfaces.</p><p>First, we need to define the trait. By convention, these traits end in <code>Ext</code>.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#719e07>extern</span> <span style=color:#719e07>crate</span> crr;
</span></span><span style=display:flex><span><span style=color:#719e07>use</span> crr::OtherType;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>trait</span> OtherTypeExt {
</span></span><span style=display:flex><span>    <span style=color:#719e07>fn</span> <span style=color:#268bd2>to_text</span>(<span style=color:#719e07>&amp;</span><span style=color:#268bd2>self</span>) -&gt; <span style=color:#b58900>String</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Next, implement it.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#719e07>impl</span> OtherTypeExt <span style=color:#719e07>for</span> OtherType {
</span></span><span style=display:flex><span>    <span style=color:#719e07>fn</span> <span style=color:#268bd2>to_text</span>(<span style=color:#719e07>&amp;</span><span style=color:#268bd2>self</span>) -&gt; <span style=color:#b58900>String</span> {
</span></span><span style=display:flex><span>        <span style=color:#586e75>// do something.
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Now, we can use it "like a method."</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#586e75>// in main.rs
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#268bd2>let</span> other <span style=color:#719e07>=</span> OtherType::new();
</span></span><span style=display:flex><span><span style=color:#268bd2>let</span> text <span style=color:#719e07>=</span> other.to_text();
</span></span></code></pre></div><p>Source: <a href=https://rust-lang.github.io/rfcs/0445-extension-trait-conventions.html target=_blank rel="noreferrer noopener">https://rust-lang.github.io/rfcs/0445-extension-trait-conventions.html</a></p><h2 id=import-an-adjacent-module>Import an Adjacent Module
<a class=header-link href=#import-an-adjacent-module><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>We have defined a custom error in <code>error.rs</code>.</p><pre tabindex=0><code>parent-rs/
├── README.md
├── src
│   ├── error.rs
│   ├── lib.rs
│   └── utils.rs
</code></pre><p>To use this error in <code>utils.rs</code>: <code>use crate::error</code>.</p><h2 id=crate-level-pub>Crate Level Pub
<a class=header-link href=#crate-level-pub><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Only want to make something public for the current crate?</p><p><code>pub(crate) fn whatever() {}</code></p><h2 id=embed-files-in-the-binary>Embed Files in the Binary
<a class=header-link href=#embed-files-in-the-binary><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Similar to Go's <a href=https://pkg.go.dev/embed target=_blank rel="noreferrer noopener">embed</a> package, we can read files during the build
and use them as variables in the program.</p><p>We can use the <a href=https://doc.rust-lang.org/std/macro.include_bytes.html target=_blank rel="noreferrer noopener">include_bytes</a> and <a href=https://doc.rust-lang.org/std/macro.include_str.html target=_blank rel="noreferrer noopener">include_str</a>
macros. File paths must be relative to the file. E.g., if we're inside
<code>src/main.rs</code> then <code>include_str!("whatever");</code> will try to read <code>src/whatever</code>.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#586e75>// read a file as text.
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#268bd2>let</span> string_txt <span style=color:#719e07>=</span> include_str!(<span style=color:#2aa198>&#34;string.txt&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#586e75>// do whatever with string_txt.
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    println!({string_txt});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#586e75>// read a file as binary.
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    <span style=color:#268bd2>let</span> binary_file <span style=color:#719e07>=</span> include_bytes!(<span style=color:#2aa198>&#34;binary.file&#34;</span>);
</span></span><span style=display:flex><span>    print!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, <span style=color:#b58900>String</span>::from_utf8_lossy(bytes));
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>These macros read single files and do not allow embedding a directory like a
file system unlike Golang :(.</p><h2 id=convert-vecstring-to-vecstr>Convert Vec<string> to Vec&lt;&amp;str>
<a class=header-link href=#convert-vecstring-to-vecstr><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#586e75>// string_vec: Vec&lt;String&gt;
</span></span></span><span style=display:flex><span><span style=color:#586e75>// str_vec: Vec&lt;&amp;str&gt;
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#268bd2>let</span> str_vec <span style=color:#719e07>=</span> string_vec.iter().map(<span style=color:#719e07>|</span>s<span style=color:#719e07>|</span> s.as_str()).collect();
</span></span></code></pre></div><h2 id=extend-a-struct-in-another>Extend a Struct in Another
<a class=header-link href=#extend-a-struct-in-another><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Rust cannot do this. We cannot even embed as easily as it happens in Go, but
here's a form of embedding.</p><p>Apparently, "implementing <a href=https://doc.rust-lang.org/std/ops/trait.Deref.html target=_blank rel="noreferrer noopener">Deref</a> and <a href=https://doc.rust-lang.org/std/ops/trait.DerefMut.html target=_blank rel="noreferrer noopener">DerefMut</a>
traits allow the compiler to implicitly cast pointers to <code>StructB</code>s to pointers
to <code>StructA</code>s."</p><p>Source: <a href=https://stackoverflow.com/a/32552688 target=_blank rel="noreferrer noopener">https://stackoverflow.com/a/32552688</a></p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#719e07>struct</span> <span style=color:#268bd2>StructA</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>impl</span> StructA {
</span></span><span style=display:flex><span>    <span style=color:#719e07>fn</span> <span style=color:#268bd2>name</span>(<span style=color:#719e07>&amp;</span><span style=color:#268bd2>self</span>) -&gt; <span style=color:#719e07>&amp;</span><span style=color:#b58900>&#39;static</span> <span style=color:#dc322f>str</span> {
</span></span><span style=display:flex><span>        <span style=color:#2aa198>&#34;Anna&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>struct</span> <span style=color:#268bd2>StructB</span> {
</span></span><span style=display:flex><span>    a: <span style=color:#268bd2>StructA</span>, 
</span></span><span style=display:flex><span>    <span style=color:#586e75>// other fields...
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>impl</span> std::ops::Deref <span style=color:#719e07>for</span> StructB {
</span></span><span style=display:flex><span>    <span style=color:#719e07>type</span> <span style=color:#268bd2>Target</span> <span style=color:#719e07>=</span> StructA;
</span></span><span style=display:flex><span>    <span style=color:#719e07>fn</span> <span style=color:#268bd2>deref</span>(<span style=color:#719e07>&amp;</span><span style=color:#268bd2>self</span>) -&gt; <span style=color:#719e07>&amp;</span><span style=color:#268bd2>Self</span>::Target {
</span></span><span style=display:flex><span>        <span style=color:#719e07>&amp;</span><span style=color:#268bd2>self</span>.a
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>fn</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> b <span style=color:#719e07>=</span> StructB { a: <span style=color:#268bd2>StructA</span> };
</span></span><span style=display:flex><span>    println!(<span style=color:#2aa198>&#34;</span><span style=color:#2aa198>{}</span><span style=color:#2aa198>&#34;</span>, b.name());
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div><footer><p class=meta><span class=categories>Tags:
<a class=category href=https://parsiya.io/tags/rust>Rust</a></span></p></footer></article></div><aside class="sidebar thirds"><section class="first odd"><h2>Table of Contents</h2><nav id=TableOfContents><ul><li><a href=#learning-rust>Learning Rust</a></li><li><a href=#chapter-1>Chapter 1</a></li><li><a href=#chapter-2>Chapter 2</a><ul><li><a href=#dependencies>Dependencies</a></li><li><a href=#adding-a-loop>Adding a Loop</a></li><li><a href=#handling-invalid-input>Handling Invalid Input</a></li></ul></li><li><a href=#chapter-3>Chapter 3</a><ul><li><a href=#mutability>Mutability</a></li><li><a href=#constants>Constants</a></li><li><a href=#shadowing>Shadowing</a></li><li><a href=#integers>Integers</a></li><li><a href=#floating-point>Floating Point</a></li><li><a href=#numeric-operations>Numeric Operations</a></li><li><a href=#boolean>Boolean</a></li><li><a href=#character-type>Character Type</a></li><li><a href=#tuple>Tuple</a></li><li><a href=#array>Array</a></li><li><a href=#string-literals>String Literals</a></li><li><a href=#functions>Functions</a></li><li><a href=#if-else>if-else</a></li><li><a href=#loop>loop</a></li><li><a href=#while>while</a></li><li><a href=#loop-through-collections-with-for>Loop Through Collections with for</a></li></ul></li><li><a href=#chapter-4>Chapter 4</a><ul><li><a href=#ownership-rules>Ownership Rules</a></li><li><a href=#the-string-type>The String Type</a></li><li><a href=#move>Move</a></li><li><a href=#clone>Clone</a></li><li><a href=#copy>Copy</a></li><li><a href=#ownership-and-functions>Ownership and Functions</a></li><li><a href=#references>References</a></li><li><a href=#mutable-references>Mutable References</a></li><li><a href=#reference-scope>Reference Scope</a></li><li><a href=#dangling-reference>Dangling Reference</a></li><li><a href=#the-slice-type>The Slice Type</a></li><li><a href=#string-slice>String Slice</a></li><li><a href=#other-slices>Other Slices</a></li></ul></li><li><a href=#chapter-5>Chapter 5</a><ul><li><a href=#structs>Structs</a></li><li><a href=#field-init-shorthand>Field Init Shorthand</a></li><li><a href=#struct-update-syntax>Struct Update Syntax</a></li><li><a href=#tuple-structs>Tuple Structs</a></li><li><a href=#unit-like-structs>Unit-Like Structs</a></li><li><a href=#derived-traits>Derived Traits</a></li><li><a href=#the-dbg-macro>The dbg Macro</a></li><li><a href=#methods>Methods</a></li><li><a href=#automatic-referencing-and-dereferencing>Automatic Referencing and Dereferencing</a></li><li><a href=#associated-functions>Associated Functions</a></li></ul></li><li><a href=#chapter-6>Chapter 6</a><ul><li><a href=#define-an-enum>Define an Enum</a></li><li><a href=#enum-methods-and-match>Enum Methods and match</a></li><li><a href=#option-enum>Option Enum</a></li><li><a href=#matching-with-optiont>Matching with Option<t></a></li><li><a href=#if-let>if let</a></li></ul></li><li><a href=#chapter-7>Chapter 7</a><ul><li><a href=#packages--crates>Packages & Crates</a></li><li><a href=#modules>Modules</a></li><li><a href=#paths>Paths</a></li><li><a href=#rusts-privacy-boundary>Rust's Privacy Boundary</a></li><li><a href=#super>Super</a></li><li><a href=#public-structs>Public Structs</a></li><li><a href=#public-enums>Public Enums</a></li><li><a href=#the-use-keyword>The use Keyword</a></li><li><a href=#pub-use>pub use</a></li><li><a href=#nested-paths-in-use>Nested Paths in use</a></li><li><a href=#modules-in-different-files>Modules in Different Files</a></li></ul></li><li><a href=#chapter-8>Chapter 8</a><ul><li><a href=#vectors>Vectors</a></li><li><a href=#read-vector-values>Read Vector Values</a></li><li><a href=#iterate-over-vector-elements>Iterate over Vector Elements</a></li><li><a href=#using-an-enum-to-store-multiple-types>Using an Enum to Store Multiple Types</a></li><li><a href=#remove-vector-values>Remove Vector Values</a></li><li><a href=#strings>Strings</a></li><li><a href=#hashmaps>HashMaps</a></li><li><a href=#hashmaps-and-ownership>HashMaps and Ownership</a></li><li><a href=#reading-hashmaps>Reading HashMaps</a></li><li><a href=#iterating-over-the-hashmap>Iterating over the HashMap</a></li><li><a href=#updating-a-hash-map>Updating a Hash Map</a></li></ul></li><li><a href=#chapter-9>Chapter 9</a><ul><li><a href=#panic>panic!</a></li><li><a href=#recoverable-errors>Recoverable Errors</a></li><li><a href=#matching-on-different-errors>Matching on Different Errors</a></li><li><a href=#unwrap-and-expect>unwrap and expect</a></li><li><a href=#propagating-errors>Propagating Errors</a></li><li><a href=#shortcut-for-propagating-errors>Shortcut for Propagating Errors</a></li></ul></li><li><a href=#misc>Misc</a><ul><li><a href=#type-alias>Type Alias</a></li><li><a href=#extension-trait>Extension Trait</a></li><li><a href=#import-an-adjacent-module>Import an Adjacent Module</a></li><li><a href=#crate-level-pub>Crate Level Pub</a></li><li><a href=#embed-files-in-the-binary>Embed Files in the Binary</a></li><li><a href=#convert-vecstring-to-vecstr>Convert Vec<string> to Vec&lt;&amp;str></a></li><li><a href=#extend-a-struct-in-another>Extend a Struct in Another</a></li></ul></li></ul></nav></section></aside></div></div><footer role=contentinfo><p>Copyright &copy; 2024 Parsia-Clone - <a href=https://parsiya.io/license/>License</a> -
<span class=credit>Powered by <a target=_blank href=https://gohugo.io rel="noopener noreferrer">Hugo</a> and <a target=_blank href=https://github.com/parsiya/hugo-octopress/ rel="noopener noreferrer">Hugo-Octopress</a> theme.</p></footer></body></html>