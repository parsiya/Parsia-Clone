<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,minimum-scale=1,maximum-scale=1"><link href=/css/fonts.css rel=stylesheet type=text/css><title>VS Code Extension Development Notes</title><link rel=stylesheet href=/css/hugo-octopress.css><link rel=stylesheet href=https://parsiya.io//clone.css><link rel=stylesheet href=/css/fork-awesome.min.css><link href=https://parsiya.io/favicon.png rel=icon><meta name=description content><meta name=keywords content="[Parsia Hakimian Parsiya infosec information security]"><meta name=author content="Parsia-Clone"><meta name=generator content="Hugo 0.156.0"><meta name=twitter:card content="summary"><meta name=twitter:title content="VS Code Extension Development Notes"><meta name=twitter:description content="Storage

Four types of storage (ExtensionContext is passed to the activate method as context):

ExtensionContext.workspaceState: A workspace storage where you can write
key/value pairs. VS Code manages the storage and will restore it when the same
workspace is opened again.
ExtensionContext.globalState: A global storage where you can write key/value
pairs. VS Code manages the storage and will restore it for each extension
activation. You can selectively synchronize key/value pairs in global storage
by setting the keys for sync using setKeysForSync method on globalState.
ExtensionContext.storageUri: A workspace specific storage URI pointing to a
local directory where your extension has read/write access. This is a good
option if you need to store large files that are accessible only from the
current workspace.
ExtensionContext.globalStorageUri: A global storage URI pointing to a local
directory where your extension has read/write access. This is a good option if
you need to store large files that are accessible from all workspaces.

Source: https://code.visualstudio.com/api/extension-capabilities/common-capabilities#data-storage"><meta name=twitter:domain content="parsiya.io"><meta name=twitter:creator content="@CryptoGangsta"></head><body><header role=banner><hgroup><h1><a href=https://parsiya.io/>Parsia-Clone</a></h1><h2>'Documentation is a love letter that you write to your future self.' - Damian Conway</h2></hgroup></header><nav role=navigation><fieldset class=mobile-nav><select onchange="location=this.value"><option value>Navigate…</option><option value=https://github.com/parsiya/Parsia-Clone>» Parsia-Clone on Github</option><option value=https://parsiya.net/categories/clone/>» How did I make this?</option><option value=https://parsiya.net>» My Main Website</option></select></fieldset><ul class=main-navigation><li><a href=https://github.com/parsiya/Parsia-Clone title="Parsia-Clone on Github" target=_blank rel="noopener noreferrer">Parsia-Clone on Github</a></li><li><a href=https://parsiya.net/categories/clone/ title="How did I make this?" target=_blank rel="noopener noreferrer">How did I make this?</a></li><li><a href=https://parsiya.net title="My Main Website" target=_blank rel="noopener noreferrer">My Main Website</a></li></ul><ul class=subscription></ul><form action=https://www.google.com/search method=get target=_blank rel="noopener noreferrer"><fieldset role=search><input class=search type=text name=q results=0 placeholder=Search>
<input type=hidden name=q value=site:https://parsiya.io/></fieldset></form></nav><div id=main><div id=content><div><article class=hentry role=article><header><p class=meta>2 minute read
- <a class=label href=https://parsiya.io/categories/development/>Development</a></p><h1 class=entry-title>VS Code Extension Development Notes</h1><a href=https://github.com/parsiya/Parsia-Clone/tree/main/dev/vscode-extension.md target=_blank>Github Link</a></header><div class=entry-content><nav id=TableOfContents><ul><li><a href=#storage>Storage</a></li><li><a href=#validate-the-input-from-an-inputbox>Validate the Input from an InputBox</a></li></ul></nav><h1 id=storage>Storage
<a class=header-link href=#storage><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><p>Four types of storage (<code>ExtensionContext</code> is passed to the <code>activate</code> method as <code>context</code>):</p><ul><li><code>ExtensionContext.workspaceState</code>: A workspace storage where you can write
key/value pairs. VS Code manages the storage and will restore it when the same
workspace is opened again.</li><li><code>ExtensionContext.globalState</code>: A global storage where you can write key/value
pairs. VS Code manages the storage and will restore it for each extension
activation. You can selectively synchronize key/value pairs in global storage
by setting the keys for sync using <code>setKeysForSync</code> method on <code>globalState</code>.</li><li><code>ExtensionContext.storageUri</code>: A workspace specific storage URI pointing to a
local directory where your extension has read/write access. This is a good
option if you need to store large files that are accessible only from the
current workspace.</li><li><code>ExtensionContext.globalStorageUri</code>: A global storage URI pointing to a local
directory where your extension has read/write access. This is a good option if
you need to store large files that are accessible from all workspaces.</li></ul><p>Source: <a href=https://code.visualstudio.com/api/extension-capabilities/common-capabilities#data-storage target=_blank rel="noreferrer noopener">https://code.visualstudio.com/api/extension-capabilities/common-capabilities#data-storage</a></p><p>Example code:</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-ts data-lang=ts><span style=display:flex><span><span style=color:#268bd2>export</span> <span style=color:#268bd2>function</span> activate(context: <span style=color:#dc322f>vscode.ExtensionContext</span>) {
</span></span><span style=display:flex><span>    <span style=color:#586e75>// The following usually happens in a registerCommand.
</span></span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#586e75>// If the key does not exist in the storage, it will return `undefined`.
</span></span></span><span style=display:flex><span>    <span style=color:#268bd2>let</span> configPath: <span style=color:#dc322f>vscode.Uri</span> <span style=color:#719e07>|</span> <span style=color:#cb4b16>undefined</span> <span style=color:#719e07>=</span>
</span></span><span style=display:flex><span>        context.globalState.<span style=color:#268bd2>get</span>&lt;<span style=color:#268bd2>vscode.Uri</span>&gt;(<span style=color:#2aa198>&#34;config_path&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#586e75>// Check if the value exists or if it&#39;s undefined.
</span></span></span><span style=display:flex><span>    <span style=color:#719e07>if</span> (configPath <span style=color:#719e07>===</span> <span style=color:#cb4b16>undefined</span>) {
</span></span><span style=display:flex><span>        <span style=color:#586e75>// We don&#39;t have this path so we assume we&#39;re starting from scratch.
</span></span></span><span style=display:flex><span>        <span style=color:#586e75>// Get a path from globalStorageUri.
</span></span></span><span style=display:flex><span>        <span style=color:#586e75>// This will return a Uri.
</span></span></span><span style=display:flex><span>        configPath <span style=color:#719e07>=</span> context.globalStorageUri;
</span></span><span style=display:flex><span>        <span style=color:#586e75>// The parent directory exists, but the child directory must be created.
</span></span></span><span style=display:flex><span>        <span style=color:#586e75>// e.g., /home/parsia/.vscode-server/data/User/globalStorage/undefined_publisher.borrowed-time
</span></span></span><span style=display:flex><span>        vscode.workspace.fs.createDirectory(configPath).then(() <span style=color:#719e07>=&gt;</span> {
</span></span><span style=display:flex><span>            console.log(<span style=color:#2aa198>&#34;Created the global storage path: &#34;</span> <span style=color:#719e07>+</span> configPath);
</span></span><span style=display:flex><span>            <span style=color:#586e75>// Store this path in `config_path`.
</span></span></span><span style=display:flex><span>            context.globalState.update(<span style=color:#2aa198>&#34;config_path&#34;</span>, configPath);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#586e75>// Store the default config in the config path.
</span></span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#586e75>// If we want to delete the key/value pair from globalState or workspaceState,
</span></span></span><span style=display:flex><span>    <span style=color:#586e75>// we must replace its value with `undefined`.
</span></span></span><span style=display:flex><span>    context.globalState.update(<span style=color:#2aa198>&#34;config_path&#34;</span>, <span style=color:#cb4b16>undefined</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h1 id=validate-the-input-from-an-inputbox>Validate the Input from an InputBox
<a class=header-link href=#validate-the-input-from-an-inputbox><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><p>The <code>validateInput</code> callback does it. In this example, we're checking if the
input is empty. If they press enter when it's empty, the <code>Please enter a ...</code>
message will be shown in red under the input box and they cannot continue. The
user can always use escape to cancel the flow.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-ts data-lang=ts><span style=display:flex><span><span style=color:#268bd2>let</span> newProject <span style=color:#719e07>=</span> vscode.commands.registerCommand(
</span></span><span style=display:flex><span>    <span style=color:#2aa198>&#34;borrowed-time.newproject&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#268bd2>async</span> () <span style=color:#719e07>=&gt;</span> {
</span></span><span style=display:flex><span>        <span style=color:#586e75>// Get project name from the user.
</span></span></span><span style=display:flex><span>        <span style=color:#268bd2>const</span> projectName <span style=color:#719e07>=</span> <span style=color:#719e07>await</span> vscode.<span style=color:#b58900>window</span>.showInputBox({
</span></span><span style=display:flex><span>        placeHolder<span style=color:#719e07>:</span> <span style=color:#2aa198>&#34;&#34;</span>,
</span></span><span style=display:flex><span>        prompt<span style=color:#719e07>:</span> <span style=color:#2aa198>&#34;New Project&#39;s Name&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#586e75>// Do not let user input an empty project name.
</span></span></span><span style=display:flex><span>        validateInput<span style=color:#719e07>:</span> (text) <span style=color:#719e07>=&gt;</span> {
</span></span><span style=display:flex><span>            <span style=color:#719e07>if</span> (text <span style=color:#719e07>!==</span> <span style=color:#2aa198>&#34;&#34;</span>) <span style=color:#719e07>return</span> <span style=color:#cb4b16>null</span>;
</span></span><span style=display:flex><span>            <span style=color:#719e07>else</span> {
</span></span><span style=display:flex><span>            <span style=color:#719e07>return</span> <span style=color:#2aa198>&#34;Please enter a project name&#34;</span>;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span><span style=color:#586e75>// Do something with projectName.
</span></span></span><span style=display:flex><span>);
</span></span></code></pre></div></div><footer><p class=meta><span class=categories>Tags:
<a class=category href=https://parsiya.io/tags/vs-code>VS Code</a> <a class=category href=https://parsiya.io/tags/typescript>TypeScript</a></span></p></footer></article></div><aside class="sidebar thirds"><section class="first odd"><h2>Table of Contents</h2><nav id=TableOfContents><ul><li><a href=#storage>Storage</a></li><li><a href=#validate-the-input-from-an-inputbox>Validate the Input from an InputBox</a></li></ul></nav></section></aside></div></div><footer role=contentinfo><p>Copyright &copy; 2026 Parsia-Clone - <a href=https://parsiya.io/license/>License</a> -
<span class=credit>Powered by <a target=_blank href=https://gohugo.io rel="noopener noreferrer">Hugo</a> and <a target=_blank href=https://github.com/parsiya/hugo-octopress/ rel="noopener noreferrer">Hugo-Octopress</a> theme.</p></footer></body></html>